{"id":"fleet-00d","title":"Test auto-pairing workflow on subset of hosts","description":"Test the complete auto-pairing workflow on a subset of hosts to validate device ID collection, storage, and config application.\n\n## Testing Approach\n\n1. **Test Device ID Collection**:\n   ```bash\n   ansible-playbook syncthing_autopair.yml --tags collect -l rincewind,constantine --check\n   ansible-playbook syncthing_autopair.yml --tags collect -l rincewind,constantine\n   ```\n\n2. **Test 1Password Storage**:\n   ```bash\n   op read \"op://ServiceAccountAccess/Syncthing Fleet Device IDs/rincewind\"\n   op read \"op://ServiceAccountAccess/Syncthing Fleet Device IDs/constantine\"\n   ```\n\n3. **Test Config Loading**:\n   ```bash\n   ansible-playbook syncthing_autopair.yml --tags configure -l rincewind --check\n   ```\n\n4. **Test Config Application**:\n   ```bash\n   ansible-playbook syncthing_autopair.yml --tags configure -l rincewind,constantine\n   ```\n\n5. **Verify Pairing**:\n   - Open Syncthing GUI on rincewind: http://localhost:8384\n   - Check \"Remote Devices\" section\n   - Verify constantine appears and connects\n   - Repeat verification on constantine\n\n6. **Test Idempotency**:\n   ```bash\n   ansible-playbook syncthing_autopair.yml -l rincewind,constantine\n   ansible-playbook syncthing_autopair.yml -l rincewind,constantine\n   # Second run should show \"ok\" with no changes\n   ```\n\n## Acceptance Criteria\n\n- Device IDs successfully collected from test hosts\n- Device IDs stored in 1Password vault\n- Config.xml templated and applied to test hosts\n- Syncthing services restarted automatically\n- Devices show as \"Connected\" in web GUI\n- Playbook is idempotent (second run shows no changes)\n- No ansible-lint warnings or errors\n- Backup config.xml files created before changes\n- XML validation passes on all generated configs\n- mise run syncthing:autopair completes successfully","acceptance_criteria":"- [ ] Collection phase tested: ansible-playbook with --check shows device IDs would be collected\n- [ ] Collection phase tested: execution mode successfully collects device IDs\n- [ ] Storage phase tested: device IDs successfully written to 1Password vault\n- [ ] Storage phase verified: op read command returns stored device IDs\n- [ ] Config loading tested: device IDs successfully loaded from 1Password into hostvars\n- [ ] Config application tested: templated config applied to test hosts (rincewind, constantine)\n- [ ] Service restart verified: Syncthing services restart after config change\n- [ ] Connectivity verified: Syncthing web GUI shows peer connections\n- [ ] Idempotency tested: second playbook run shows no changes (changed=0)\n- [ ] End-to-end tested: mise run syncthing:autopair completes successfully on test hosts\n- [ ] Backup verification: config.xml.backup files created before changes\n- [ ] XML validation: generated config files pass xmllint validation","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:56.787806519-08:00","updated_at":"2026-01-27T15:09:18.390339927-08:00","labels":["syncthing","testing","validation"],"dependencies":[{"issue_id":"fleet-00d","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:56.805900802-08:00","created_by":"daemon"},{"issue_id":"fleet-00d","depends_on_id":"fleet-nz6","type":"blocks","created_at":"2026-01-27T14:29:11.994055708-08:00","created_by":"daemon"},{"issue_id":"fleet-00d","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:35.30955904-08:00","created_by":"daemon"}]}
{"id":"fleet-0g5","title":"Store collected device IDs in 1Password vault","description":"Create Ansible task to populate 1Password vault with collected device IDs from all hosts.\n\n## Implementation\n\nCreate `roles/syncthing/tasks/store_device_ids.yml`:\n\n```yaml\n# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\n---\n- name: \"Syncthing | Store device ID in 1Password\"\n  ansible.builtin.command:\n    cmd: \u003e\n      op item edit \"Syncthing Fleet Device IDs\"\n      {{ inventory_hostname }}[text]=\"{{ syncthing_device_id }}\"\n  delegate_to: localhost\n  run_once: false\n  changed_when: true\n  register: op_result\n  failed_when: op_result.rc != 0\n```\n\nPlaybook integration:\n```yaml\n- name: \"Collect and store Syncthing device IDs\"\n  hosts: laptop:workstation\n  tasks:\n    - name: \"Include device ID collection\"\n      ansible.builtin.include_role:\n        name: syncthing\n        tasks_from: collect_device_ids.yml\n    \n    - name: \"Include device ID storage\"\n      ansible.builtin.include_role:\n        name: syncthing\n        tasks_from: store_device_ids.yml\n```\n\n## Acceptance Criteria\n\n- Task file created using ansible.builtin.command for op CLI\n- Task runs on localhost (delegate_to) but processes all hosts\n- Device IDs successfully stored in 1Password vault\n- Verification: `op read \"op://ServiceAccountAccess/Syncthing Fleet Device IDs/\u003chostname\u003e\"` returns device ID\n- Task is idempotent (updates existing fields)\n- Follows FQCN convention and copyright header\n- `ansible-lint` passes","acceptance_criteria":"- [ ] Ansible task created to store device IDs in 1Password\n- [ ] Task runs on localhost (control node) with `delegate_to: localhost`\n- [ ] Uses `ansible.builtin.command` to run `op item edit` for each host's device ID\n- [ ] Loops over hostvars to update all collected device IDs\n- [ ] Command structure: `op item edit \"Syncthing Fleet Device IDs\" {{ inventory_hostname }}=\"{{ syncthing_device_id }}\"`\n- [ ] Task marked `changed_when: false` or detects actual changes\n- [ ] Task includes error handling for op CLI failures\n- [ ] Test run successfully stores device IDs for test hosts (rincewind, constantine)\n- [ ] Verification: `op read \"op://ServiceAccountAccess/Syncthing Fleet Device IDs/rincewind\"` returns correct device ID","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:09.952879137-08:00","updated_at":"2026-01-27T14:56:47.513667248-08:00","labels":["1password","secrets-management","syncthing"],"dependencies":[{"issue_id":"fleet-0g5","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:09.957966723-08:00","created_by":"daemon"},{"issue_id":"fleet-0g5","depends_on_id":"fleet-st4","type":"blocks","created_at":"2026-01-27T14:29:06.462394691-08:00","created_by":"daemon"},{"issue_id":"fleet-0g5","depends_on_id":"fleet-69s","type":"blocks","created_at":"2026-01-27T14:29:06.841938283-08:00","created_by":"daemon"},{"issue_id":"fleet-0g5","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:31.825912611-08:00","created_by":"daemon"}]}
{"id":"fleet-0mw","title":"Add Syncthing connection type verification via API","description":"## Objective\nCreate an Ansible task that queries the Syncthing REST API to verify connection types between peers are using optimal transport methods (TCP/QUIC) rather than relays.\n\n## Acceptance Criteria\n- [ ] Task created to query Syncthing REST API for connection types\n- [ ] Task uses ansible.builtin.uri module to query /rest/system/connections\n- [ ] Task validates response status is 200\n- [ ] Task parses JSON response for configured devices\n- [ ] Task checks each device connectionType field\n- [ ] Task asserts at least one device uses \"tcp-client\" or \"tcp-server\"\n- [ ] Task asserts at least one device uses \"quic-client\" or \"quic-server\"\n- [ ] Task handles API authentication if required\n- [ ] Task fails clearly if connection types are not optimal\n- [ ] Task documented with comments explaining API usage\n- [ ] Task integrated into test playbook (fleet-11m)","acceptance_criteria":"- [ ] Task created to query Syncthing REST API for connection types\n- [ ] Task uses ansible.builtin.uri module to query /rest/system/connections\n- [ ] Task validates response status is 200\n- [ ] Task parses JSON response for configured devices\n- [ ] Task checks each device connectionType field\n- [ ] Task asserts at least one device uses \"tcp-client\" or \"tcp-server\"\n- [ ] Task asserts at least one device uses \"quic-client\" or \"quic-server\"\n- [ ] Task handles API authentication if required\n- [ ] Task fails clearly if connection types are not optimal\n- [ ] Task documented with comments explaining API usage\n- [ ] Task integrated into test playbook (fleet-11m)\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:46:40.486574047-08:00","updated_at":"2026-01-27T20:56:03.769040649-08:00","labels":["api","syncthing","testing","validation"],"dependencies":[{"issue_id":"fleet-0mw","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:46:40.504376943-08:00","created_by":"daemon"},{"issue_id":"fleet-0mw","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:03.519186821-08:00","created_by":"daemon"},{"issue_id":"fleet-0mw","depends_on_id":"fleet-9ia","type":"parent-child","created_at":"2026-01-27T15:13:52.650774822-08:00","created_by":"daemon"},{"issue_id":"fleet-0mw","depends_on_id":"fleet-err","type":"parent-child","created_at":"2026-01-27T15:13:53.297535684-08:00","created_by":"daemon"},{"issue_id":"fleet-0mw","depends_on_id":"fleet-33f","type":"parent-child","created_at":"2026-01-27T15:17:19.017415251-08:00","created_by":"daemon"},{"issue_id":"fleet-0mw","depends_on_id":"fleet-in2","type":"parent-child","created_at":"2026-01-27T15:17:19.513032297-08:00","created_by":"daemon"}]}
{"id":"fleet-11m","title":"Create integration test for Syncthing firewall configuration","description":"## Objective\nCreate a comprehensive integration test that validates Syncthing firewall configuration on both Linux and Darwin platforms.\n\n## Acceptance Criteria\n- [ ] Test playbook created in roles/syncthing/tests/\n- [ ] Test playbook includes firewall configuration tasks\n- [ ] Test verifies ufw rules exist on Linux\n- [ ] Test verifies Darwin firewall rules exist on macOS\n- [ ] Test checks TCP port 22000 is allowed\n- [ ] Test checks UDP port 22000 is allowed\n- [ ] Test checks UDP port 21027 is allowed\n- [ ] Test uses ansible.builtin.assert for validations\n- [ ] Test runs in check mode without errors\n- [ ] Test documented in roles/syncthing/README.md\n- [ ] Test passes on both Linux and Darwin","acceptance_criteria":"- [ ] Test playbook created in roles/syncthing/tests/\n- [ ] Test playbook includes firewall configuration tasks\n- [ ] Test verifies ufw rules exist on Linux\n- [ ] Test verifies Darwin firewall rules exist on macOS\n- [ ] Test checks TCP port 22000 is allowed\n- [ ] Test checks UDP port 22000 is allowed\n- [ ] Test checks UDP port 21027 is allowed\n- [ ] Test uses ansible.builtin.assert for validations\n- [ ] Test runs in check mode without errors\n- [ ] Test documented in roles/syncthing/README.md\n- [ ] Test passes on both Linux and Darwin\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:47:04.170696823-08:00","updated_at":"2026-01-27T20:55:58.665651663-08:00","labels":["firewall","syncthing","testing"],"dependencies":[{"issue_id":"fleet-11m","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:47:04.190837446-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:04.463992094-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-212","type":"parent-child","created_at":"2026-01-27T15:13:56.722761981-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-lcb","type":"parent-child","created_at":"2026-01-27T15:13:57.342798177-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-l6e","type":"parent-child","created_at":"2026-01-27T15:13:58.024629811-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-4up","type":"parent-child","created_at":"2026-01-27T15:17:21.040453748-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-3ck","type":"parent-child","created_at":"2026-01-27T15:17:21.676783341-08:00","created_by":"daemon"},{"issue_id":"fleet-11m","depends_on_id":"fleet-m94","type":"parent-child","created_at":"2026-01-27T15:17:22.166437174-08:00","created_by":"daemon"}]}
{"id":"fleet-194","title":"Create syncthing role metadata file","description":"Create the `meta/main.yml` file defining role metadata including supported platforms, dependencies, and author information.\n\nReference existing roles for metadata structure.\n\n## Acceptance Criteria\n\n- [ ] `roles/syncthing/meta/main.yml` created with copyright header\n- [ ] Defines role author and description\n- [ ] Specifies supported platforms (Debian, Ubuntu, Darwin)\n- [ ] Includes ansible_version minimum requirement (2.9 or higher)\n- [ ] No role dependencies declared (standalone role)\n- [ ] Follows standard Ansible Galaxy metadata format","acceptance_criteria":"- [ ] `roles/syncthing/meta/main.yml` created with copyright header\n- [ ] Defines role author and description\n- [ ] Specifies supported platforms (Debian, Ubuntu, Darwin)\n- [ ] Includes ansible_version minimum requirement (2.9 or higher)\n- [ ] No role dependencies declared (standalone role)\n- [ ] Follows standard Ansible Galaxy metadata format","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:12.002834201-08:00","updated_at":"2026-01-27T20:39:19.962084771-08:00","closed_at":"2026-01-27T20:39:19.962084771-08:00","close_reason":"Closed","labels":["syncthing"],"dependencies":[{"issue_id":"fleet-194","depends_on_id":"fleet-c8a","type":"blocks","created_at":"2026-01-27T14:06:16.516072978-08:00","created_by":"daemon"},{"issue_id":"fleet-194","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T14:06:17.04125061-08:00","created_by":"daemon"}]}
{"id":"fleet-212","title":"Create Linux firewall integration test","description":"Create integration test playbook to verify Linux (ufw) firewall configuration for Syncthing.\n\n## Context\nThis is part of firewall integration testing (parent: fleet-11m). Tests Linux-specific firewall configuration.\n\n## Implementation\n\nCreate `roles/syncthing/tests/test_linux_firewall.yml`:\n\n- Test ufw status shows active\n- Test ufw rules include 22000/tcp ALLOW\n- Test ufw rules include 22000/udp ALLOW\n- Test ufw rules include 21027/udp ALLOW\n- Test port listening: netstat or ss shows ports open\n- Test local connectivity: curl to 127.0.0.1:8384\n- Include role and run firewall tasks\n- Verify tasks are idempotent\n\n## Acceptance Criteria\n\n- [ ] test_linux_firewall.yml created in roles/syncthing/tests/\n- [ ] Test runs only on Linux hosts (ansible_facts.system == 'Linux')\n- [ ] Test verifies ufw status is active\n- [ ] Test verifies ufw rules for 22000/tcp\n- [ ] Test verifies ufw rules for 22000/udp\n- [ ] Test verifies ufw rules for 21027/udp\n- [ ] Test verifies ports are listening using netstat or ss\n- [ ] Test verifies Syncthing API is accessible (http://127.0.0.1:8384)\n- [ ] Test includes idempotency check (second run shows no changes)\n- [ ] Copyright header present\n- [ ] ansible-playbook --syntax-check passes\n- [ ] ansible-lint passes","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:40.149214731-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:22.519526904-08:00","closed_at":"2026-01-27T15:39:22.519526904-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["firewall","linux","syncthing","testing"],"dependencies":[{"issue_id":"fleet-212","depends_on_id":"fleet-l6e","type":"blocks","created_at":"2026-01-27T15:13:58.689001184-08:00","created_by":"daemon"}]}
{"id":"fleet-238","title":"mise dry-run-local fails during apt-update","description":"The `mise run dry-run-local` task fails during apt package cache update phase with an error. This blocks local testing and validation workflows.\n\n## Reproduction\n```bash\nmise run dry-run-local\n```\n\n## Expected Behavior\nDry run should complete successfully, showing what changes would be made without applying them.\n\n## Actual Behavior\nTask fails during apt-update with an error (exact error message needs investigation).\n\n## Impact\n- Cannot validate playbook changes locally before applying\n- Blocks testing workflow\n- May indicate issue with apt cache handling in check mode","acceptance_criteria":"- [ ] Root cause identified: which task in local.yml triggers apt-update failure\n- [ ] Error message and stack trace documented in issue notes\n- [ ] Failure reproduced with: `mise run dry-run-local`\n- [ ] Solution implemented (update ansible version, fix apt cache handling, or skip problematic task in check mode)\n- [ ] `mise run dry-run-local` completes successfully without errors\n- [ ] `mise run lint` passes\n- [ ] Changes do not break `mise run apply-local` execution","notes":"Issue was already fixed in commit 0ac1663 on 2026-01-16 by T.R. Fullhart.\n\n**Root Cause**: apt/pacman cache update tasks in local.yml Pre-run Setup play failed during check mode due to permission/locking issues.\n\n**Solution**: Added 'ignore_errors: {{ ansible_check_mode }}' to both apt (line 30) and pacman (line 37) cache update tasks. This allows cache update failures to be ignored in check mode while still failing in normal execution.\n\n**Verification**: Ran 'mise run dry-run-local' successfully on 2026-01-27. PLAY RECAP: ok=38, changed=1, unreachable=0, failed=0, skipped=10.\n\nCommit message: 'fix(local.yml): ignore apt/pacman cache update errors in check mode. Fixes: fleet-238'","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-08T12:12:46.9752305-08:00","created_by":"kayos","updated_at":"2026-01-27T19:25:22.021754949-08:00","closed_at":"2026-01-27T19:25:22.021754949-08:00","close_reason":"Closed"}
{"id":"fleet-2f4","title":"Configure beads sync branch","description":"bd doctor warned that sync-branch is not configured. Run 'bd migrate sync beads-sync' to set it up.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:24:43.747417918-08:00","created_by":"kayos","updated_at":"2026-01-06T15:33:50.830744583-08:00","closed_at":"2026-01-06T15:33:50.830744583-08:00","close_reason":"Closed"}
{"id":"fleet-2om","title":"Add test task to mise.toml","description":"Create a task in mise.toml to run ansible role tests. This ensures tests can be run easily and consistently, handling path issues correctly.","status":"closed","priority":2,"issue_type":"task","assignee":"kayos","created_at":"2026-01-06T16:05:22.427700534-08:00","created_by":"kayos","updated_at":"2026-01-06T16:08:27.75713178-08:00","closed_at":"2026-01-06T16:08:27.75713178-08:00","close_reason":"Implemented test task in mise.toml"}
{"id":"fleet-2w0","title":"Implement Syncthing auto-pairing with device ID management","description":"## Objective\nImplement automatic Syncthing device pairing across fleet hosts by managing device IDs and using the Syncthing REST API for configuration.\n\n## Background\nSyncthing requires manual device pairing by exchanging device IDs. This is tedious for a fleet of machines and error-prone. Automating this process will:\n- Reduce manual configuration steps during new host setup\n- Ensure consistent pairing across all fleet hosts\n- Support adding new hosts to the fleet automatically\n\n## Approach\n1. Generate or retrieve Syncthing device ID for each host\n2. Store device IDs in Ansible vault or host_vars\n3. Use Syncthing REST API to add peer devices\n4. Verify pairing succeeded via API\n\n## Success Criteria\n- [ ] Device ID generation task implemented for new Syncthing installations\n- [ ] Device ID storage mechanism created (vault or host_vars)\n- [ ] Device ID retrieval task implemented for existing installations\n- [ ] Auto-pairing task created using Syncthing REST API\n- [ ] Task validates device IDs before pairing\n- [ ] Task handles pairing failures gracefully\n- [ ] Task is idempotent (repeated runs do not re-pair)\n- [ ] Integration test validates auto-pairing workflow\n- [ ] Documentation added explaining device ID management\n- [ ] Security considerations documented (device ID sensitivity)","acceptance_criteria":"- [ ] Device ID generation task implemented for new Syncthing installations\n- [ ] Device ID storage mechanism created (vault or host_vars)\n- [ ] Device ID retrieval task implemented for existing installations\n- [ ] Auto-pairing task created using Syncthing REST API\n- [ ] Task validates device IDs before pairing\n- [ ] Task handles pairing failures gracefully\n- [ ] Task is idempotent (repeated runs do not re-pair)\n- [ ] Integration test validates auto-pairing workflow\n- [ ] Documentation added explaining device ID management\n- [ ] Security considerations documented (device ID sensitivity)","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-27T14:27:49.563767997-08:00","updated_at":"2026-01-27T19:45:12.017691044-08:00","labels":["automation","configuration-management","syncthing"],"dependencies":[{"issue_id":"fleet-2w0","depends_on_id":"fleet-4g6","type":"blocks","created_at":"2026-01-27T14:29:13.1712189-08:00","created_by":"daemon"}]}
{"id":"fleet-33f","title":"Create Syncthing API client helper task","description":"## Context\nThis subtask is part of fleet-0mw (Add Syncthing connection type verification via API). It focuses on creating reusable API client infrastructure that can be used by verification tasks.\n\n## Objective\nCreate an Ansible task file that handles Syncthing REST API client setup, including reading API keys from config, constructing base URLs, and testing connectivity.\n\n## Implementation\nCreate `roles/syncthing/tasks/api_client_setup.yml`:\n- Read Syncthing API key from `~/.local/state/syncthing/config.xml`\n- Construct base URL (http://localhost:8384)\n- Test API connectivity with /rest/system/ping\n- Register API key and base URL as facts for reuse\n\n## Acceptance Criteria\n1. Task file created at `roles/syncthing/tasks/api_client_setup.yml`\n2. Uses `ansible.builtin.xml` module to read API key from config.xml\n3. Registers `syncthing_api_key` fact\n4. Registers `syncthing_api_url` fact (default: http://localhost:8384)\n5. Uses `ansible.builtin.uri` to test `/rest/system/ping` endpoint\n6. Includes error handling for missing config or failed connectivity\n7. Follows FQCN convention for all modules\n8. Includes copyright header\n9. Passes ansible-lint validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:16:47.50886084-08:00","updated_at":"2026-01-27T15:39:16.463783725-08:00","closed_at":"2026-01-27T15:39:16.463783725-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["api","firewall","syncthing"]}
{"id":"fleet-35h","title":"Expand test coverage to all roles","description":"Currently 'mise run test' only runs the base role tests. Update the task or create new ones to run tests for all roles (sdr, meshtastic, printing_3d, etc.) to ensure complete coverage.","status":"deferred","priority":2,"issue_type":"task","created_at":"2026-01-06T16:11:36.140133708-08:00","created_by":"kayos","updated_at":"2026-01-06T16:22:41.077651275-08:00"}
{"id":"fleet-3ck","title":"Create Darwin firewall integration test","description":"## Context\nThis subtask is part of fleet-11m (Create integration test for Syncthing firewall configuration). It focuses on testing Darwin/macOS-specific firewall functionality.\n\n## Objective\nCreate an Ansible test playbook that verifies application firewall rules are properly configured and Syncthing ports are accessible on Darwin systems.\n\n## Test Coverage\n1. **Firewall Status**: Verify application firewall allows Syncthing\n2. **Port Listening**: Verify Syncthing is listening on required ports\n3. **API Access**: Test REST API connectivity (localhost)\n4. **Accessibility**: Verify ports are not blocked by application firewall\n\n## Implementation Location\n`roles/syncthing/tests/test_darwin_firewall.yml`\n\n## Acceptance Criteria\n1. Test playbook created at specified location\n2. Uses appropriate Darwin commands to check firewall status\n3. Uses `ansible.builtin.wait_for` to check port 22000 TCP listening\n4. Uses `ansible.builtin.wait_for` to check port 21027 UDP listening\n5. Tests API connectivity via /rest/system/ping\n6. Includes check mode compatibility (--check)\n7. Uses `ansible.builtin.assert` for all validations\n8. Provides clear failure messages\n9. Follows FQCN convention\n10. Includes copyright header\n11. Passes ansible-lint validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:17:10.415664603-08:00","updated_at":"2026-01-27T15:39:17.259865943-08:00","closed_at":"2026-01-27T15:39:17.259865943-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["darwin","firewall","syncthing","testing"]}
{"id":"fleet-3m1","title":"Validate syncthing role with dry-run and linting","description":"Run comprehensive validation of the syncthing role implementation through dry-run testing and linting.\n\nThis ensures the role follows all project conventions and will execute correctly on target hosts.\n\n## Acceptance Criteria\n\n- [ ] `mise run dry-run-local` completes successfully with syncthing role\n- [ ] No ansible-lint errors specific to syncthing role\n- [ ] No markdownlint errors in syncthing README.md\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes\n- [ ] Role test playbook (roles/syncthing/tests/test.yml) passes in check mode","acceptance_criteria":"- [ ] `mise run dry-run-local` completes successfully with syncthing role\n- [ ] No ansible-lint errors specific to syncthing role\n- [ ] No markdownlint errors in syncthing README.md\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes\n- [ ] Role test playbook (roles/syncthing/tests/test.yml) passes in check mode","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:57:29.447135775-08:00","updated_at":"2026-01-27T13:58:22.921733952-08:00","dependencies":[{"issue_id":"fleet-3m1","depends_on_id":"fleet-n9m","type":"blocks","created_at":"2026-01-27T13:57:40.919434758-08:00","created_by":"daemon"},{"issue_id":"fleet-3m1","depends_on_id":"fleet-byo","type":"blocks","created_at":"2026-01-27T13:57:40.941228846-08:00","created_by":"daemon"},{"issue_id":"fleet-3m1","depends_on_id":"fleet-720","type":"blocks","created_at":"2026-01-27T13:57:40.979043728-08:00","created_by":"daemon"},{"issue_id":"fleet-3m1","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:49.761267805-08:00","created_by":"daemon"}]}
{"id":"fleet-422","title":"Auto-mount Synology NAS Public volume via ZeroTier","description":"## Overview\nAdd automatic mounting of Synology NAS Public volume using the ZeroTier VPN connection. Mount should be tolerant of network interruptions and support on-demand access (autofs).\n\n## Requirements\n- Support both NFS and SMB/CIFS protocols\n- Use ZeroTier hostname for NAS connection (via fleet-6o5 ZeroTier peer discovery)\n- Implement on-demand mounting (autofs) - mount on access, not at boot\n- Handle network interruptions gracefully (reconnect after outage)\n- Apply to relevant host groups (laptop, workstation)\n\n## Technical Approach\n- Use autofs for on-demand mounting\n- Configure network mount options for resilience (soft mounts, timeouts, retries)\n- Store NAS hostname in variables (IP discovered via ZeroTier)\n- Add systemd service dependency on zerotier-one.service\n- Test with both protocols to determine best fit\n\n## Dependencies\n- **fleet-6o5:** ZeroTier peer discovery must be implemented first to provide hostname resolution\n\n## Target Hosts\n- laptop group (rincewind, dresden)\n- workstation group (jareth, constantine)\n\n## Success Criteria\n- Mount point automatically available when accessed\n- Connection survives network interruptions\n- No boot delays if ZeroTier/NAS unavailable\n- NAS referenced by hostname (not hardcoded IP)\n- All subtasks completed\n- mise run lint passes\n- mise run test passes\n- Documentation updated in AGENTS.md","status":"open","priority":1,"issue_type":"epic","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:03.212961688-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:33:19.293311884-08:00"}
{"id":"fleet-422.1","title":"Research NFS vs SMB for Synology auto-mount","description":"## Objective\nResearch and document the best protocol choice (NFS or SMB/CIFS) for auto-mounting Synology NAS Public volume via ZeroTier.\n\n## Context\n- NAS is already successfully mounted via NFS on the minecraft server\n- Can reference existing working configuration as proven implementation\n- ZeroTier hostname discovery (fleet-6o5) will provide NAS hostname automatically\n\n## Tasks\n1. **Research minecraft server existing mount:**\n   - SSH to minecraft server or check host_vars/minecraft.yml\n   - Examine /etc/fstab or /etc/auto.* files for current NFS mount\n   - Document mount options being used successfully\n   - Note any ZeroTier-specific configuration\n   - Identify exact NAS share path (e.g., /volume1/Public)\n\n2. **Test manual NFS mount:**\n   - On test host, mount using hostname: `mount -t nfs synology.zt:/Public /mnt/test`\n   - Test with soft mount options: `-o soft,timeo=600,retrans=3`\n   - Verify read/write access\n   - Test behavior with simulated network interruption\n   - Document any permission issues (uid/gid mapping)\n\n3. **Test manual SMB mount (if needed for comparison):**\n   - Mount using hostname: `mount -t cifs //synology.zt/Public /mnt/test`\n   - Test with credentials from 1Password\n   - Compare performance with NFS\n   - Note credential management complexity\n\n4. **Evaluate protocols:**\n   - **NFS advantages:** Simpler credentials (uid/gid), better Linux integration, proven working\n   - **SMB advantages:** Native Windows support (if needed), better cross-platform\n   - **Performance:** Compare latency, throughput over ZeroTier\n   - **autofs compatibility:** Both should work, NFS is more common\n\n5. **Make recommendation:**\n   - Given NFS already works on minecraft server, likely best choice\n   - Document rationale (performance, simplicity, proven implementation)\n   - List required variables for chosen protocol\n\n## Deliverables\n- Document findings as comment on this issue\n- Copy relevant minecraft server configuration\n- Recommend protocol (likely NFS based on existing use)\n- List required role variables for chosen protocol\n\n## Quality Gates\n- Document recommendation before closing task\n- Create separate tasks for any issues discovered during testing\n- If major findings, update AGENTS.md\n\n## Acceptance Criteria\n- Minecraft server NFS configuration documented\n- Manual mount tests completed on at least one laptop/workstation\n- Protocol recommendation made with clear rationale\n- Required role variables identified (hostname, share name, mount options)\n- Network interruption tolerance verified\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-6o5: Add ZeroTier network member discovery and /etc/hosts management ● P1\n\nBLOCKS\n  ← ○ fleet-422.2: Add NAS credentials to Ansible Vault ● P1\n  ← ○ fleet-422.3: (EPIC) Create nas_mount role for autofs configuration ● P1\n  ← ○ fleet-422.7: Create nas_mount role directory structure ● P1","status":"closed","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:10.429550986-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:02:56.662909384-08:00","closed_at":"2026-02-03T15:02:56.662909384-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-422.1","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:18:10.433046054-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.1","depends_on_id":"fleet-6o5","type":"blocks","created_at":"2026-02-03T13:32:58.449674745-08:00","created_by":"T.R. Fullhart"}],"comments":[{"id":1,"issue_id":"fleet-422.1","author":"T.R. Fullhart","text":"# Research Findings: NFS vs SMB for Synology Auto-Mount\n\n## Executive Summary\n\n**Recommendation: NFS (NFSv4.1)** with hard mount + intr flag for ZeroTier-based auto-mounting.\n\n**Rationale:**\n- Already proven working on minecraft server\n- Better Linux integration (no credential management needed)\n- Simpler configuration with autofs\n- Better performance characteristics for Linux clients\n- Native uid/gid mapping\n\n**Critical Prerequisite Discovered:**\n- Synology NFS exports must be updated to allow ZeroTier subnet (198.51.100.0/24)\n- Current exports only allow minecraft local IP (192.168.86.14)\n\n---\n\n## Minecraft Server Configuration Analysis\n\n### Current Active Mount\n```\n198.51.100.86.5:/volume1/k8s on /media/synology/k8s type nfs4\nOptions: rw,nosuid,relatime,vers=4.1,rsize=131072,wsize=131072,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=192.168.86.14,local_lock=none,addr=192.168.86.5\n```\n\n**Key characteristics:**\n- **NFSv4.1** protocol\n- **Hard mount**: Will retry indefinitely if NAS unreachable (suitable for important data)\n- **Large buffers**: 128KB read/write for optimal performance\n- **TCP protocol**: Reliable transport\n- **Timeout**: 60 seconds (600 deciseconds) before retry\n- **2 retransmissions** before reporting error\n\n### fstab Entries on Minecraft Server\n\n```bash\n# NFS Public share\n192.168.86.5:/volume1/Public /media/synology/public nfs rw,hard,intr,nosuid,noauto 0 0\n\n# NFS k8s share\n192.168.86.5:/volume1/k8s /media/synology/k8s nfs rw,hard,intr,nosuid,noauto 0 0\n\n# SMB Public share (alternative)\n//192.168.86.5/Public /mnt/synology cifs rw,credentials=/etc/fstab.smb.credentials,uid=kayos,gid=kayos,noauto 0 0\n```\n\n**Observations:**\n- **Both NFS and SMB configured** but using different mount points\n- **All use `noauto`**: Not mounted at boot (triggered by something else - likely autofs or systemd)\n- **Uses local network IPs** (192.168.86.5), not ZeroTier hostnames\n- **`intr` flag present**: Allows interrupting hung mount operations (good UX)\n- **SMB requires credentials file**: Additional complexity vs NFS\n\n---\n\n## Manual Mount Testing\n\n### NFS Export Query Results\n```bash\n$ /usr/sbin/showmount -e nas-server.example_network.zt\nExport list for nas-server.example_network.zt:\n/volume1/k8s    192.168.86.14\n/volume1/Public 192.168.86.14\n```\n\n**Finding:** NFS exports are restricted to specific IP (192.168.86.14 = minecraft's LOCAL IP)\n\n### Mount Test Attempt\n```bash\n$ mount -t nfs -o rw,hard,intr,nosuid,timeo=600,retrans=2 nas-server.example_network.zt:/volume1/Public /tmp/nfs-test-mount\nmount.nfs: access denied by server while mounting nas-server.example_network.zt:/volume1/Public\n```\n\n**Result:** Access denied because rincewind's ZeroTier IP (198.51.100.204) is not in NFS export allow list\n\n---\n\n## Critical Prerequisites for Implementation\n\n### 1. Update Synology NFS Export Permissions\n\n**Current State:**\n- Exports only allow 192.168.86.14 (minecraft LOCAL network IP)\n- Minecraft is NOT using ZeroTier to mount NFS currently\n\n**Required Change:**\nThe Synology NAS NFS export rules must be updated to allow the ZeroTier subnet.\n\n**Recommended approach:**\nAdd ZeroTier subnet to NFS export permissions: `198.51.100.0/24`\n\n**Alternative approaches:**\n1. Add individual ZeroTier IPs per host (more restrictive, more maintenance)\n2. Allow all hosts with `*` (less secure, not recommended)\n\n**How to update (manual steps for now):**\n1. Log into Synology DSM web interface\n2. Navigate to: Control Panel → File Services → NFS\n3. Edit NFS rules for `/volume1/Public` and `/volume1/k8s`\n4. Add entry: `198.51.100.0/255.255.255.0` with appropriate permissions\n5. Test mount again from rincewind\n\n**Future automation opportunity:**\nCould potentially automate via Synology API, but manual configuration is acceptable for initial setup.\n\n---\n\n## NFS vs SMB Comparison\n\n### NFS Advantages ✅\n1. **Simpler authentication**: Uses UID/GID mapping, no credentials file needed\n2. **Better Linux integration**: Native filesystem operations\n3. **Proven working**: Already used successfully on minecraft server\n4. **Autofs compatibility**: Standard pattern for on-demand mounting\n5. **Performance**: Lower overhead for Linux-to-Linux NAS\n6. **Configuration simplicity**: Fewer variables to manage in Ansible\n\n### SMB/CIFS Disadvantages ❌\n1. **Requires credentials**: Must store username/password in vault\n2. **Credentials file management**: `/etc/fstab.smb.credentials` per host\n3. **Permission mapping complexity**: Need explicit uid/gid options\n4. **Additional packages**: Requires `cifs-utils` package\n5. **Overhead**: CIFS protocol has more overhead than NFS for Linux clients\n\n### When SMB Might Be Better\n- Mixed Windows/Linux environment (not our case)\n- Active Directory integration needed (not our case)\n- NAS doesn't support NFS (not our case)\n\n---\n\n## Recommended Implementation Details\n\n### Protocol \u0026 Version\n- **NFS version 4.1** (explicitly specify with `nfsvers=4.1` option)\n- Use `nfs` or `nfs4` fstype in fstab/autofs (both work)\n\n### Mount Options\n```\nrw,hard,intr,nosuid,timeo=600,retrans=2,nfsvers=4.1,_netdev\n```\n\n**Option explanations:**\n- `rw`: Read-write access\n- `hard`: Retry indefinitely if server unreachable (vs `soft` which times out)\n- `intr`: Allow interrupting hung operations (prevents total system freeze)\n- `nosuid`: Security hardening (ignore setuid bits)\n- `timeo=600`: 60-second timeout before retry\n- `retrans=2`: 2 retransmissions before error\n- `nfsvers=4.1`: Explicitly use NFSv4.1\n- `_netdev`: Wait for network before attempting mount (important for ZeroTier)\n\n### Autofs Configuration Pattern\n```\n# /etc/auto.master.d/synology.autofs\n/media/synology /etc/auto.synology --timeout=300\n\n# /etc/auto.synology\npublic -fstype=nfs,rw,hard,intr,nosuid,timeo=600,retrans=2,nfsvers=4.1 nas-server.example_network.zt:/volume1/Public\n```\n\n### Required Ansible Variables\n\nFor the `nas_mount` role (future implementation in fleet-422.3+):\n\n```yaml\n# group_vars/all/vars.yml\nnas_hostname: nas-server.example_network.zt\nnas_protocol: nfs\nnas_shares:\n  - name: public\n    remote_path: /volume1/Public\n    local_mount: /media/synology/public\n    mount_options: \"rw,hard,intr,nosuid,timeo=600,retrans=2,nfsvers=4.1,_netdev\"\n    autofs_timeout: 300  # seconds of idle before auto-unmount\n```\n\n**No vault secrets needed for NFS!** (Unlike SMB which would need username/password)\n\n---\n\n## Network Interruption Tolerance\n\n### Expected Behavior with Hard Mount + Intr\n1. **ZeroTier network interruption**: Operations will hang, retry every 60s\n2. **User can interrupt**: Ctrl+C will work due to `intr` flag\n3. **Automatic recovery**: When ZeroTier reconnects, operations resume\n4. **No data corruption**: Hard mount ensures data integrity\n\n### Alternative: Soft Mount\nCould use `soft` instead of `hard` for better responsiveness:\n- Operations timeout after 60s instead of retrying forever\n- Risk: Possible data corruption if writes fail\n- Better for: Non-critical read-only shares\n- **Recommendation**: Stick with `hard` for data integrity\n\n### Testing Strategy (for future validation)\n1. Mount NFS share on test host\n2. Create test file to verify write access\n3. Stop ZeroTier: `systemctl stop zerotier-one`\n4. Attempt ls operation (should hang, Ctrl+C should work due to `intr`)\n5. Start ZeroTier: `systemctl start zerotier-one`\n6. Wait 30-60 seconds for reconnection\n7. Verify operations resume normally\n\n---\n\n## Dependencies \u0026 Prerequisites\n\n### Package Dependencies\n- **NFS client**: `nfs-common` package (Debian/Ubuntu)\n  - Provides: `mount.nfs`, `showmount`, `rpcbind`, etc.\n  - Already added to base role during this research\n- **Autofs**: `autofs` package (for on-demand mounting)\n  - Not yet in base role, will need to be added in fleet-422.3\n\n### Network Dependencies\n- **ZeroTier**: Must be joined to network and connected\n  - Satisfied by existing `base` role ZeroTier configuration\n- **Hostname resolution**: ZeroTier peer discovery providing `/etc/hosts` entries\n  - Satisfied by fleet-6o5 (completed)\n- **NFS export permissions**: Synology must allow ZeroTier subnet\n  - **NOT YET SATISFIED** - requires manual Synology configuration\n\n---\n\n## Next Steps (Dependency Chain)\n\n1. **BLOCKER**: Update Synology NFS exports to allow 198.51.100.0/24\n   - Manual step: Log into Synology DSM → File Services → NFS → Edit permissions\n   - Create new task: \"Update Synology NFS exports for ZeroTier access\"\n\n2. **fleet-422.2**: Add NAS credentials to Ansible Vault\n   - **Actually may not be needed for NFS!** \n   - Only needed if we decide to support SMB as fallback\n   - Recommend: Skip or make optional, NFS doesn't need credentials\n\n3. **fleet-422.7**: Create nas_mount role directory structure\n   - Standard Ansible role structure\n   - Platform-specific task files (linux_*.yml, darwin_*.yml)\n\n4. **fleet-422.3**: Implement autofs configuration\n   - Install autofs package\n   - Template /etc/auto.master.d/synology.autofs\n   - Template /etc/auto.synology with share definitions\n   - Enable and start autofs service\n\n5. **Testing \u0026 Validation**\n   - Verify mounts appear on-demand\n   - Test autofs timeout (unmounts after idle period)\n   - Test network interruption recovery\n   - Verify permissions and file access\n\n---\n\n## Recommendation Summary\n\n**Use NFS with the following configuration:**\n\n- **Protocol**: NFSv4.1\n- **Mount Type**: autofs (on-demand mounting)\n- **Mount Options**: `rw,hard,intr,nosuid,timeo=600,retrans=2,nfsvers=4.1,_netdev`\n- **Hostname**: Use ZeroTier FQDN (`nas-server.example_network.zt`)\n- **Share Path**: `/volume1/Public` (matches minecraft server's proven configuration)\n- **Local Mount**: `/media/synology/public` (consistent with minecraft server)\n- **Autofs Timeout**: 300 seconds (5 minutes of idle before auto-unmount)\n\n**No credentials management needed!** NFS uses UID/GID mapping, significantly simpler than SMB.\n\n**Critical prerequisite**: Synology NFS exports must be updated to allow ZeroTier subnet before implementation can proceed.","created_at":"2026-02-03T23:02:56Z"}]}
{"id":"fleet-422.10","title":"Implement autofs service management and systemd dependencies","description":"## Objective\nCreate tasks and handlers to manage autofs (Linux) and automount (macOS) service lifecycle and ensure proper dependency ordering.\n\n## Files to Update\n- `roles/nas_mount/handlers/main.yml`: Add restart/reload handlers\n- `roles/nas_mount/tasks/linux_configure_autofs.yml`: Add service management (or separate task file)\n- `roles/nas_mount/tasks/darwin_configure_autofs.yml`: Add automount reload\n\n## Linux Implementation\n\n### Handler (`handlers/main.yml`):\n```yaml\n- name: restart autofs\n  ansible.builtin.systemd:\n    name: autofs\n    state: restarted\n  become: true\n  listen: \"restart autofs\"\n```\n\n### Tasks (add to `linux_configure_autofs.yml` or separate file):\n1. **Enable and start autofs service:**\n   ```yaml\n   - name: \"NAS Mount | Enable and start autofs service\"\n     ansible.builtin.systemd:\n       name: autofs\n       enabled: true\n       state: started\n     become: true\n   ```\n\n2. **Create systemd drop-in for dependency ordering:**\n   ```yaml\n   - name: \"NAS Mount | Ensure autofs depends on zerotier-one\"\n     ansible.builtin.copy:\n       dest: /etc/systemd/system/autofs.service.d/override.conf\n       content: |\n         [Unit]\n         After=zerotier-one.service\n         Wants=zerotier-one.service\n       mode: '0644'\n     become: true\n     notify: restart autofs\n   ```\n\n3. **Reload systemd daemon:**\n   ```yaml\n   - name: \"NAS Mount | Reload systemd daemon\"\n     ansible.builtin.systemd:\n       daemon_reload: true\n     become: true\n     when: drop-in file changed\n   ```\n\n## macOS Implementation\n\n### Handler (`handlers/main.yml`):\n```yaml\n- name: reload automount\n  ansible.builtin.command: automount -vc\n  become: true\n  listen: \"reload automount\"\n```\n\n### Tasks (add to `darwin_configure_autofs.yml`):\n1. **Reload automount configuration:**\n   ```yaml\n   - name: \"NAS Mount | Reload automount configuration\"\n     ansible.builtin.command: automount -vc\n     become: true\n     changed_when: false\n   ```\n\nNote: macOS automount is managed by `launchd` and doesn't need explicit service enabling. The daemon starts automatically when `/etc/auto_master` is configured.\n\n## Quality Gates\n- Run `mise run lint` before commit\n- Run `mise run test` to verify task syntax\n- Test with `mise run dry-run-local` to see systemd changes\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If systemd module fails on non-systemd systems, add conditional checks\n- If zerotier-one.service not found, document dependency in role README\n- If automount command fails on macOS, file separate task for troubleshooting\n\n## Acceptance Criteria\n- Linux handler restarts autofs when notified\n- macOS handler reloads automount when notified\n- Linux service enabled and started by role\n- Linux systemd drop-in configures proper service ordering\n- Service won't start before ZeroTier is ready on Linux\n- macOS automount reloads configuration after template changes\n- Copyright header present\n- `mise run lint` passes\n- `mise run test` passes\n- Changes committed and pushed\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-422.12: Create autofs configuration deployment tasks ● P1\n  → ○ fleet-422.9: (EPIC) Create autofs configuration template and tasks ● P1\n\nBLOCKS\n  ← ○ fleet-422.4: Add nas_mount role to host configurations ● P1","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:22:03.028082915-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:49:19.324217777-08:00","dependencies":[{"issue_id":"fleet-422.10","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:22:03.031601901-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.10","depends_on_id":"fleet-422.9","type":"blocks","created_at":"2026-02-03T13:22:15.015373119-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.10","depends_on_id":"fleet-422.12","type":"blocks","created_at":"2026-02-03T13:27:03.092695125-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.11","title":"Create autofs map Jinja2 template","description":"## Objective\nCreate platform-specific Jinja2 templates for autofs (Linux) and automount (macOS) map configuration.\n\n## Context\n- Linux uses `/etc/auto.master` and `/etc/auto.nas` (indirect map)\n- macOS uses `/etc/auto_master` and `/etc/auto_nas` (different syntax)\n- Variables use hostnames from ZeroTier discovery, not hardcoded IPs\n- Protocol choice (NFS/SMB) based on fleet-422.1 research\n\n## Files to Create\n- `roles/nas_mount/templates/linux_auto.nas.j2` - Linux autofs map\n- `roles/nas_mount/templates/darwin_auto_nas.j2` - macOS automount map\n\n## Linux Template (`linux_auto.nas.j2`)\n**NFS format:**\n```jinja\n# Autofs map for NAS mounts over ZeroTier\n# Managed by Ansible - do not edit manually\nPublic -fstype=nfs,soft,timeo=600,retrans=3 {{ nas_hostname }}:/{{ nas_share_name }}\n```\n\n**SMB format (if chosen):**\n```jinja\n# Autofs map for NAS mounts over ZeroTier\n# Managed by Ansible - do not edit manually\nPublic -fstype=cifs,credentials=/etc/autofs.creds,{{ nas_smb_options }} ://{{ nas_hostname }}/{{ nas_share_name }}\n```\n\n## macOS Template (`darwin_auto_nas.j2`)\nmacOS automount uses slightly different syntax:\n**NFS format:**\n```jinja\n# Automount map for NAS mounts over ZeroTier\n# Managed by Ansible - do not edit manually\nPublic -fstype=nfs,resvport {{ nas_hostname }}:/{{ nas_share_name }}\n```\n\nNote: macOS NFS mount options differ (uses `resvport` instead of `soft,timeo,retrans`)\n\n## Variables Expected\n- `nas_hostname`: From ZeroTier discovery (e.g., \"synology.zt\")\n- `nas_share_name`: Share name on NAS (e.g., \"Public\")\n- `nas_smb_options`: SMB mount options (if SMB chosen)\n- `nas_nfs_options`: NFS mount options (if needed for overrides)\n\n## Quality Gates\n- Template syntax valid (no Jinja2 errors)\n- Run `mise run lint` before commit\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If unsure of autofs map syntax, research autofs/automount documentation\n- If variable names unclear, refer to fleet-422.2 credential task\n\n## Acceptance Criteria\n- Linux template created in correct location\n- macOS template created with platform-appropriate syntax\n- Proper Jinja2 variable syntax used\n- Protocol-appropriate format based on research outcome\n- Comments document variable usage and Ansible management\n- Copyright header present\n- `mise run lint` passes\n- Changes committed and pushed\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-422.8: Implement autofs package installation tasks ● P1\n\nBLOCKS\n  ← ○ fleet-422.12: Create autofs configuration deployment tasks ● P1","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:26:44.199361277-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:47:40.138152893-08:00","dependencies":[{"issue_id":"fleet-422.11","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:26:44.202452092-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.11","depends_on_id":"fleet-422.8","type":"blocks","created_at":"2026-02-03T13:27:02.798330303-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.12","title":"Create autofs configuration deployment tasks","description":"## Objective\nCreate platform-specific Ansible tasks to deploy autofs (Linux) and automount (macOS) configuration files.\n\n## Files to Create\n- `roles/nas_mount/tasks/linux_configure_autofs.yml` - Linux autofs deployment\n- `roles/nas_mount/tasks/darwin_configure_autofs.yml` - macOS automount deployment\n\n## Linux Implementation (`linux_configure_autofs.yml`)\n\n### Tasks to Implement:\n1. **Deploy master configuration file:**\n   - Target: `/etc/auto.master.d/nas.autofs`\n   - Content: `/nas /etc/auto.nas --timeout=300`\n   - Module: `ansible.builtin.copy`\n   \n2. **Deploy map file from template:**\n   - Target: `/etc/auto.nas`\n   - Template: `linux_auto.nas.j2`\n   - Module: `ansible.builtin.template`\n   \n3. **Set file permissions:**\n   - Owner: root:root\n   - Mode: 0644\n   \n4. **Add notify to restart autofs handler**\n\n5. **If SMB: Deploy credentials file:**\n   - Target: `/etc/autofs.creds`\n   - Content: username/password from 1Password\n   - Mode: 0600 (secure)\n\n## macOS Implementation (`darwin_configure_autofs.yml`)\n\n### Tasks to Implement:\n1. **Update /etc/auto_master:**\n   - Add line: `/nas auto_nas`\n   - Module: `ansible.builtin.lineinfile`\n   \n2. **Deploy map file from template:**\n   - Target: `/etc/auto_nas`\n   - Template: `darwin_auto_nas.j2`\n   - Module: `ansible.builtin.template`\n   \n3. **Set file permissions:**\n   - Owner: root:wheel (macOS uses wheel group)\n   - Mode: 0644\n   \n4. **Add notify to reload automount handler**\n   - Handler: `automount -vc` (not systemctl)\n\n## Main.yml Integration\n```yaml\n- name: \"NAS Mount | Configure autofs/automount\"\n  ansible.builtin.include_tasks: \"{{ ansible_facts.system | lower }}_configure_autofs.yml\"\n```\n\n## Quality Gates\n- Run `mise run lint` before commit\n- Run `mise run test` to verify task syntax\n- Run `mise run dry-run-local` to verify files will be deployed correctly\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If template module fails, verify template file exists (fleet-422.11)\n- If file paths wrong, research platform-specific autofs/automount locations\n- If handler fails, file separate task for handler implementation\n\n## Acceptance Criteria\n- Linux configuration deployment tasks implemented\n- macOS configuration deployment tasks implemented\n- Both platforms deploy map files with correct paths\n- Permissions set correctly (root:root on Linux, root:wheel on macOS)\n- Handler notifications configured\n- Tasks included from main.yml using platform detection\n- Copyright header present\n- `mise run lint` passes\n- `mise run test` passes\n- `mise run dry-run-local` shows files will be created\n- Changes committed and pushed\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-422.11: Create autofs map Jinja2 template ● P1\n\nBLOCKS\n  ← ○ fleet-422.10: Implement autofs service management and systemd dependencies ● P1","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:26:52.700074341-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:47:54.386167706-08:00","dependencies":[{"issue_id":"fleet-422.12","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:26:52.70303303-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.12","depends_on_id":"fleet-422.11","type":"blocks","created_at":"2026-02-03T13:27:02.940284216-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.13","title":"Update Synology NFS exports to allow ZeroTier subnet access","description":"## Objective\nUpdate Synology NAS NFS export permissions to allow ZeroTier subnet (198.51.100.0/24) access.\n\n## Context\nResearch in fleet-422.1 discovered that current NFS exports only allow minecraft server's local IP (192.168.86.14). This blocks other hosts from mounting via ZeroTier.\n\n## Current Export Permissions\n- /volume1/Public: Only 192.168.86.14 allowed\n- /volume1/k8s: Only 192.168.86.14 allowed\n\n## Required Changes\nAdd ZeroTier subnet to NFS export rules: 198.51.100.0/255.255.255.0\n\n## Manual Steps\n1. Log into Synology DSM web interface\n2. Navigate to: Control Panel → File Services → NFS\n3. Click on NFS Rules tab\n4. Edit rule for /volume1/Public:\n   - Add new IP rule: 198.51.100.0\n   - Netmask: 255.255.255.0\n   - Permissions: Read/Write\n   - Squash: Map all users to admin (or appropriate setting)\n   - Enable async\n5. Repeat for /volume1/k8s if k8s share needs ZeroTier access\n6. Apply changes\n\n## Testing\nAfter changes, test from rincewind:\n```bash\nmkdir -p /tmp/nfs-test\nansible localhost -m ansible.builtin.mount -a \"path=/tmp/nfs-test src=nas-server.example_network.zt:/volume1/Public fstype=nfs opts='rw,hard,intr,nosuid' state=mounted\" --become --connection=local\nls /tmp/nfs-test\ntouch /tmp/nfs-test/test-write-access.txt\nansible localhost -m ansible.builtin.mount -a \"path=/tmp/nfs-test state=unmounted\" --become --connection=local\n```\n\nShould succeed without 'access denied' error.\n\n## Future Automation\nCould potentially automate via Synology API in future, but manual is acceptable for initial setup.","acceptance_criteria":"- Synology NFS exports updated to allow 198.51.100.0/24\n- Test mount from rincewind succeeds\n- Read/write access verified\n- Settings documented","status":"closed","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:03:17.458144863-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:15:59.78023066-08:00","closed_at":"2026-02-03T15:15:59.78023066-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-422.13","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T15:03:17.461133594-08:00","created_by":"T.R. Fullhart"}],"comments":[{"id":2,"issue_id":"fleet-422.13","author":"T.R. Fullhart","text":"## Synology Configuration Complete\n\n**Date:** 2026-02-03T23:13:42Z\n\n### Configuration Applied\n\n**NFS Export Updates:**\n- **Share:** `/volume1/Public`\n- **Old Permissions:** 192.168.86.14 only (minecraft local IP)\n- **New Permissions:** 198.51.100.0/24 (ZeroTier subnet) + 192.168.86.14\n- **Protocol:** NFSv4.1\n- **Access:** Read/Write\n\n**Confirmed via showmount:**\n```\n/volume1/Public 198.51.100.0/24,192.168.86.14\n/volume1/k8s    192.168.86.14\n```\n\n### Test Results from rincewind (198.51.100.204)\n\n**Mount Test:** ✓ SUCCESS\n- Mount succeeded with NFSv4.1\n- Options applied: `rw,hard,intr,nosuid,timeo=600,retrans=2,nfsvers=4.1`\n- Actual mount options from kernel: `rw,nosuid,relatime,vers=4.1,rsize=131072,wsize=131072,namlen=255,hard,fatal_neterrors=none,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=198.51.100.204,local_lock=none,addr=198.51.100.193`\n\n**Read Access:** ✓ SUCCESS\n- Successfully listed directory contents\n- Permissions: drwxrwxrwx (directories), -rwxrwxrwx (files)\n- Owner/Group visible: UID 1026, GID users\n\n**Write Access:** ✓ SUCCESS\n- Created test file: `test-write-rincewind-1770160431.txt`\n- File ownership: UID 0 (root), GID 0 (root)\n- Note: File created as root due to \"Map all users to admin\" squash setting\n\n### Observations\n\n**File Ownership Behavior:**\n- Files created by root user map to UID 0 on NAS (expected with admin squash)\n- Existing files show correct UID/GID (1026/users)\n- This is acceptable for fleet use case (user-level access via autofs will use kayos UID)\n\n**Network Performance:**\n- Connected via ZeroTier: 198.51.100.204 → 198.51.100.193\n- Transfer size: rsize=131072, wsize=131072 (128KB - optimal)\n- No latency issues observed\n\n**Security Settings:**\n- `nosuid` flag active (correct - security best practice)\n- `sec=sys` authentication (standard UID/GID mapping)\n\n### Blocker Resolution\n\n**Status:** RESOLVED ✓\n\nAll downstream tasks now unblocked:\n- fleet-422.7: Create nas_mount role\n- fleet-422.3: Implement autofs configuration\n- fleet-422.2: Add NAS credentials (optional - NFS doesn't need this)\n\n### Next Steps\n\n1. ✅ Close fleet-422.13\n2. → Proceed with fleet-422.7 (role structure)\n3. → Proceed with fleet-422.3 (autofs implementation)\n\n### References\n\n- Test script: `/tmp/test-nfs-permissions.sh`\n- Full test output: See issue comment\n- Synology hostname: `nas-server.example_network.zt` (198.51.100.193)\n- Recommended mount options: `rw,hard,intr,nosuid,timeo=600,retrans=2,nfsvers=4.1,_netdev`","created_at":"2026-02-03T23:15:56Z"}]}
{"id":"fleet-422.2","title":"Add NAS credentials to Ansible Vault","description":"## Objective\nStore Synology NAS connection credentials in 1Password. Use op CLI to retrieve credentials in Ansible tasks (NOT Ansible Vault).\n\n## Context\n- ZeroTier hostname discovery (fleet-6o5) provides NAS hostname automatically\n- No hardcoded IPs needed - hostname comes from /etc/hosts\n- SMB credentials should be in 1Password for consistency with vault_password and become_password patterns\n\n## Tasks\n1. **Check existing 1Password items:**\n   - Search for existing Synology/NAS credentials in 1Password\n   - Check ZeroTier Central login credentials location\n   \n2. **Create/verify 1Password items:**\n   - If SMB protocol chosen: Create item with username, password, domain/workgroup\n   - Document item path (e.g., `op://ServiceAccountAccess/Synology NAS SMB/username`)\n   \n3. **Document retrieval pattern:**\n   - Add variable to role defaults: `nas_smb_user: \"{{ lookup('pipe', 'op read op://path/to/username') }}\"`\n   - Or use ansible.builtin.command in tasks: `op read op://path/to/credential`\n   - Follow existing .get_vault_password.sh pattern for consistency\n\n## Variables to Define (Protocol-Dependent)\n**Common (from fleet-6o5):**\n- `nas_hostname`: Retrieved from /etc/hosts ZeroTier discovery (e.g., \"synology.zt\")\n- `nas_share_name`: Name of Public share (likely \"Public\")\n\n**If NFS chosen:**\n- `nas_nfs_options`: NFS mount options string (can be in defaults/main.yml)\n\n**If SMB chosen (from 1Password):**\n- `nas_smb_user`: `{{ lookup('pipe', 'op read op://path/to/username') }}`\n- `nas_smb_password`: `{{ lookup('pipe', 'op read op://path/to/password') }}`\n- `nas_smb_domain`: `{{ lookup('pipe', 'op read op://path/to/domain') }}` (if needed)\n- `nas_smb_options`: SMB mount options string (can be in defaults/main.yml)\n\n## 1Password Item Structure\n**Suggested path:** `op://ServiceAccountAccess/Synology NAS SMB/`\n**Fields:**\n- username\n- password\n- domain (or workgroup)\n- notes: Document which share this applies to\n\n## Quality Gates\n- Verify 1Password CLI can read credentials: `op read op://path/to/item`\n- Ensure op session active (check with `op whoami`)\n- No plaintext credentials in any committed files\n- Run `mise run lint` before commit\n- Document 1Password paths in role README or defaults/main.yml comments\n\n## Error Handling\n- If op CLI issues occur, file separate task for 1Password troubleshooting\n- If credentials don't exist, coordinate with user to create them\n- If protocol decision changes, update accordingly\n\n## Acceptance Criteria\n- SMB credentials exist in 1Password (if SMB protocol chosen)\n- 1Password item path documented in role defaults or README\n- Credential retrieval pattern follows existing fleet patterns\n- No plaintext credentials anywhere in repository\n- Changes committed and pushed\n\n## Note\nThis task may become WONTFIX if NFS is chosen and requires no authentication. Decision depends on fleet-422.1 research results.","status":"closed","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:13.978631602-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:16:38.736975047-08:00","closed_at":"2026-02-03T15:16:38.736975047-08:00","close_reason":"wontfix","dependencies":[{"issue_id":"fleet-422.2","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:18:13.982023502-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.2","depends_on_id":"fleet-422.1","type":"blocks","created_at":"2026-02-03T13:18:33.650888957-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.2","depends_on_id":"fleet-6o5","type":"blocks","created_at":"2026-02-03T13:32:58.597360326-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.2","depends_on_id":"fleet-422.13","type":"blocks","created_at":"2026-02-03T15:03:23.448585961-08:00","created_by":"T.R. Fullhart"}],"comments":[{"id":3,"issue_id":"fleet-422.2","author":"T.R. Fullhart","text":"## Closing Rationale: NFS Doesn't Require Credentials\n\n**Decision:** Based on fleet-422.1 research and fleet-422.13 successful testing, proceeding with **NFSv4.1** protocol.\n\n### Why No Credentials Needed\n\n**NFS Authentication Model:**\n- Uses UID/GID mapping at file system level\n- No username/password required for mount operation\n- Security model: `sec=sys` (standard UNIX permissions)\n- Access control handled by Synology export permissions (IP-based, now configured)\n\n**Proven Working:**\n- Minecraft server uses NFS without credentials (verified in fleet-422.1)\n- Test mount in fleet-422.13 succeeded without any authentication\n- File access works correctly with UID/GID mapping\n\n**Comparison to SMB:**\n- SMB would require: username, password, domain/workgroup\n- SMB would need: credentials file per host (`/etc/fstab.smb.credentials`)\n- NFS simpler: No credential management, no vault lookups\n\n### Implementation Impact\n\n**Variables Still Needed (No Credentials):**\n- `nas_hostname`: From ZeroTier discovery (fleet-6o5) ✓\n- `nas_share_name`: Share path on NAS (e.g., \"Public\")\n- `nas_nfs_options`: Mount options string\n- `nas_mount_point`: Local mount path\n\n**Variables NOT Needed:**\n- ~~nas_smb_user~~ (NFS doesn't use)\n- ~~nas_smb_password~~ (NFS doesn't use)\n- ~~nas_smb_domain~~ (NFS doesn't use)\n\n### Quality Implications\n\n**Simplified Implementation:**\n- No 1Password lookups in tasks\n- No credential file management\n- No vault secret rotation concerns\n- Fewer failure modes (no auth errors)\n\n**Security Considerations:**\n- Access controlled by Synology export rules (IP-based)\n- ZeroTier provides network-level security\n- File-level permissions via UID/GID (POSIX model)\n- `nosuid` mount option prevents privilege escalation\n\n### Recommendation\n\nClose this task as **WONTFIX**. Proceed directly to:\n1. fleet-422.7: Create nas_mount role structure\n2. fleet-422.3: Implement autofs configuration\n\nIf future requirements change (need SMB, need user-level auth), reopen this task.\n\n### References\n\n- fleet-422.1: Research showing NFS advantages\n- fleet-422.13: Successful NFS mount test without credentials\n- Minecraft server: Proven NFS usage pattern","created_at":"2026-02-03T23:16:34Z"}]}
{"id":"fleet-422.3","title":"Create nas_mount role for autofs configuration","description":"## Objective\nCreate a complete Ansible role that configures autofs for on-demand mounting of the Synology NAS Public volume.\n\n## Overview\nThis epic coordinates the creation of the nas_mount role through four subtasks:\n1. Role scaffolding (fleet-422.7)\n2. Package installation (fleet-422.8)\n3. Configuration templates (fleet-422.9)\n4. Service management (fleet-422.10)\n\n## Role Structure (Final)\n- roles/nas_mount/tasks/main.yml\n- roles/nas_mount/tasks/linux_install_autofs.yml\n- roles/nas_mount/tasks/linux_configure_autofs.yml\n- roles/nas_mount/defaults/main.yml\n- roles/nas_mount/handlers/main.yml\n- roles/nas_mount/templates/auto.nas.j2\n- roles/nas_mount/tests/test.yml\n\n## Success Criteria\n- All subtasks completed\n- Role follows existing patterns (FQCN, copyright headers, named tasks)\n- Platform-specific task files for Linux (Darwin optional)\n- autofs service properly configured with systemd dependencies\n- All changes committed and pushed","status":"closed","priority":1,"issue_type":"epic","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:19.990914783-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:29:26.028042798-08:00","closed_at":"2026-02-03T15:29:26.028042798-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-422.3","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:18:19.994294058-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.3","depends_on_id":"fleet-422.1","type":"blocks","created_at":"2026-02-03T13:18:33.787590913-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.3","depends_on_id":"fleet-422.2","type":"blocks","created_at":"2026-02-03T13:18:33.958269086-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.3","depends_on_id":"fleet-422.13","type":"blocks","created_at":"2026-02-03T15:03:23.696424596-08:00","created_by":"T.R. Fullhart"}],"comments":[{"id":5,"issue_id":"fleet-422.3","author":"T.R. Fullhart","text":"## Role Implementation Complete\n\n**Date:** 2026-02-03\n**Host Tested:** rincewind (Debian Unstable, ARM64)\n\n### Implementation Summary\n\nComplete nas_mount role implementation with autofs-based on-demand NFS mounting:\n- Linux (Debian/Arch) and macOS platform support\n- NFSv4.1 protocol over ZeroTier VPN\n- On-demand mounting with 5-minute auto-unmount\n- Network interruption tolerant (hard,intr mount options)\n- No credentials required (NFS UID/GID mapping)\n\n### Files Created\n\n**Role Structure:**\n- `roles/nas_mount/tasks/main.yml` - Main entry point, loads OS variables, includes platform tasks\n- `roles/nas_mount/tasks/linux_autofs.yml` - Linux autofs configuration (apt/pacman package install)\n- `roles/nas_mount/tasks/darwin_autofs.yml` - macOS autofs configuration (built-in NFS)\n- `roles/nas_mount/defaults/main.yml` - Default variables (all with nas_mount_ prefix)\n- `roles/nas_mount/vars/debian.yml` - Debian package list (nfs-common, autofs)\n- `roles/nas_mount/vars/darwin.yml` - macOS variables\n- `roles/nas_mount/templates/synology.autofs.j2` - Autofs master map entry template\n- `roles/nas_mount/templates/auto.synology.j2` - Autofs map file template\n- `roles/nas_mount/handlers/main.yml` - Autofs service restart handlers\n- `roles/nas_mount/tests/test.yml` - Test playbook for role\n- `roles/nas_mount/README.md` - Comprehensive documentation\n\n**Host Configuration Updated:**\n- `host_vars/rincewind.yml` - Added nas_mount to roles_to_run\n- `host_vars/dresden.yml` - Added nas_mount to roles_to_run\n- `host_vars/jareth.yml` - Added nas_mount to roles_to_run\n- `host_vars/constantine.yml` - Added nas_mount to roles_to_run\n\n### Quality Gates\n\n✅ **Linting:** All checks passed\n- ansible-lint: Passed with production profile (0 failures, 0 warnings)\n- markdownlint: All files clean\n- beads lint: No template warnings\n\n✅ **Code Quality:**\n- All variables follow ansible-lint naming convention (nas_mount_ prefix)\n- Markdown documentation properly formatted (blank lines around code/lists)\n- Copyright headers on all files\n- FQCN for all Ansible modules\n\n### Testing Results\n\n**Check Mode:** ✅ PASSED\n- Template rendering correct\n- Variables properly substituted\n- Dependencies resolved correctly\n- Configuration files would be created correctly\n\n**Application:** ✅ SUCCESS\n- Packages installed: autofs, libnsl2 (new dependencies)\n- Mount point created: /media/synology/public (owner: kayos, mode: 0755)\n- Autofs master map: /etc/auto.master.d/synology.autofs\n- Autofs map file: /etc/auto.synology\n- Autofs service enabled and restarted\n\n**Auto-Mount:** ✅ WORKING\n- Trigger: `ls /media/synology/public` successfully triggered mount\n- Contents visible: 20+ directories/files from Synology Public share\n- Read access: Successful (can read existing files)\n- UID/GID mapping: Correct (files show as UID 1026, preserving NAS ownership)\n\n**Mount Configuration Verified:**\n- Mount point: /media/synology/public\n- NAS: nas-server.example_network.zt:/volume1/Public\n- Protocol: NFSv4.1 (automatically selected)\n- Options: rw,hard,intr,nosuid,timeo=600,retrans=2,_netdev,nfsvers=4.1\n\n**Permissions Behavior (As Expected):**\n- Read access: ✅ Working for all users\n- Write access: Controlled by NFS UID/GID mapping (directory owned by UID 1026)\n- This is correct NFS behavior - permissions preserved from NAS\n\n### Configuration Applied\n\n**Mount Point:** `/media/synology/public`\n**NAS Share:** `nas-server.example_network.zt:/volume1/Public`\n**Protocol:** NFSv4.1\n**Mount Type:** On-demand (autofs)\n**Auto-Unmount Timeout:** 300 seconds (5 minutes idle)\n\n**Mount Options:**\n```\nrw,hard,intr,nosuid,timeo=600,retrans=2,_netdev,nfsvers=4.1\n```\n\n**Option Details:**\n- `rw`: Read-write access\n- `hard`: Retry indefinitely for data integrity\n- `intr`: Allow Ctrl+C to interrupt hung operations\n- `nosuid`: Security - ignore setuid/setgid bits\n- `timeo=600`: 60 second timeout before retry\n- `retrans=2`: 2 retransmissions before error\n- `_netdev`: Wait for network before mounting\n- `nfsvers=4.1`: Use NFSv4.1 protocol\n\n### Target Hosts\n\n**Applied:**\n- ✅ rincewind (tested, working)\n\n**Pending Application:**\n- ⏳ dresden (macOS laptop)\n- ⏳ jareth (Linux workstation)\n- ⏳ constantine (Linux workstation)\n\n### Dependencies\n\n**Resolved:**\n- ✅ fleet-6o5: ZeroTier peer discovery (provides nas-server.example_network.zt hostname)\n- ✅ fleet-422.13: Synology NFS export permissions (198.51.100.0/24 allowed)\n\n**Future Work:**\n- Document NAS mount section in AGENTS.md\n- Test on macOS (dresden)\n- Test on other workstations (jareth, constantine)\n- Verify auto-unmount timeout behavior (requires 5+ minute idle test)\n- Test network interruption recovery (ZeroTier disconnect/reconnect)\n\n### Architecture Notes\n\n**Why NFS over SMB:**\n- No credentials required (vs SMB username/password)\n- UID/GID mapping for permissions\n- Better Linux integration\n- Proven working pattern (minecraft server)\n- Lower protocol overhead\n\n**Why Autofs over fstab:**\n- On-demand mounting (only when accessed)\n- No boot delays if NAS/ZeroTier unavailable\n- Auto-unmount after idle timeout (resource efficiency)\n- Graceful degradation on network issues\n\n**Mount Option Rationale:**\n- Hard mounts: Data integrity priority (retries indefinitely)\n- Interrupt flag: User can Ctrl+C to escape hung operations\n- Network device flag: Ensures ZeroTier up before mounting","created_at":"2026-02-03T23:29:14Z"}]}
{"id":"fleet-422.4","title":"Add nas_mount role to host configurations","description":"## Objective\nAdd the nas_mount role to the roles_to_run list for laptop and workstation hosts.\n\n## Files to Update\n- `host_vars/rincewind.yml` (laptop)\n- `host_vars/dresden.yml` (laptop)\n- `host_vars/jareth.yml` (workstation)\n- `host_vars/constantine.yml` (workstation)\n\n## Tasks\n- Add `nas_mount` to each host's `roles_to_run` list\n- Place after `base` role (base sets up zerotier, nas_mount depends on it)\n- Ensure consistent formatting across all four files\n\n## Quality Gates\n- Run `mise run lint` before commit\n- Run `mise run dry-run-local` to verify role will be applied\n- Verify output shows nas_mount role will run for current host\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If dry-run shows errors, file separate task for role fixes\n- If host_vars file missing, file separate task to create host config\n\n## Acceptance Criteria\n- nas_mount appears in roles_to_run for all 4 hosts\n- Placement is consistent (after base role)\n- `mise run lint` passes\n- `mise run dry-run-local` shows role will be applied\n- Changes committed and pushed","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:22.692446328-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:22:27.168791003-08:00","dependencies":[{"issue_id":"fleet-422.4","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:18:22.6953526-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.4","depends_on_id":"fleet-422.3","type":"blocks","created_at":"2026-02-03T13:18:34.640744985-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.4","depends_on_id":"fleet-422.10","type":"blocks","created_at":"2026-02-03T13:22:18.681411332-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.5","title":"Test NAS auto-mount with network interruption","description":"## Objective\nValidate that the NAS auto-mount handles network interruptions and recoveries gracefully through comprehensive integration testing on both Linux and macOS.\n\n## Test Scenarios\n\n### Common Tests (All Platforms):\n1. **Initial Mount**: Access mount point (`cd /nas/Public`), verify files appear\n2. **Network Down**: Disable ZeroTier, verify graceful degradation (no system hang)\n3. **Network Restore**: Re-enable ZeroTier, verify mount recovers on next access\n4. **Boot Without Network**: Reboot with ZeroTier disabled, verify no boot delays, measure boot time\n5. **Late Network**: Start ZeroTier after boot, verify mount works when accessed\n\n### Linux-Specific Tests:\n- Stop ZeroTier: `sudo systemctl stop zerotier-one`\n- Start ZeroTier: `sudo systemctl start zerotier-one`\n- Check autofs status: `systemctl status autofs`\n- Check mount: `ls /nas/Public`\n\n### macOS-Specific Tests:\n- Stop ZeroTier: `sudo launchctl unload /Library/LaunchDaemons/com.zerotier.one.plist`\n- Start ZeroTier: `sudo launchctl load /Library/LaunchDaemons/com.zerotier.one.plist`\n- Check automount: `automount -vc` (verify reload)\n- Check mount: `ls /nas/Public`\n\n## Test Hosts\n**Linux:**\n- At least one laptop (rincewind or dresden)\n- At least one workstation (jareth or constantine)\n\n**macOS:**\n- Any macOS hosts in fleet (check inventory for Darwin hosts)\n\n## Test Documentation\n- Document test results as comment on this issue\n- Include pass/fail status for each scenario per platform\n- Note any timeouts, delays, or unexpected behavior\n- Record boot time measurements for scenario 4\n- Compare behavior between Linux (autofs) and macOS (automount)\n\n## Quality Gates\n- All 5 scenarios must pass on:\n  - At least 2 Linux hosts (1 laptop + 1 workstation)\n  - At least 1 macOS host (if available)\n- Test results documented before closing\n- Any failures or issues filed as separate tasks\n\n## Error Handling\n- If mount doesn't recover after network restore, file separate task for mount option tuning\n- If boot delays occur, file separate task for systemd/launchd dependency fixes\n- If autofs/automount service fails, file separate task for service configuration review\n- If platform-specific behavior differs significantly, document and file task if problematic\n\n## Acceptance Criteria\n- All 5 test scenarios pass on both Linux and macOS\n- No system hangs or excessive timeouts (\u003e30s)\n- Boot time not impacted by unavailable NAS (verify against baseline)\n- Mount automatically reconnects after network restoration\n- Platform differences documented (if any)\n- Test results documented on this issue\n- Any discovered issues filed as separate tasks\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-422.4: Add nas_mount role to host configurations ● P1\n\nBLOCKS\n  ← ○ fleet-422.6: Document NAS auto-mount in AGENTS.md ● P1","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:26.530429432-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:49:33.863851599-08:00","dependencies":[{"issue_id":"fleet-422.5","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:18:26.533336662-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.5","depends_on_id":"fleet-422.4","type":"blocks","created_at":"2026-02-03T13:18:34.793796149-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.6","title":"Document NAS auto-mount in AGENTS.md","description":"## Objective\nAdd comprehensive documentation for the nas_mount role to AGENTS.md covering both Linux and macOS implementations.\n\n## Documentation Sections to Add\n\n### In \"Project Structure\" → \"roles/\" list:\n- Add `nas_mount`: Auto-mount Synology NAS Public volume via ZeroTier using autofs (Linux) and automount (macOS)\n\n### New Section: \"NAS Auto-Mount Pattern\" (after \"User Configuration (Chezmoi)\"):\n**Platform Overview:**\n- Linux: Uses autofs for on-demand mounting\n- macOS: Uses built-in automount daemon\n- Both: Mount on access, unmount on idle\n- Protocol: Document chosen protocol (likely NFS) and rationale from fleet-422.1\n- ZeroTier Integration: Hostname from /etc/hosts discovery (fleet-6o5)\n\n**Variables:**\n- `nas_hostname`: From ZeroTier discovery (e.g., \"synology.zt\")\n- `nas_share_name`: Share name on NAS (e.g., \"Public\")\n- `nas_nfs_options`: NFS mount options (if NFS chosen)\n- `nas_smb_*`: SMB credentials from 1Password (if SMB chosen)\n\n**Service Dependencies:**\n- Linux: autofs.service depends on zerotier-one.service via systemd drop-in\n- macOS: automount started by launchd, no explicit dependency needed\n\n**Mount Point:**\n- Location: `/nas/Public`\n- Access: `cd /nas/Public` triggers mount automatically\n- Idle timeout: 300 seconds (configurable)\n\n### In \"Common Tasks \u0026 Examples\":\n\n**Accessing NAS Mount:**\n```bash\n# Trigger mount by accessing directory\ncd /nas/Public\nls  # Files appear automatically\n\n# Mount persists while in use, unmounts after idle timeout\n```\n\n**Troubleshooting NAS Mount:**\n\n*Linux:*\n```bash\n# Check autofs status\nsystemctl status autofs\n\n# Check ZeroTier connectivity\nsystemctl status zerotier-one\nzerotier-cli listnetworks\n\n# View autofs logs\njournalctl -u autofs -f\n\n# Force mount check\nls /nas/Public\n\n# Manual mount test\nsudo mount -t nfs synology.zt:/Public /mnt/test\n```\n\n*macOS:*\n```bash\n# Check automount configuration\nautomount -vc\n\n# Check ZeroTier connectivity\nzerotier-cli listnetworks\n\n# View system logs\nlog show --predicate 'processImagePath contains \"automount\"' --last 1h\n\n# Force mount check\nls /nas/Public\n\n# Manual mount test\nsudo mount -t nfs synology.zt:/Public /mnt/test\n```\n\n## Quality Gates\n- Run `mise run lint` before commit (markdownlint)\n- Fix any markdown linting errors\n- Verify no broken internal links\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If markdownlint fails, fix formatting issues before closing\n- If section placement unclear, ask user for guidance\n\n## Acceptance Criteria\n- nas_mount role documented in roles list\n- Auto-mount pattern explained in dedicated section with platform differences\n- Linux and macOS troubleshooting guidance provided separately\n- ZeroTier hostname discovery integration documented\n- 1Password credential management documented (if SMB)\n- `mise run lint` passes (markdownlint clean)\n- Changes committed and pushed\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-422.5: Test NAS auto-mount with network interruption ● P1","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:18:29.240282748-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:49:53.198294969-08:00","dependencies":[{"issue_id":"fleet-422.6","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:18:29.243225687-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.6","depends_on_id":"fleet-422.5","type":"blocks","created_at":"2026-02-03T13:18:34.939337672-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.7","title":"Create nas_mount role directory structure","description":"## Objective\nCreate the basic directory structure and skeleton files for the nas_mount role following existing role patterns.\n\n## Tasks\n- Create role directories: `mkdir -p roles/nas_mount/{tasks,defaults,vars,handlers,templates,tests}`\n- Create `roles/nas_mount/tasks/main.yml` with copyright header\n- Create `roles/nas_mount/defaults/main.yml` with copyright header and default variables\n- Create `roles/nas_mount/handlers/main.yml` with copyright header\n- Create `roles/nas_mount/tests/test.yml` basic test playbook structure\n- Review existing roles (base, user_core) for copyright header and structure patterns\n\n## Default Variables to Add\n- `nas_mount_point`: Default mount point path (e.g., \"/mnt/nas\")\n- `nas_mount_enabled`: Boolean to enable/disable role (default: true)\n\n## Quality Gates\n- Run `mise run lint` to verify file syntax and structure\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If linting fails on new files, file separate task for fixing lint issues\n- If directory creation fails, check filesystem permissions\n\n## Acceptance Criteria\n- All required role directories created\n- Skeleton files have proper copyright headers\n- Files follow existing role patterns (FQCN, named tasks)\n- `mise run lint` passes\n- Changes committed and pushed","status":"closed","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:21:36.591612119-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:29:22.59451377-08:00","closed_at":"2026-02-03T15:29:22.59451377-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-422.7","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:21:36.594570808-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.7","depends_on_id":"fleet-422.1","type":"blocks","created_at":"2026-02-03T13:22:14.400894196-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.7","depends_on_id":"fleet-422.2","type":"blocks","created_at":"2026-02-03T13:22:14.555298245-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.7","depends_on_id":"fleet-422.13","type":"blocks","created_at":"2026-02-03T15:03:23.944730776-08:00","created_by":"T.R. Fullhart"}],"comments":[{"id":4,"issue_id":"fleet-422.7","author":"T.R. Fullhart","text":"## Role Implementation Complete\n\n**Date:** 2026-02-03\n**Host Tested:** rincewind (Debian Unstable, ARM64)\n\n### Implementation Summary\n\nComplete nas_mount role implementation with autofs-based on-demand NFS mounting:\n- Linux (Debian/Arch) and macOS platform support\n- NFSv4.1 protocol over ZeroTier VPN\n- On-demand mounting with 5-minute auto-unmount\n- Network interruption tolerant (hard,intr mount options)\n- No credentials required (NFS UID/GID mapping)\n\n### Files Created\n\n**Role Structure:**\n- `roles/nas_mount/tasks/main.yml` - Main entry point, loads OS variables, includes platform tasks\n- `roles/nas_mount/tasks/linux_autofs.yml` - Linux autofs configuration (apt/pacman package install)\n- `roles/nas_mount/tasks/darwin_autofs.yml` - macOS autofs configuration (built-in NFS)\n- `roles/nas_mount/defaults/main.yml` - Default variables (all with nas_mount_ prefix)\n- `roles/nas_mount/vars/debian.yml` - Debian package list (nfs-common, autofs)\n- `roles/nas_mount/vars/darwin.yml` - macOS variables\n- `roles/nas_mount/templates/synology.autofs.j2` - Autofs master map entry template\n- `roles/nas_mount/templates/auto.synology.j2` - Autofs map file template\n- `roles/nas_mount/handlers/main.yml` - Autofs service restart handlers\n- `roles/nas_mount/tests/test.yml` - Test playbook for role\n- `roles/nas_mount/README.md` - Comprehensive documentation\n\n**Host Configuration Updated:**\n- `host_vars/rincewind.yml` - Added nas_mount to roles_to_run\n- `host_vars/dresden.yml` - Added nas_mount to roles_to_run\n- `host_vars/jareth.yml` - Added nas_mount to roles_to_run\n- `host_vars/constantine.yml` - Added nas_mount to roles_to_run\n\n### Quality Gates\n\n✅ **Linting:** All checks passed\n- ansible-lint: Passed with production profile (0 failures, 0 warnings)\n- markdownlint: All files clean\n- beads lint: No template warnings\n\n✅ **Code Quality:**\n- All variables follow ansible-lint naming convention (nas_mount_ prefix)\n- Markdown documentation properly formatted (blank lines around code/lists)\n- Copyright headers on all files\n- FQCN for all Ansible modules\n\n### Testing Results\n\n**Check Mode:** ✅ PASSED\n- Template rendering correct\n- Variables properly substituted\n- Dependencies resolved correctly\n- Configuration files would be created correctly\n\n**Application:** ✅ SUCCESS\n- Packages installed: autofs, libnsl2 (new dependencies)\n- Mount point created: /media/synology/public (owner: kayos, mode: 0755)\n- Autofs master map: /etc/auto.master.d/synology.autofs\n- Autofs map file: /etc/auto.synology\n- Autofs service enabled and restarted\n\n**Auto-Mount:** ✅ WORKING\n- Trigger: `ls /media/synology/public` successfully triggered mount\n- Contents visible: 20+ directories/files from Synology Public share\n- Read access: Successful (can read existing files)\n- UID/GID mapping: Correct (files show as UID 1026, preserving NAS ownership)\n\n**Mount Configuration Verified:**\n- Mount point: /media/synology/public\n- NAS: nas-server.example_network.zt:/volume1/Public\n- Protocol: NFSv4.1 (automatically selected)\n- Options: rw,hard,intr,nosuid,timeo=600,retrans=2,_netdev,nfsvers=4.1\n\n**Permissions Behavior (As Expected):**\n- Read access: ✅ Working for all users\n- Write access: Controlled by NFS UID/GID mapping (directory owned by UID 1026)\n- This is correct NFS behavior - permissions preserved from NAS\n\n### Configuration Applied\n\n**Mount Point:** `/media/synology/public`\n**NAS Share:** `nas-server.example_network.zt:/volume1/Public`\n**Protocol:** NFSv4.1\n**Mount Type:** On-demand (autofs)\n**Auto-Unmount Timeout:** 300 seconds (5 minutes idle)\n\n**Mount Options:**\n```\nrw,hard,intr,nosuid,timeo=600,retrans=2,_netdev,nfsvers=4.1\n```\n\n**Option Details:**\n- `rw`: Read-write access\n- `hard`: Retry indefinitely for data integrity\n- `intr`: Allow Ctrl+C to interrupt hung operations\n- `nosuid`: Security - ignore setuid/setgid bits\n- `timeo=600`: 60 second timeout before retry\n- `retrans=2`: 2 retransmissions before error\n- `_netdev`: Wait for network before mounting\n- `nfsvers=4.1`: Use NFSv4.1 protocol\n\n### Target Hosts\n\n**Applied:**\n- ✅ rincewind (tested, working)\n\n**Pending Application:**\n- ⏳ dresden (macOS laptop)\n- ⏳ jareth (Linux workstation)\n- ⏳ constantine (Linux workstation)\n\n### Dependencies\n\n**Resolved:**\n- ✅ fleet-6o5: ZeroTier peer discovery (provides nas-server.example_network.zt hostname)\n- ✅ fleet-422.13: Synology NFS export permissions (198.51.100.0/24 allowed)\n\n**Future Work:**\n- Document NAS mount section in AGENTS.md\n- Test on macOS (dresden)\n- Test on other workstations (jareth, constantine)\n- Verify auto-unmount timeout behavior (requires 5+ minute idle test)\n- Test network interruption recovery (ZeroTier disconnect/reconnect)\n\n### Architecture Notes\n\n**Why NFS over SMB:**\n- No credentials required (vs SMB username/password)\n- UID/GID mapping for permissions\n- Better Linux integration\n- Proven working pattern (minecraft server)\n- Lower protocol overhead\n\n**Why Autofs over fstab:**\n- On-demand mounting (only when accessed)\n- No boot delays if NAS/ZeroTier unavailable\n- Auto-unmount after idle timeout (resource efficiency)\n- Graceful degradation on network issues\n\n**Mount Option Rationale:**\n- Hard mounts: Data integrity priority (retries indefinitely)\n- Interrupt flag: User can Ctrl+C to escape hung operations\n- Network device flag: Ensures ZeroTier up before mounting","created_at":"2026-02-03T23:29:10Z"}]}
{"id":"fleet-422.8","title":"Implement autofs package installation tasks","description":"## Objective\nCreate platform-specific tasks to install autofs (Linux) and configure automount (macOS) packages.\n\n## Context\n- macOS has built-in automount daemon (autofs equivalent)\n- Linux requires autofs package installation\n- Both platforms supported per user requirement\n\n## Files to Create\n- `roles/nas_mount/tasks/linux_install_autofs.yml` - Install autofs on Linux\n- `roles/nas_mount/tasks/darwin_install_autofs.yml` - Configure macOS automount (no package install needed)\n\n## Linux Implementation\n**Debian/Ubuntu:**\n```yaml\n- name: \"NAS Mount | Install autofs package\"\n  ansible.builtin.apt:\n    name: autofs\n    state: present\n  become: true\n```\n\n**Arch Linux:**\n```yaml\n- name: \"NAS Mount | Install autofs package\"\n  community.general.pacman:\n    name: autofs\n    state: present\n  become: true\n```\n\n## macOS Implementation\nmacOS uses built-in `automount` daemon (`autofs` equivalent):\n- No package installation needed\n- Configuration via `/etc/auto_master` (different format than Linux)\n- Daemon: `automountd` (started by `launchd`)\n- Note: macOS uses `automount -vc` to reload config (not `systemctl restart`)\n\n**darwin_install_autofs.yml:**\n```yaml\n- name: \"NAS Mount | Verify automount daemon available\"\n  ansible.builtin.command: which automount\n  register: automount_check\n  changed_when: false\n\n- name: \"NAS Mount | Ensure automount daemon will start\"\n  ansible.builtin.debug:\n    msg: \"macOS automount is built-in, will be configured in later tasks\"\n```\n\n## Main.yml Integration\n```yaml\n- name: \"NAS Mount | Install autofs/automount\"\n  ansible.builtin.include_tasks: \"{{ ansible_facts.system | lower }}_install_autofs.yml\"\n```\n\n## Quality Gates\n- Run `mise run lint` before commit\n- Run `mise run test` to verify syntax\n- Test on both Linux and macOS if possible\n- Commit with descriptive message\n- Push to remote\n\n## Error Handling\n- If package installation fails, file separate task for troubleshooting\n- If test fails, file separate task for test infrastructure fixes\n\n## Acceptance Criteria\n- Linux installation tasks implemented for apt and pacman\n- Darwin task verifies automount availability\n- Tasks included from main.yml using platform detection\n- All tasks use FQCN and proper naming\n- Copyright header present\n- `mise run lint` passes\n- `mise run test` passes\n- Changes committed and pushed\n\nPARENT\n  ↑ ○ fleet-422: (EPIC) Auto-mount Synology NAS Public volume via ZeroTier ● P1\n\nDEPENDS ON\n  → ○ fleet-422.7: Create nas_mount role directory structure ● P1\n\nBLOCKS\n  ← ○ fleet-422.11: Create autofs map Jinja2 template ● P1\n  ← ○ fleet-422.9: (EPIC) Create autofs configuration template and tasks ● P1","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:21:44.859089742-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:47:24.65556115-08:00","dependencies":[{"issue_id":"fleet-422.8","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:21:44.862128932-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.8","depends_on_id":"fleet-422.7","type":"blocks","created_at":"2026-02-03T13:22:14.712389482-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-422.9","title":"Create autofs configuration template and tasks","description":"## Objective\nCreate complete autofs configuration through template and deployment tasks.\n\n## Overview\nThis epic coordinates autofs configuration creation through two subtasks:\n1. Template creation (fleet-422.11)\n2. Deployment tasks (fleet-422.12)\n\n## Files Created (Final)\n- roles/nas_mount/templates/auto.nas.j2\n- roles/nas_mount/tasks/linux_configure_autofs.yml\n\n## Success Criteria\n- Both subtasks completed\n- Template and deployment tasks work together\n- Configuration files deployed to correct locations\n- All changes committed and pushed","status":"open","priority":1,"issue_type":"epic","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:21:54.749708126-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T13:26:58.534233584-08:00","dependencies":[{"issue_id":"fleet-422.9","depends_on_id":"fleet-422","type":"parent-child","created_at":"2026-02-03T13:21:54.753167902-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-422.9","depends_on_id":"fleet-422.8","type":"blocks","created_at":"2026-02-03T13:22:14.867364869-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-4g6","title":"Create syncthing role for file synchronization","description":"Create a new Ansible role to install and configure Syncthing and Syncthing-GTK/Syncthingtray on laptops and workstations. Syncthing provides continuous file synchronization across devices.\n\n**Scope:**\n- Install syncthing daemon and syncthingtray GUI on Linux systems\n- Support both apt-based (Debian/Ubuntu) and homebrew-based (Darwin) installations\n- Enable and start syncthing service for the user\n- Add role to laptop and workstation groups\n\n**Out of Scope:**\n- Syncthing folder configuration (handled by user via GUI)\n- Device pairing (handled by user)\n- Firewall rules (syncthing uses dynamic ports via UPnP)\n\n## Success Criteria\n\n- [ ] Role directory structure created following project conventions\n- [ ] Platform-specific package installation implemented (Linux, Darwin)\n- [ ] Syncthing service enabled and started for user\n- [ ] Role added to all laptop and workstation hosts\n- [ ] Test playbook passes in check mode\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes\n- [ ] README.md documents role purpose and usage","acceptance_criteria":"- [ ] Role directory structure created following project conventions\n- [ ] Platform-specific package installation implemented (Linux, Darwin)\n- [ ] Syncthing service enabled and started for user\n- [ ] Role added to all laptop and workstation hosts\n- [ ] Test playbook passes in check mode\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes\n- [ ] README.md documents role purpose and usage","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-27T13:56:24.432557047-08:00","updated_at":"2026-01-27T13:58:27.422610415-08:00"}
{"id":"fleet-4g6.1","title":"Fix syncthing systemd user service check mode compatibility","description":"## Problem\n\nThe syncthing role's systemd user service task fails in check mode (dry-run) when running as root with local connection:\n\n```\nfatal: [rincewind]: FAILED! =\u003e {\"changed\": false, \"cmd\": \"/usr/bin/systemctl --user\", \"msg\": \"Failed to connect to user scope bus via local transport: No such file or directory\"}\n```\n\nThis occurs in:\n- `mise run dry-run-local` \n- `roles/syncthing/tests/test.yml` execution\n- Any check mode run without user session environment (XDG_RUNTIME_DIR)\n\n## Root Cause\n\nSystemd user services require user session bus which isn't available when running as root. This is an environment limitation, not a code defect.\n\n## Proposed Solution\n\nAdd `ignore_errors: true` or `failed_when: false` to the systemd user service task in check mode, similar to patterns used in other roles.\n\nReference: roles/syncthing/tasks/linux_enable_service.yml:5\n\n## Acceptance Criteria\n\n- [ ] `mise run dry-run-local` completes without fatal errors on syncthing service task\n- [ ] `mise run test` completes without fatal errors  \n- [ ] Task still reports changes/status appropriately in check mode\n- [ ] Real execution (non-check mode) remains unchanged\n- [ ] `mise run lint` passes (0 failures, 0 warnings)\n- [ ] Solution follows patterns from other roles (base, user_core, etc.)","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T21:44:28.755439729-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T21:55:08.020064652-08:00","closed_at":"2026-01-27T21:55:08.020064652-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-4g6.1","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T21:44:28.758386755-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-4j8","title":"Implement Linux package installation for syncthing","description":"Create Linux-specific package installation task file for Syncthing. Use apt module with proper privilege escalation and FQCN conventions.\n\nFollow pattern from roles/base/tasks/linux_install_packages.yml\n\n## Acceptance Criteria\n\n- [ ] roles/syncthing/tasks/linux_install_packages.yml created\n- [ ] Uses ansible.builtin.apt with FQCN\n- [ ] Installs packages from syncthing_package_names variable\n- [ ] Includes proper task naming and copyright header\n- [ ] Handles package cache update if needed\n- [ ] Uses become: true for privilege escalation","acceptance_criteria":"- [ ] roles/syncthing/tasks/linux_install_packages.yml created\n- [ ] Uses ansible.builtin.apt with FQCN\n- [ ] Installs packages from syncthing_package_names variable\n- [ ] Includes proper task naming and copyright header\n- [ ] Handles package cache update if needed\n- [ ] Uses become: true for privilege escalation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:56:42.660466732-08:00","updated_at":"2026-01-27T20:48:16.640108863-08:00","closed_at":"2026-01-27T20:48:16.640108863-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-4j8","depends_on_id":"fleet-l98","type":"blocks","created_at":"2026-01-27T13:57:40.629482553-08:00","created_by":"daemon"},{"issue_id":"fleet-4j8","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:45.807057364-08:00","created_by":"daemon"}]}
{"id":"fleet-4up","title":"Create Linux firewall integration test","description":"## Context\nThis subtask is part of fleet-11m (Create integration test for Syncthing firewall configuration). It focuses on testing Linux/ufw-specific firewall functionality.\n\n## Objective\nCreate an Ansible test playbook that verifies ufw rules are properly configured and Syncthing ports are accessible on Linux systems.\n\n## Test Coverage\n1. **Rule Verification**: Check ufw rules exist for ports 22000 (TCP/UDP) and 21027 (UDP)\n2. **Port Listening**: Verify Syncthing is listening on required ports\n3. **API Access**: Test REST API connectivity (localhost)\n4. **External Access**: Test port accessibility from another host (if possible)\n\n## Implementation Location\n`roles/syncthing/tests/test_linux_firewall.yml`\n\n## Acceptance Criteria\n1. Test playbook created at specified location\n2. Uses `ansible.builtin.command` to run `ufw status` and verify rules\n3. Uses `ansible.builtin.wait_for` to check port 22000 TCP listening\n4. Uses `ansible.builtin.wait_for` to check port 21027 UDP listening  \n5. Tests API connectivity via /rest/system/ping\n6. Includes check mode compatibility (--check)\n7. Uses `ansible.builtin.assert` for all validations\n8. Provides clear failure messages\n9. Follows FQCN convention\n10. Includes copyright header\n11. Passes ansible-lint validation\n12. Can be run standalone: `ansible-playbook roles/syncthing/tests/test_linux_firewall.yml`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:17:07.594527589-08:00","updated_at":"2026-01-27T15:39:17.110150481-08:00","closed_at":"2026-01-27T15:39:17.110150481-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["firewall","linux","syncthing","testing"]}
{"id":"fleet-5y5","title":"Document firewall setup and port configuration","description":"## Context\nThis subtask is part of fleet-y3k (Document firewall configuration in Syncthing role README). It focuses on explaining firewall basics, required ports, and platform-specific setup.\n\n## Objective\nAdd comprehensive documentation section to Syncthing role README explaining firewall configuration requirements and setup procedures.\n\n## Content Sections\n1. **Firewall Overview**: Explain why firewall rules are needed for peer-to-peer Syncthing\n2. **Required Ports**: Document TCP 22000 (sync), UDP 22000 (QUIC), UDP 21027 (discovery)\n3. **Linux Setup**: Document ufw rules and verification commands\n4. **Darwin Setup**: Document application firewall rules\n5. **Verification**: How to check if ports are properly opened\n\n## Acceptance Criteria\n1. New \"## Firewall Configuration\" section added to `roles/syncthing/README.md`\n2. Explains purpose of firewall rules (direct connections vs relay)\n3. Documents all three required ports with protocols\n4. Includes Linux/ufw configuration examples with commands\n5. Includes Darwin/pf configuration examples\n6. Shows verification commands (nc, lsof, netstat)\n7. Links to connection type verification task\n8. Uses proper markdown formatting\n9. Passes markdownlint validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:16:58.146334703-08:00","updated_at":"2026-01-27T15:39:16.794191276-08:00","closed_at":"2026-01-27T15:39:16.794191276-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["documentation","firewall","syncthing"]}
{"id":"fleet-60e","title":"Fix beads git hooks to work with mise","description":"The git hooks installed by bd fail because 'bd' is not in the PATH when invoked by git. Need to configure them to load mise or use absolute paths.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:26:09.47632272-08:00","created_by":"kayos","updated_at":"2026-01-06T15:29:57.503105623-08:00","closed_at":"2026-01-06T15:29:57.503105623-08:00","close_reason":"Closed"}
{"id":"fleet-67f","title":"Add peer connectivity testing task","description":"## Objective\nCreate an Ansible task that tests whether Syncthing peers are successfully connected, validating that firewall rules allow peer-to-peer communication.\n\n## Acceptance Criteria\n- [ ] Task created to test peer connectivity\n- [ ] Task queries Syncthing REST API /rest/system/connections\n- [ ] Task validates at least one peer is connected\n- [ ] Task checks each peer \"connected\" status is true\n- [ ] Task validates \"paused\" status is false for active peers\n- [ ] Task fails clearly if no peers are connected\n- [ ] Task handles case where Syncthing service is not running\n- [ ] Task uses ansible.builtin.uri with proper error handling\n- [ ] Task documented with comments explaining connectivity checks\n- [ ] Task integrated into test playbook (fleet-11m)\n- [ ] Task passes when Syncthing has at least one active peer","acceptance_criteria":"- [ ] Task created to test peer connectivity\n- [ ] Task queries Syncthing REST API /rest/system/connections\n- [ ] Task validates at least one peer is connected\n- [ ] Task checks each peer \"connected\" status is true\n- [ ] Task validates \"paused\" status is false for active peers\n- [ ] Task fails clearly if no peers are connected\n- [ ] Task handles case where Syncthing service is not running\n- [ ] Task uses ansible.builtin.uri with proper error handling\n- [ ] Task documented with comments explaining connectivity checks\n- [ ] Task integrated into test playbook (fleet-11m)\n- [ ] Task passes when Syncthing has at least one active peer\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:46:30.10233111-08:00","updated_at":"2026-01-27T20:56:05.02927725-08:00","labels":["connectivity","networking","syncthing","testing"],"dependencies":[{"issue_id":"fleet-67f","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:46:30.108122782-08:00","created_by":"daemon"},{"issue_id":"fleet-67f","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:02.984299051-08:00","created_by":"daemon"}]}
{"id":"fleet-69s","title":"Create 1Password vault item for Syncthing device IDs","description":"Create 1Password vault item to store Syncthing device IDs with structured fields for each host.\n\n## Implementation\n\n1. **Create vault item using op CLI**:\n   ```bash\n   op item create \\\n     --category \"Secure Note\" \\\n     --title \"Syncthing Fleet Device IDs\" \\\n     --vault \"ServiceAccountAccess\"\n   ```\n\n2. **Add device ID fields**:\n   ```bash\n   op item edit \"Syncthing Fleet Device IDs\" \\\n     rincewind[text]=\"DEVICE-ID-PLACEHOLDER\" \\\n     dresden[text]=\"DEVICE-ID-PLACEHOLDER\" \\\n     caliban[text]=\"DEVICE-ID-PLACEHOLDER\" \\\n     jareth[text]=\"DEVICE-ID-PLACEHOLDER\" \\\n     constantine[text]=\"DEVICE-ID-PLACEHOLDER\"\n   ```\n\n3. **Document access pattern** in role README:\n   ```bash\n   # Read single device ID\n   op read \"op://ServiceAccountAccess/Syncthing Fleet Device IDs/rincewind\"\n   \n   # Read all device IDs (JSON)\n   op item get \"Syncthing Fleet Device IDs\" --format json | jq -r '.fields[] | select(.label != \"notesPlain\") | \"\\\\(.label)=\\\\(.value)\"'\n   ```\n\n## Acceptance Criteria\n\n- 1Password item created in ServiceAccountAccess vault\n- Fields created for all 5 hosts (rincewind, dresden, caliban, jareth, constantine)\n- Access pattern documented in roles/syncthing/README.md\n- Verified: `op item get \"Syncthing Fleet Device IDs\"` returns item\n- Item structure allows easy Ansible integration via lookup plugin","acceptance_criteria":"- [ ] 1Password vault item created: `op://ServiceAccountAccess/Syncthing Fleet Device IDs`\n- [ ] Item type: `password` (supports multiple fields)\n- [ ] Fields planned for 5 hosts: rincewind, dresden, caliban, jareth, constantine\n- [ ] `op read \"op://ServiceAccountAccess/Syncthing Fleet Device IDs/rincewind\"` command structure verified\n- [ ] Item created via `op item create` or web UI\n- [ ] Access verified: can read and write to item using fleet service account\n- [ ] Item documented in project secrets documentation or AGENTS.md","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:04.865691163-08:00","updated_at":"2026-01-27T14:56:44.287198239-08:00","labels":["1password","secrets-management","syncthing"],"dependencies":[{"issue_id":"fleet-69s","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:04.882143056-08:00","created_by":"daemon"},{"issue_id":"fleet-69s","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:31.182681199-08:00","created_by":"daemon"}]}
{"id":"fleet-6o5","title":"Add ZeroTier network member discovery and /etc/hosts management","description":"## Objective\nQuery ZeroTier Central API to discover network members and automatically populate /etc/hosts with peer names and IPs. This eliminates hardcoded IPs and enables hostname-based connections.\n\n## Benefits\n- No hardcoded IPs in vault or variables\n- Automatic discovery of NAS and other ZeroTier peers\n- Can reference NAS by hostname (e.g., `synology.zt`) instead of IP\n- Hosts file stays current with ZeroTier network membership\n\n## Technical Approach\n1. Store ZeroTier API token in **1Password** (NOT Ansible Vault)\n2. Use `op` CLI to retrieve token (consistent with .get_vault_password.sh pattern)\n3. Query ZeroTier Central API: `GET /api/v1/network/{networkID}/member`\n4. Parse member list to extract names and assigned IPs\n5. Generate /etc/hosts entries (or use dnsmasq/systemd-resolved)\n6. Add to base role or new zerotier_hosts role\n\n## 1Password Integration\n**Token Path:** `op://ServiceAccountAccess/ZeroTier Central API/credential` (or similar)\n**Retrieval in Ansible:** Use `ansible.builtin.command` or `lookup('pipe')` with `op read`\n**Pattern:** Follow existing .get_vault_password.sh and .get_become_password.sh implementations\n\n## API Details\n**Endpoint:** `https://api.zerotier.com/api/v1/network/{networkID}/member`\n**Auth:** Bearer token header\n**Returns:** Member list with `name`, `description`, and `ipAssignments`\n\n## Implementation Options\n1. **Static /etc/hosts:** Update via Ansible template (recommended for consistency)\n2. **Dynamic /etc/hosts:** Systemd service that queries API periodically\n3. **DNS Integration:** Use dnsmasq or systemd-resolved for ZeroTier domain\n\n## Variables Needed\n- `zerotier_api_token`: Retrieved from 1Password via `op read`\n- `zerotier_network_id`: Already exists in current config\n- `zerotier_domain_suffix`: Optional (e.g., \".zt\" for synology.zt)\n\n## Impacts Other Work\n- **fleet-422.1:** Still needs research task, but can use hostname instead of IP\n- **fleet-422.2:** Credentials task simplified - no hardcoded NAS IP needed\n- **nas_mount role:** Can use `nas_hostname` variable (e.g., \"synology.zt\")\n\n## Acceptance Criteria\n- ZeroTier API token retrieved from 1Password using `op` CLI\n- ZeroTier API successfully queried for network members\n- /etc/hosts populated with peer hostnames and ZeroTier IPs\n- Can ping peers by hostname (e.g., `ping synology.zt`)\n- Follows existing 1Password integration patterns\n- mise run lint passes\n- mise run test passes\n- Changes committed and pushed to git\n- Documentation in AGENTS.md\n\n## Priority\nThis should be done **before** fleet-422.2 (credentials) to avoid hardcoding IPs.","status":"closed","priority":1,"issue_type":"feature","owner":"kayos@genetikayos.com","created_at":"2026-02-03T13:32:54.010052565-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T14:15:06.433146879-08:00","closed_at":"2026-02-03T14:15:06.433146879-08:00","close_reason":"Closed"}
{"id":"fleet-720","title":"Add syncthing role to laptop and workstation host configs","description":"Add the syncthing role to the roles_to_run list for laptop and workstation hosts. This enables automatic deployment of Syncthing to these machine categories.\n\n**Hosts to update:**\n- Laptops: rincewind, dresden, caliban\n- Workstations: constantine, jareth\n\n**Note**: rincewind and constantine already have host_vars files. Dresden, caliban, and jareth will need host_vars files created with roles_to_run list including syncthing.\n\nDo NOT add to servers (minecraft).\n\n## Acceptance Criteria\n\n- [ ] syncthing role added to `host_vars/rincewind.yml` roles_to_run list (laptop - existing file)\n- [ ] syncthing role added to `host_vars/constantine.yml` roles_to_run list (workstation - existing file)\n- [ ] `host_vars/dresden.yml` created with roles_to_run list including syncthing (laptop - new file)\n- [ ] `host_vars/caliban.yml` created with roles_to_run list including syncthing (laptop - new file)\n- [ ] `host_vars/jareth.yml` created with roles_to_run list including syncthing (workstation - new file)\n- [ ] Changes follow existing YAML formatting and conventions\n- [ ] Verified syncthing role NOT added to server hosts","acceptance_criteria":"- [ ] syncthing role added to `host_vars/rincewind.yml` roles_to_run list (laptop - existing file)\n- [ ] syncthing role added to `host_vars/constantine.yml` roles_to_run list (workstation - existing file)\n- [ ] `host_vars/dresden.yml` created with roles_to_run list including syncthing (laptop - new file)\n- [ ] `host_vars/caliban.yml` created with roles_to_run list including syncthing (laptop - new file)\n- [ ] `host_vars/jareth.yml` created with roles_to_run list including syncthing (workstation - new file)\n- [ ] All files follow existing YAML formatting conventions\n- [ ] Verified syncthing role NOT added to server hosts (minecraft should not have syncthing)\n- [ ] Files use consistent structure matching existing host_vars files\n- [ ] `mise run dry-run-local` shows syncthing role would be applied","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:57:20.822198476-08:00","updated_at":"2026-01-27T21:41:21.89121048-08:00","closed_at":"2026-01-27T21:41:21.89121048-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-720","depends_on_id":"fleet-hef","type":"blocks","created_at":"2026-01-27T13:57:40.890841574-08:00","created_by":"daemon"},{"issue_id":"fleet-720","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:49.276513398-08:00","created_by":"daemon"}]}
{"id":"fleet-75d","title":"Create config.xml template with device list and folders","description":"Create Jinja2 template for Syncthing config.xml that includes all fleet devices and shared folder definitions.\n\n## Implementation\n\nCreate `roles/syncthing/templates/config.xml.j2`:\n\n```xml\n\u003cconfiguration version=\"37\"\u003e\n    \u003cfolder id=\"documents\" label=\"Documents\" path=\"{{ ansible_env.HOME }}/Sync/Documents\" type=\"sendreceive\" rescanIntervalS=\"3600\" fsWatcherEnabled=\"true\" fsWatcherDelayS=\"10\"\u003e\n{% for host in groups['laptop'] + groups['workstation'] %}\n        \u003cdevice id=\"{{ hostvars[host].syncthing_device_id }}\" introducedBy=\"\"\u003e\u003c/device\u003e\n{% endfor %}\n    \u003c/folder\u003e\n    \n{% for host in groups['laptop'] + groups['workstation'] %}\n    \u003cdevice id=\"{{ hostvars[host].syncthing_device_id }}\" name=\"{{ host }}\" compression=\"metadata\" introducer=\"false\" skipIntroductionRemovals=\"false\" introducedBy=\"\"\u003e\n        \u003caddress\u003edynamic\u003c/address\u003e\n        \u003cautoAcceptFolders\u003efalse\u003c/autoAcceptFolders\u003e\n    \u003c/device\u003e\n{% endfor %}\n    \n    \u003cgui enabled=\"true\" tls=\"false\" debugging=\"false\"\u003e\n        \u003caddress\u003e127.0.0.1:8384\u003c/address\u003e\n        \u003capikey\u003e{{ syncthing_api_key | default(lookup('password', '/dev/null chars=ascii_letters,digits length=32')) }}\u003c/apikey\u003e\n        \u003ctheme\u003edefault\u003c/theme\u003e\n    \u003c/gui\u003e\n    \n    \u003coptions\u003e\n        \u003clistenAddress\u003edefault\u003c/listenAddress\u003e\n        \u003cglobalAnnounceEnabled\u003etrue\u003c/globalAnnounceEnabled\u003e\n        \u003clocalAnnounceEnabled\u003etrue\u003c/localAnnounceEnabled\u003e\n        \u003crelaysEnabled\u003etrue\u003c/relaysEnabled\u003e\n        \u003cnatEnabled\u003etrue\u003c/natEnabled\u003e\n        \u003curAccepted\u003e-1\u003c/urAccepted\u003e\n    \u003c/options\u003e\n\u003c/configuration\u003e\n```\n\nCreate `roles/syncthing/defaults/main.yml` additions:\n```yaml\nsyncthing_shared_folders:\n  - id: documents\n    label: Documents\n    path: \"{{ ansible_env.HOME }}/Sync/Documents\"\n    type: sendreceive\n```\n\n## Acceptance Criteria\n\n- Template file created in roles/syncthing/templates/\n- Template loops over all laptop and workstation hosts\n- Device IDs populated from hostvars (requires prior device ID collection)\n- Shared folders configurable via syncthing_shared_folders variable\n- API key generated or sourced from defaults\n- Template follows Syncthing XML schema version 37\n- autoAcceptFolders set to false (security best practice)\n- Template validated against working Syncthing config.xml","acceptance_criteria":"- [ ] config.xml.j2 template created in roles/syncthing/templates/\n- [ ] Template includes device loop using syncthing_fleet_devices variable\n- [ ] Template includes folder configuration using syncthing_shared_folders variable\n- [ ] Jinja2 syntax validated with ansible-playbook --syntax-check\n- [ ] defaults/main.yml updated with syncthing_shared_folders variable structure\n- [ ] defaults/main.yml includes inline documentation for variable usage\n- [ ] Template generates valid XML: xmllint --noout passes on rendered output\n- [ ] Template tested with sample data produces expected config structure\n- [ ] Copyright header present in template file","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:18.319055548-08:00","updated_at":"2026-01-27T15:05:24.895705322-08:00","labels":["configuration","syncthing","templating"],"dependencies":[{"issue_id":"fleet-75d","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:18.324243176-08:00","created_by":"daemon"},{"issue_id":"fleet-75d","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:32.296177874-08:00","created_by":"daemon"}]}
{"id":"fleet-7bj","title":"setup Crush with integration with Todoist","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:18:51.270722573-08:00","created_by":"kayos","updated_at":"2026-01-06T17:29:48.845067834-08:00","closed_at":"2026-01-06T17:29:48.845067834-08:00","close_reason":"Closed"}
{"id":"fleet-7bj.1","title":"install todoist MCP","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:20:49.016059692-08:00","created_by":"kayos","updated_at":"2026-01-06T17:29:31.062729608-08:00","closed_at":"2026-01-06T17:29:31.062729608-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-7bj.1","depends_on_id":"fleet-7bj","type":"parent-child","created_at":"2026-01-06T16:20:49.019017215-08:00","created_by":"kayos"}]}
{"id":"fleet-7bj.2","title":"configure Crush to use the todoist MCP","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:21:03.492018615-08:00","created_by":"kayos","updated_at":"2026-01-06T17:29:31.050994894-08:00","closed_at":"2026-01-06T17:29:31.050994894-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-7bj.2","depends_on_id":"fleet-7bj","type":"parent-child","created_at":"2026-01-06T16:21:03.494815886-08:00","created_by":"kayos"}]}
{"id":"fleet-7d6","title":"Add Syncthing port listening validation task","description":"## Objective\nCreate an Ansible task that validates Syncthing is listening on the required network ports after firewall configuration is applied.\n\n## Acceptance Criteria\n- [ ] Task created to validate Syncthing ports are listening\n- [ ] Task checks TCP port 22000 is in LISTEN state\n- [ ] Task checks UDP port 22000 is bound\n- [ ] Task checks UDP port 21027 is bound\n- [ ] Task uses platform-appropriate command (ss on Linux, lsof on Darwin)\n- [ ] Task validates Syncthing process owns the listening ports\n- [ ] Task fails clearly if any required port is not listening\n- [ ] Task handles case where Syncthing service is not running\n- [ ] Task documented with comments explaining port validation\n- [ ] Task integrated into test playbook (fleet-11m)\n- [ ] Task uses ansible.builtin.command with proper changed_when: false\n- [ ] Task passes when all three ports are listening","acceptance_criteria":"- [ ] Task created to validate Syncthing ports are listening\n- [ ] Task checks TCP port 22000 is in LISTEN state\n- [ ] Task checks UDP port 22000 is bound\n- [ ] Task checks UDP port 21027 is bound\n- [ ] Task uses platform-appropriate command (ss on Linux, lsof on Darwin)\n- [ ] Task validates Syncthing process owns the listening ports\n- [ ] Task fails clearly if any required port is not listening\n- [ ] Task handles case where Syncthing service is not running\n- [ ] Task documented with comments explaining port validation\n- [ ] Task integrated into test playbook (fleet-11m)\n- [ ] Task uses ansible.builtin.command with proper changed_when: false\n- [ ] Task passes when all three ports are listening","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:46:20.748947208-08:00","updated_at":"2026-01-27T19:44:56.187566299-08:00","labels":["syncthing","testing","validation"],"dependencies":[{"issue_id":"fleet-7d6","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:46:20.754030999-08:00","created_by":"daemon"},{"issue_id":"fleet-7d6","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:02.434438743-08:00","created_by":"daemon"}]}
{"id":"fleet-9ia","title":"Create Syncthing API client helper task","description":"Create reusable Ansible task to authenticate with Syncthing REST API and prepare for API calls.\n\n## Context\nThis is part of connection type verification (parent: fleet-0mw). The API client will be used by verification logic to check connection types.\n\n## Implementation\n\nCreate `roles/syncthing/tasks/api_client_setup.yml`:\n\n- Read API key from config.xml using ansible.builtin.slurp or ansible.builtin.xml\n- Register API key as fact: syncthing_api_key\n- Construct API base URL: http://127.0.0.1:8384/rest\n- Test API connectivity with /rest/system/status endpoint\n- Fail gracefully if Syncthing not running\n\n## Acceptance Criteria\n\n- [ ] api_client_setup.yml created in roles/syncthing/tasks/\n- [ ] Task reads API key from syncthing_config_dir/config.xml\n- [ ] API key registered to fact: syncthing_api_key\n- [ ] API base URL constructed and registered to fact: syncthing_api_base_url\n- [ ] Connectivity test performs GET request to /rest/system/status\n- [ ] Task fails with clear message if Syncthing not running\n- [ ] Task fails with clear message if API key not found\n- [ ] Copyright header present\n- [ ] ansible-lint passes","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:20.658554197-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:22.191891923-08:00","closed_at":"2026-01-27T15:39:22.191891923-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["api","firewall","syncthing"],"dependencies":[{"issue_id":"fleet-9ia","depends_on_id":"fleet-err","type":"blocks","created_at":"2026-01-27T15:13:54.028852745-08:00","created_by":"daemon"}]}
{"id":"fleet-9xb","title":"Configure constantine host to use printing_3d role","description":"Create `host_vars/constantine.yml` and add `printing_3d` to the `roles_to_run` list.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T16:34:58.111218781-08:00","created_by":"kayos","updated_at":"2026-01-07T17:02:53.099129963-08:00","closed_at":"2026-01-07T17:02:53.099129963-08:00","close_reason":"Verified roles_to_run configuration is correct in host_vars/constantine.yml. Completed missing role dependencies (blender) in separate task."}
{"id":"fleet-ahg","title":"Configure Crush to use Ansible LSP","description":"Apply the LSP configuration for @ansible/ansible-language-server to Crush.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:01:25.770820306-08:00","created_by":"kayos","updated_at":"2026-01-06T16:01:57.53656302-08:00","closed_at":"2026-01-06T16:01:57.536574395-08:00"}
{"id":"fleet-ake","title":"Deploy auto-pairing to full fleet and validate","description":"Roll out auto-pairing configuration to all remaining hosts and validate fleet-wide connectivity.\n\n## Rollout Plan\n\n1. **Full Fleet Collection**:\n   ```bash\n   mise run syncthing:autopair --tags collect,store\n   ```\n\n2. **Full Fleet Configuration**:\n   ```bash\n   mise run syncthing:autopair --tags configure\n   ```\n\n3. **Validation Matrix** (verify all connections):\n   - rincewind ↔ dresden, caliban, jareth, constantine\n   - dresden ↔ rincewind, caliban, jareth, constantine\n   - caliban ↔ rincewind, dresden, jareth, constantine\n   - jareth ↔ rincewind, dresden, caliban, constantine\n   - constantine ↔ rincewind, dresden, caliban, jareth\n\n4. **Connection Health Check**:\n   ```bash\n   # On each host, verify all 4 other devices connected\n   curl -s -H \"X-API-Key: $(grep apikey ~/.config/syncthing/config.xml | sed 's/.*\u003capikey\u003e\\\\(.*\\\\)\u003c\\\\/apikey\u003e.*/\\\\1/')\" \\\n     http://localhost:8384/rest/system/connections | jq -r '.connections | keys[]'\n   ```\n\n## Acceptance Criteria\n\n- All 5 hosts have device IDs in 1Password vault\n- All 5 hosts have templated config.xml applied\n- Each host shows 4 connected remote devices in web GUI\n- Connection health check returns 4 device IDs per host\n- No connection errors in Syncthing logs\n- Playbook execution time reasonable (\u003c 5 minutes for full fleet)\n- All hosts pass final validation\n- Documentation updated with any lessons learned during rollout","acceptance_criteria":"- [ ] Full fleet deployment completed: all 5 hosts (rincewind, dresden, caliban, jareth, constantine)\n- [ ] `mise run syncthing:autopair` executed successfully on all hosts\n- [ ] All Syncthing services running and active\n- [ ] Syncthing web GUI accessible on all hosts\n- [ ] Peer connectivity matrix validated: each host shows 4 connected devices\n- [ ] Connection verification for all 10 peer combinations (5 hosts × 4 peers / 2)\n- [ ] Device IDs match between peers (both sides see same ID)\n- [ ] Shared folders configured and syncing\n- [ ] Idempotency test: second playbook run shows no changes\n- [ ] No relay connections: all connections show as \"direct\" via API check\n- [ ] Documentation complete and accurate","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:29:02.643371471-08:00","updated_at":"2026-01-27T14:57:04.031715332-08:00","labels":["deployment","syncthing","validation"],"dependencies":[{"issue_id":"fleet-ake","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:29:02.64876531-08:00","created_by":"daemon"},{"issue_id":"fleet-ake","depends_on_id":"fleet-00d","type":"blocks","created_at":"2026-01-27T14:29:12.554289537-08:00","created_by":"daemon"},{"issue_id":"fleet-ake","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:35.732526086-08:00","created_by":"daemon"}]}
{"id":"fleet-bdb","title":"Update AGENTS.md with next steps rule","description":"Add a rule to AGENTS.md instructing agents to always capture identified next steps as new tasks in the beads system.","status":"closed","priority":2,"issue_type":"task","assignee":"kayos","created_at":"2026-01-06T16:13:00.878858978-08:00","created_by":"kayos","updated_at":"2026-01-06T16:13:08.431961489-08:00","closed_at":"2026-01-06T16:13:08.431961489-08:00","close_reason":"Updated AGENTS.md with next steps rule"}
{"id":"fleet-byo","title":"Document syncthing role in README.md","description":"Create comprehensive README documentation for the syncthing role explaining its purpose, usage, supported platforms, and configuration details.\n\nReference other role READMEs for structure and content.\n\n## Acceptance Criteria\n\n- [ ] `roles/syncthing/README.md` created\n- [ ] Documents role purpose (file synchronization)\n- [ ] Lists supported platforms (Linux, Darwin)\n- [ ] Documents required variables (if any)\n- [ ] Provides usage examples showing how to add role to host_vars\n- [ ] Documents installed packages per platform\n- [ ] Notes about user service vs system service for syncthing daemon\n- [ ] Follows markdown conventions (passes markdownlint)","acceptance_criteria":"- [ ] `roles/syncthing/README.md` created\n- [ ] Documents role purpose (file synchronization)\n- [ ] Lists supported platforms (Linux, Darwin)\n- [ ] Documents required variables (if any)\n- [ ] Provides usage examples showing how to add role to host_vars\n- [ ] Documents installed packages per platform\n- [ ] Notes about user service vs system service for syncthing daemon\n- [ ] Follows markdown conventions (passes markdownlint)","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:57:14.079956357-08:00","updated_at":"2026-01-27T14:06:33.032229961-08:00","dependencies":[{"issue_id":"fleet-byo","depends_on_id":"fleet-hef","type":"blocks","created_at":"2026-01-27T13:57:40.855006832-08:00","created_by":"daemon"},{"issue_id":"fleet-byo","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:48.721680272-08:00","created_by":"daemon"}]}
{"id":"fleet-c3u","title":"Create handlers for Syncthing service restart","description":"Create Ansible handlers to restart Syncthing services on Linux and Darwin after config changes.\n\n## Implementation\n\nUpdate `roles/syncthing/handlers/main.yml`:\n\n```yaml\n# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\n---\n- name: restart syncthing\n  ansible.builtin.systemd_service:\n    name: \"syncthing@{{ user_name }}.service\"\n    state: restarted\n    scope: user\n  when: ansible_facts.system | lower == 'linux'\n  listen: restart syncthing\n\n- name: restart syncthing\n  ansible.builtin.command:\n    cmd: launchctl kickstart -k \"gui/{{ ansible_user_uid }}/syncthing\"\n  when: ansible_facts.system | lower == 'darwin'\n  changed_when: true\n  listen: restart syncthing\n```\n\nAlternative Darwin approach using community.general.launchd:\n```yaml\n- name: restart syncthing\n  community.general.launchd:\n    name: syncthing\n    state: restarted\n  when: ansible_facts.system | lower == 'darwin'\n  listen: restart syncthing\n```\n\n## Acceptance Criteria\n\n- Handler created in roles/syncthing/handlers/main.yml\n- Linux handler restarts syncthing@username.service with user scope\n- Darwin handler restarts Syncthing via launchctl\n- Handler uses listen directive for unified notification\n- Handler only executes when notified by config change tasks\n- Handler respects platform differences (ansible_facts.system)\n- Follows FQCN convention and copyright header\n- `ansible-lint` passes","acceptance_criteria":"- [ ] Handler file created: `roles/syncthing/handlers/main.yml`\n- [ ] Linux handler: restart `syncthing@{{ user_name }}.service` using systemd\n- [ ] Darwin handler: restart Syncthing using `launchctl` or homebrew services\n- [ ] Handlers use platform-specific task includes: `{{ ansible_facts.system | lower }}_restart_syncthing.yml`\n- [ ] Handler names: \"restart syncthing\" (generic), \"restart syncthing linux\", \"restart syncthing darwin\"\n- [ ] Copyright header present in handler file\n- [ ] Test notification: add `notify: restart syncthing` to dummy task, verify service restarts\n- [ ] Handler waits for service to be running before completing\n- [ ] ansible-lint passes on handler file","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:35.212352182-08:00","updated_at":"2026-01-27T14:56:57.113993458-08:00","labels":["service-management","syncthing"],"dependencies":[{"issue_id":"fleet-c3u","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:35.217107557-08:00","created_by":"daemon"},{"issue_id":"fleet-c3u","depends_on_id":"fleet-75d","type":"blocks","created_at":"2026-01-27T14:29:07.899963943-08:00","created_by":"daemon"},{"issue_id":"fleet-c3u","depends_on_id":"fleet-loh","type":"blocks","created_at":"2026-01-27T14:29:08.34655091-08:00","created_by":"daemon"},{"issue_id":"fleet-c3u","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:33.735197597-08:00","created_by":"daemon"}]}
{"id":"fleet-c8a","title":"Create syncthing role directory structure only","description":"Create the basic directory structure for the syncthing role. This creates empty directories following project conventions.\n\nReference: AGENTS.md section \"Adding a New Role\"\n\n## Acceptance Criteria\n\n- [ ] Directory structure created: `roles/syncthing/{tasks,defaults,vars,handlers,meta,tests,files,templates}/`\n- [ ] All directories are empty (files will be added in subsequent tasks)","acceptance_criteria":"- [ ] Directory structure created: `roles/syncthing/{tasks,defaults,vars,handlers,meta,tests,files,templates}/`\n- [ ] All directories are empty (files will be added in subsequent tasks)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:56:30.016476241-08:00","updated_at":"2026-01-27T19:28:14.794942627-08:00","closed_at":"2026-01-27T19:28:14.794942627-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-c8a","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:40.547324654-08:00","created_by":"daemon"}]}
{"id":"fleet-ccd","title":"Configure firewall rules for optimal Syncthing peer connectivity","description":"Ensure firewalls on all fleet hosts allow Syncthing traffic for direct peer-to-peer connections, reducing reliance on relay servers and improving sync performance.\n\n## Background\n\nSyncthing uses multiple connection methods with fallback priorities:\n1. **Direct TCP (port 22000)** - Fastest, lowest latency\n2. **Direct QUIC (port 22000/UDP)** - Fast with better NAT traversal\n3. **Local Discovery (port 21027/UDP)** - LAN device discovery\n4. **Global Discovery** - Internet-based discovery via discovery servers\n5. **Relay Servers** - Fallback when direct connections fail (slowest)\n\nWithout proper firewall rules, Syncthing falls back to relay servers which adds latency and reduces throughput. This epic ensures direct connections work optimally.\n\n## Scope\n\n**In Scope:**\n- Configure ufw (Linux) to allow Syncthing ports\n- Configure pf/application firewall (Darwin) to allow Syncthing\n- Support both IPv4 and IPv6\n- Document firewall configuration in role README\n- Validate firewall rules applied correctly\n- Test connectivity between peers after firewall configuration\n\n**Out of Scope:**\n- Router/gateway firewall configuration (manual, environment-specific)\n- Port forwarding configuration (UPnP handles this automatically)\n- VPN/ZeroTier firewall rules (handled by those services)\n- Custom Syncthing port configuration (uses defaults)\n\n## Success Criteria\n- [ ] Child task fleet-zmb completed: Linux ufw rules configured\n- [ ] Child task fleet-jj1 completed: Darwin firewall rules configured\n- [ ] Child task fleet-7d6 completed: Port listening validation implemented\n- [ ] Child task fleet-67f completed: Peer connectivity testing implemented\n- [ ] Child task fleet-0mw completed: Connection type verification via API implemented\n- [ ] Child task fleet-y3k completed: Firewall configuration documented in README\n- [ ] Child task fleet-11m completed: Integration test created and passing\n- [ ] All firewall rules tested on both Linux and Darwin platforms\n- [ ] Documentation complete and accurate\n- [ ] Integration test validates entire firewall configuration","acceptance_criteria":"- [ ] Child task fleet-zmb completed: Linux ufw rules configured\n- [ ] Child task fleet-jj1 completed: Darwin firewall rules configured\n- [ ] Child task fleet-7d6 completed: Port listening validation implemented\n- [ ] Child task fleet-67f completed: Peer connectivity testing implemented\n- [ ] Child task fleet-0mw completed: Connection type verification via API implemented\n- [ ] Child task fleet-y3k completed: Firewall configuration documented in README\n- [ ] Child task fleet-11m completed: Integration test created and passing\n- [ ] All firewall rules tested on both Linux and Darwin platforms\n- [ ] Documentation complete and accurate\n- [ ] Integration test validates entire firewall configuration","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-27T14:45:02.896178085-08:00","updated_at":"2026-01-27T19:45:06.345251314-08:00","labels":["firewall","networking","security","syncthing"],"dependencies":[{"issue_id":"fleet-ccd","depends_on_id":"fleet-4g6","type":"blocks","created_at":"2026-01-27T14:45:02.902877724-08:00","created_by":"daemon"},{"issue_id":"fleet-ccd","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:45:02.908690105-08:00","created_by":"daemon"}]}
{"id":"fleet-cg6","title":"discover if there is an MCP for the Todoist service","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:16:32.860415129-08:00","created_by":"kayos","updated_at":"2026-01-06T17:29:48.851344464-08:00","closed_at":"2026-01-06T17:29:48.851344464-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-cg6","depends_on_id":"fleet-7bj","type":"blocks","created_at":"2026-01-06T16:19:21.756025017-08:00","created_by":"kayos"}]}
{"id":"fleet-cnb","title":"Configure Crush to use GitHub MCP","description":"Set up GitHub Model Context Protocol server for Crush to enable repository interaction and issue management.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:48:45.239818816-08:00","created_by":"kayos","updated_at":"2026-01-06T15:53:47.531460257-08:00","closed_at":"2026-01-06T15:53:47.531469299-08:00"}
{"id":"fleet-d6a","title":"Document connection types and troubleshooting","description":"## Context\nThis subtask is part of fleet-y3k (Document firewall configuration in Syncthing role README). It assumes readers understand firewall basics (from setup docs) and focuses on diagnosing connection issues.\n\n## Objective\nAdd troubleshooting documentation to help users diagnose and fix connection type issues, particularly when peers fall back to relay connections.\n\n## Content Sections\n1. **Connection Types**: Explain direct-*, quic-*, relay-* connection types\n2. **Identifying Issues**: How to check current connection types (Web UI, API, CLI)\n3. **Common Problems**: Firewall misconfiguration, NAT issues, discovery problems\n4. **Debugging Steps**: Systematic approach to diagnose connection failures\n5. **Solutions**: How to fix each common problem\n\n## Acceptance Criteria\n1. New \"## Troubleshooting Connections\" section added to `roles/syncthing/README.md`\n2. Explains difference between direct/QUIC/relay connection types\n3. Shows how to check connection types via Web UI\n4. Shows how to check via REST API (/rest/system/connections)\n5. Documents common failure patterns (all-relay, partial-relay, no-connection)\n6. Provides debugging checklist (firewall, ports, discovery, NAT)\n7. Links to verification task documentation\n8. Includes example outputs and interpretations\n9. Uses proper markdown formatting\n10. Passes markdownlint validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:17:03.04032486-08:00","updated_at":"2026-01-27T15:39:16.962155077-08:00","closed_at":"2026-01-27T15:39:16.962155077-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["documentation","firewall","syncthing"],"dependencies":[{"issue_id":"fleet-d6a","depends_on_id":"fleet-5y5","type":"blocks","created_at":"2026-01-27T15:17:25.99080649-08:00","created_by":"daemon"}]}
{"id":"fleet-dms","title":"Install and setup Ansible Language Server","description":"Add @ansible/ansible-language-server to mise.toml tools to enable LSP support for Crush.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:43:57.240889327-08:00","created_by":"kayos","updated_at":"2026-01-06T15:44:24.026557285-08:00","closed_at":"2026-01-06T15:44:24.026563702-08:00"}
{"id":"fleet-dzd","title":"Create syncthing role foundation files","description":"Create the minimal foundation files for the syncthing role with copyright headers and placeholders. These files will be populated in subsequent tasks.\n\nFiles to create:\n- `roles/syncthing/tasks/main.yml` - Empty with copyright header\n- `roles/syncthing/defaults/main.yml` - Empty with copyright header and comment placeholder\n- `roles/syncthing/handlers/main.yml` - Empty with copyright header\n\n## Acceptance Criteria\n\n- [ ] `roles/syncthing/tasks/main.yml` created with copyright header \"# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\"\n- [ ] `roles/syncthing/defaults/main.yml` created with copyright header and comment \"# Default variables for syncthing role\"\n- [ ] `roles/syncthing/handlers/main.yml` created with copyright header\n- [ ] All files follow project formatting conventions","acceptance_criteria":"- [ ] `roles/syncthing/tasks/main.yml` created with copyright header \"# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\"\n- [ ] `roles/syncthing/defaults/main.yml` created with copyright header and comment \"# Default variables for syncthing role\"\n- [ ] `roles/syncthing/handlers/main.yml` created with copyright header\n- [ ] All files follow project formatting conventions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:09.385519938-08:00","updated_at":"2026-01-27T20:37:31.806843079-08:00","closed_at":"2026-01-27T20:37:31.806843079-08:00","close_reason":"Closed","labels":["syncthing"],"dependencies":[{"issue_id":"fleet-dzd","depends_on_id":"fleet-c8a","type":"blocks","created_at":"2026-01-27T14:06:16.476245585-08:00","created_by":"daemon"},{"issue_id":"fleet-dzd","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T14:06:16.600986556-08:00","created_by":"daemon"}]}
{"id":"fleet-ecb","title":"Implement prusa-slicer installation in printing_3d role","description":"Found TODO in roles/printing_3d/tasks/main.yml: install prusa-slicer","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T16:36:45.150031629-08:00","created_by":"kayos","updated_at":"2026-01-07T16:41:11.596793591-08:00","closed_at":"2026-01-07T16:41:11.596793591-08:00","close_reason":"Implemented prusa-slicer installation in printing_3d role"}
{"id":"fleet-eom","title":"SDR role test fails: empty sequence error when finding SDR++ package asset","description":"## Problem\n\nThe `mise run test` command fails in the SDR role at task \"SDR++ | Set download URL fact\" with error:\n```\nError while resolving value for 'sdr_sdrplusplus_url': No first item, sequence was empty.\n```\n\nLocation: `roles/sdr/tasks/main.yml:38-46`\n\n## Root Cause\n\nThe task uses a complex Jinja2 expression to find a matching Debian package from the GitHub release assets:\n```yaml\nsdr_sdrplusplus_url: \u003e-\n  {{\n    (sdr_release_info.json.assets |\n    selectattr('name', 'equalto', 'sdrpp_debian_' +\n    (sdr_release_override | default(ansible_facts['distribution_release'])) +\n    '_' + ansible_facts['architecture'] + '.deb') | first).browser_download_url\n  }}\n```\n\nThe `selectattr` filter is returning an empty sequence (no matching assets found), so the `first` filter fails because there's no first item.\n\nThis could happen if:\n1. The constructed filename doesn't match any actual asset names in the release\n2. The architecture or distribution_release values are not what's expected\n3. The GitHub release structure has changed\n\n## Impact\n\n- `mise run test` fails\n- Quality gate for Landing the Plane procedure is blocked\n- Cannot verify SDR role changes in check mode\n\n## Steps to Reproduce\n\n1. Run `mise run test` from the repository root\n2. Observe the test playbook execute through base and user_core roles successfully\n3. Watch the SDR role fail at the \"SDR++ | Set download URL fact\" task with empty sequence error\n\n## Suggested Solution\n\nAdd error handling to gracefully handle the case where no matching asset is found:\n- Use `default(None)` after the `first` filter\n- Add conditional logic to skip installation if no matching asset found\n- Log informative message about what was searched for vs what was available\n\n## Acceptance Criteria\n\n- [ ] `mise run test` passes successfully\n- [ ] SDR role handles case where no matching asset is found gracefully (skips task or provides clear error)\n- [ ] Error message is informative if matching asset cannot be found\n- [ ] All linting passes with `mise run lint`","acceptance_criteria":"- mise run test passes successfully\n- SDR role handles case where no matching asset is found gracefully\n- Error message is informative if matching asset cannot be found\n- Tests pass with mise run test\n- Linting passes with mise run lint","status":"closed","priority":1,"issue_type":"bug","owner":"kayos@genetikayos.com","created_at":"2026-01-27T20:14:42.314655259-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T20:33:35.159208163-08:00","closed_at":"2026-01-27T20:33:35.159208163-08:00","close_reason":"Closed"}
{"id":"fleet-err","title":"Implement connection type verification via API","description":"Query Syncthing connections API and verify all peers using direct connections (not relay).\n\n## Context\nThis is part of connection type verification (parent: fleet-0mw). Uses API client setup from sibling task.\n\n## Implementation\n\nCreate `roles/syncthing/tasks/verify_connection_type.yml`:\n\n- Include api_client_setup.yml task\n- Query /rest/system/connections endpoint with API key\n- Parse JSON response for each peer connection\n- Extract connection.type field for each peer\n- Verify all connections show type==\"direct\" or type==\"quic\"\n- Warn if any connection shows type==\"relay\"\n- Register verification result as fact\n\n## Acceptance Criteria\n\n- [ ] verify_connection_type.yml created in roles/syncthing/tasks/\n- [ ] Task includes api_client_setup.yml\n- [ ] Task queries /rest/system/connections with X-API-Key header\n- [ ] JSON response parsed using from_json filter\n- [ ] Connection type extracted for each peer: .connections[].type\n- [ ] Task warns (not fails) if relay connections detected\n- [ ] Task fails if API returns error or invalid JSON\n- [ ] Verification result registered to fact: syncthing_connections_verified\n- [ ] Task documents expected connection types in comments\n- [ ] Copyright header present\n- [ ] ansible-lint passes","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:25.702166354-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:15.520068856-08:00","closed_at":"2026-01-27T15:39:15.520068856-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["api","firewall","syncthing"]}
{"id":"fleet-gci","title":"configure Crush to use the GitHub MCP","notes":"Configured GitHub MCP in .crush.json with authentication via 1Password CLI. The MCP server provides access to GitHub API operations including file management, repository operations, PR/issue management, and search functionality.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:15:26.383202543-08:00","created_by":"kayos","updated_at":"2026-01-06T16:35:11.359518776-08:00","closed_at":"2026-01-06T16:35:11.359530443-08:00"}
{"id":"fleet-gfi","title":"Implement Darwin package installation for syncthing","description":"Create Darwin-specific package installation task file for Syncthing. Use homebrew module with proper FQCN conventions.\n\nFollow pattern from roles/base/tasks/darwin_install_packages.yml\n\n## Acceptance Criteria\n\n- [ ] roles/syncthing/tasks/darwin_install_packages.yml created\n- [ ] Uses community.general.homebrew with FQCN\n- [ ] Installs packages from syncthing_package_names variable\n- [ ] Includes proper task naming and copyright header\n- [ ] Uses state: present for package installation","acceptance_criteria":"- [ ] roles/syncthing/tasks/darwin_install_packages.yml created\n- [ ] Uses community.general.homebrew with FQCN\n- [ ] Installs packages from syncthing_package_names variable\n- [ ] Includes proper task naming and copyright header\n- [ ] Uses state: present for package installation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:56:46.699748974-08:00","updated_at":"2026-01-27T20:51:34.045347695-08:00","closed_at":"2026-01-27T20:51:34.045347695-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-gfi","depends_on_id":"fleet-l98","type":"blocks","created_at":"2026-01-27T13:57:40.664092868-08:00","created_by":"daemon"},{"issue_id":"fleet-gfi","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:46.341143494-08:00","created_by":"daemon"}]}
{"id":"fleet-hef","title":"Implement main.yml orchestration for syncthing role","description":"Implement the main task orchestration file (roles/syncthing/tasks/main.yml) that ties together variable loading, package installation, and service management.\n\nFollow the pattern from roles/base/tasks/main.yml:\n1. Load OS-specific variables\n2. Include platform-specific package installation\n3. Include platform-specific service enablement\n\n## Acceptance Criteria\n\n- [ ] roles/syncthing/tasks/main.yml implements OS-specific variable loading\n- [ ] Includes platform-specific package installation (linux_install_packages.yml, darwin_install_packages.yml)\n- [ ] Includes platform-specific service enablement (linux_enable_service.yml, darwin_enable_service.yml)\n- [ ] Uses ansible_facts.system to dynamically include correct task files\n- [ ] Follows base role pattern for structure and naming\n- [ ] All tasks use FQCN and proper naming conventions\n- [ ] Copyright header present","acceptance_criteria":"- [ ] roles/syncthing/tasks/main.yml implements OS-specific variable loading\n- [ ] Includes platform-specific package installation (linux_install_packages.yml, darwin_install_packages.yml)\n- [ ] Includes platform-specific service enablement (linux_enable_service.yml, darwin_enable_service.yml)\n- [ ] Uses ansible_facts.system to dynamically include correct task files\n- [ ] Follows base role pattern for structure and naming\n- [ ] All tasks use FQCN and proper naming conventions\n- [ ] Copyright header present","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:57:03.257942237-08:00","updated_at":"2026-01-27T21:16:37.130478618-08:00","closed_at":"2026-01-27T21:16:37.130478618-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-hef","depends_on_id":"fleet-mtd","type":"blocks","created_at":"2026-01-27T13:57:40.760298127-08:00","created_by":"daemon"},{"issue_id":"fleet-hef","depends_on_id":"fleet-k81","type":"blocks","created_at":"2026-01-27T13:57:40.780462661-08:00","created_by":"daemon"},{"issue_id":"fleet-hef","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:47.739560859-08:00","created_by":"daemon"}]}
{"id":"fleet-hvh","title":"Fix UFW OpenSSH profile error in base role tests on Arch Linux","description":"The `mise run test` command fails on `roles/base/tasks/linux_enable_sshd.yml` with `ERROR: Could not find a profile matching 'OpenSSH'`. This requires investigating why the OpenSSH profile is missing on the Arch Linux environment or adjusting the variable `base_ufw_ssh_app_profile_name` in `roles/base/vars/archlinux.yml`.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T16:25:59.606789789-08:00","created_by":"kayos","updated_at":"2026-01-07T16:28:22.980249816-08:00","closed_at":"2026-01-07T16:28:22.980249816-08:00","close_reason":"Fixed UFW profile name for Arch Linux to use 'SSH'"}
{"id":"fleet-i81","title":"Configure Crush to use Ansible Language Server","description":"Verify and ensure Crush configuration is set up to utilize the installed Ansible Language Server.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:57:07.086137695-08:00","created_by":"kayos","updated_at":"2026-01-06T15:58:43.258343205-08:00","closed_at":"2026-01-06T15:58:43.25834933-08:00"}
{"id":"fleet-ic2","title":"Document auto-pairing feature in role README","description":"Document the Syncthing auto-pairing feature in role README and project documentation.\n\n## Implementation\n\nUpdate `roles/syncthing/README.md` with new section:\n\n```markdown\n## Auto-Pairing (Optional)\n\nThe role supports automatic device pairing across the fleet using 1Password for device ID storage.\n\n### Prerequisites\n\n1. Syncthing installed and running on all hosts (base role functionality)\n2. 1Password CLI authenticated: `op signin`\n3. Device IDs collected at least once: `mise run syncthing:autopair --tags collect,store`\n\n### Initial Setup\n\n1. **Collect device IDs**:\n   ```bash\n   mise run syncthing:autopair --tags collect,store\n   ```\n\n2. **Apply configuration**:\n   ```bash\n   mise run syncthing:autopair --tags configure\n   ```\n\n3. **Verify pairing**:\n   - Open Syncthing web GUI on any host: `http://localhost:8384`\n   - Navigate to \"Remote Devices\" - all fleet devices should be listed\n   - Check connection status (should show \"Connected\" after a few seconds)\n\n### Shared Folders\n\nDefine shared folders in `roles/syncthing/defaults/main.yml`:\n\n```yaml\nsyncthing_shared_folders:\n  - id: documents\n    label: Documents\n    path: \"{{ ansible_env.HOME }}/Sync/Documents\"\n    type: sendreceive\n  - id: photos\n    label: Photos\n    path: \"{{ ansible_env.HOME }}/Sync/Photos\"\n    type: sendreceive\n```\n\n### Adding New Hosts\n\nWhen adding new hosts to the fleet:\n\n1. Run base Syncthing installation on new host\n2. Collect device ID: `mise run syncthing:autopair --tags collect,store -l newhostname`\n3. Re-apply config to all hosts: `mise run syncthing:autopair --tags configure`\n\n### Troubleshooting\n\n- **Device not connecting**: Check firewall rules, ensure port 22000/TCP open\n- **Config validation fails**: Check XML syntax in template\n- **1Password lookup fails**: Verify `op signin` session active\n```\n\nUpdate project `README.md` with reference to Syncthing role.\n\n## Acceptance Criteria\n\n- roles/syncthing/README.md updated with auto-pairing section\n- Prerequisites documented clearly\n- Setup workflow documented step-by-step\n- Shared folder configuration explained with examples\n- Adding new hosts procedure documented\n- Troubleshooting section included\n- Project README.md references Syncthing role\n- `markdownlint` passes on all documentation","acceptance_criteria":"- [ ] `roles/syncthing/README.md` updated with auto-pairing feature section\n- [ ] Section includes overview of auto-pairing workflow (2-phase: collection/config)\n- [ ] Documents required 1Password setup: vault item path and structure\n- [ ] Documents mise task usage: `mise run syncthing:autopair`\n- [ ] Explains device ID collection from REST API\n- [ ] Explains config.xml templating with device list\n- [ ] Documents limitations: requires 1Password CLI (`op signin`)\n- [ ] Includes troubleshooting section for common issues\n- [ ] Includes example output or sample device ID format\n- [ ] markdownlint passes on README.md\n- [ ] Links to relevant task files for technical details","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:50.603227015-08:00","updated_at":"2026-01-27T14:57:00.528009122-08:00","labels":["documentation","syncthing"],"dependencies":[{"issue_id":"fleet-ic2","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:50.60915665-08:00","created_by":"daemon"},{"issue_id":"fleet-ic2","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:34.753259582-08:00","created_by":"daemon"}]}
{"id":"fleet-in2","title":"Implement connection type verification via API","description":"## Context\nThis subtask is part of fleet-0mw (Add Syncthing connection type verification via API). It implements the business logic for querying connection types and verifying direct/QUIC connections.\n\n## Objective\nCreate an Ansible task that queries the Syncthing REST API to verify all peer connections are using direct (non-relay) connection types.\n\n## Implementation\nCreate verification task that:\n- Includes api_client_setup.yml for API access\n- Queries `/rest/system/connections` endpoint\n- Parses JSON response to extract connection types for each peer\n- Verifies all connections use \"direct-*\" or \"quic-*\" (not \"relay-*\")\n- Fails with clear error if relay connections detected\n\n## Acceptance Criteria\n1. Task file created that includes api_client_setup.yml\n2. Uses `ansible.builtin.uri` to query `/rest/system/connections`\n3. Parses JSON response with `ansible.builtin.set_fact` or `ansible.builtin.debug`\n4. Checks each peer's connection type field\n5. Accepts \"direct-accept\", \"direct-dial\", \"quic-accept\", \"quic-dial\" as valid\n6. Rejects \"relay-accept\", \"relay-dial\" as invalid (fails task)\n7. Provides clear error message listing which peers use relay\n8. Can be run as part of validation play or standalone\n9. Follows FQCN convention\n10. Includes copyright header\n11. Passes ansible-lint validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:16:52.779985301-08:00","updated_at":"2026-01-27T15:39:16.628713873-08:00","closed_at":"2026-01-27T15:39:16.628713873-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["api","firewall","syncthing"],"dependencies":[{"issue_id":"fleet-in2","depends_on_id":"fleet-33f","type":"blocks","created_at":"2026-01-27T15:17:25.456684813-08:00","created_by":"daemon"}]}
{"id":"fleet-jj1","title":"Configure Darwin firewall rules for Syncthing ports","description":"## Objective\nImplement firewall rules for macOS/Darwin hosts to allow Syncthing traffic through the system firewall.\n\n## Acceptance Criteria\n- [ ] Task file created: roles/syncthing/tasks/darwin_enable_firewall.yml\n- [ ] Task uses community.general.osx_defaults or appropriate Darwin module\n- [ ] Task allows TCP port 22000 for Syncthing sync\n- [ ] Task allows UDP port 22000 for Syncthing discovery\n- [ ] Task allows UDP port 21027 for Syncthing discovery\n- [ ] Task validates firewall is enabled before adding rules\n- [ ] Task is idempotent (repeated runs do not cause changes)\n- [ ] Task follows existing Darwin firewall patterns from base role\n- [ ] Task included in roles/syncthing/tasks/main.yml via platform detection\n- [ ] Task passes lint: mise run lint:ansible","acceptance_criteria":"- [ ] Task file created: roles/syncthing/tasks/darwin_enable_firewall.yml\n- [ ] Task uses community.general.osx_defaults or appropriate Darwin module\n- [ ] Task allows TCP port 22000 for Syncthing sync\n- [ ] Task allows UDP port 22000 for Syncthing discovery\n- [ ] Task allows UDP port 21027 for Syncthing discovery\n- [ ] Task validates firewall is enabled before adding rules\n- [ ] Task is idempotent (repeated runs do not cause changes)\n- [ ] Task follows existing Darwin firewall patterns from base role\n- [ ] Task included in roles/syncthing/tasks/main.yml via platform detection\n- [ ] Task passes lint: mise run lint:ansible","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:46:12.514169237-08:00","updated_at":"2026-01-27T19:44:59.830126517-08:00","labels":["darwin","firewall","macos","syncthing"],"dependencies":[{"issue_id":"fleet-jj1","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:46:12.519522531-08:00","created_by":"daemon"},{"issue_id":"fleet-jj1","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:01.998923198-08:00","created_by":"daemon"}]}
{"id":"fleet-k81","title":"Implement Darwin service enablement for syncthing","description":"Create Darwin-specific task file to enable and start Syncthing using launchd. Darwin uses launchd instead of systemd for service management.\n\nFollow pattern from roles/base/tasks/darwin_enable_*.yml files.\n\n## Acceptance Criteria\n\n- [ ] roles/syncthing/tasks/darwin_enable_service.yml created\n- [ ] Uses community.general.launchd with FQCN\n- [ ] Enables and starts syncthing service on Darwin\n- [ ] Includes proper task naming and copyright header\n- [ ] Uses state: started and enabled: true","acceptance_criteria":"- [ ] roles/syncthing/tasks/darwin_enable_service.yml created\n- [ ] Uses community.general.launchd with FQCN\n- [ ] Enables and starts syncthing service on Darwin\n- [ ] Includes proper task naming and copyright header\n- [ ] Uses state: started and enabled: true","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:56:57.434884623-08:00","updated_at":"2026-01-27T21:13:08.290876071-08:00","closed_at":"2026-01-27T21:13:08.290876071-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-k81","depends_on_id":"fleet-gfi","type":"blocks","created_at":"2026-01-27T13:57:40.725495602-08:00","created_by":"daemon"},{"issue_id":"fleet-k81","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:47.239076744-08:00","created_by":"daemon"}]}
{"id":"fleet-l6e","title":"Create cross-platform firewall integration test","description":"Create integration test to verify firewall configuration works across Linux and Darwin platforms.\n\n## Context\nThis is part of firewall integration testing (parent: fleet-11m). Validates complete firewall configuration.\n\n## Implementation\n\nCreate `roles/syncthing/tests/test_firewall_integration.yml`:\n\n- Run on mixed platform group (laptop:workstation)\n- Verify platform-specific firewall tasks execute correctly\n- Test peer connectivity across platforms (Linux to Darwin, Darwin to Linux)\n- Use API to verify connection types (direct, not relay)\n- Verify all hosts can reach each other on port 22000\n- Test discovery on port 21027\n\n## Acceptance Criteria\n\n- [ ] test_firewall_integration.yml created in roles/syncthing/tests/\n- [ ] Test runs on laptop and workstation groups (mixed platforms)\n- [ ] Test includes platform-specific task execution\n- [ ] Test verifies peer connectivity across platforms\n- [ ] Test uses /rest/system/connections API to verify connection types\n- [ ] Test verifies all connections are direct (not relay)\n- [ ] Test includes cross-platform connectivity matrix validation\n- [ ] Test verifies discovery protocol on UDP 21027\n- [ ] Test handles failures gracefully with clear error messages\n- [ ] Copyright header present\n- [ ] ansible-playbook --syntax-check passes\n- [ ] ansible-lint passes","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:47.739986554-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:16.312348038-08:00","closed_at":"2026-01-27T15:39:16.312348038-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["firewall","integration","syncthing","testing"]}
{"id":"fleet-l98","title":"Define OS-specific package variables for syncthing","description":"Define OS-specific package variables for Syncthing installation following the project's layered variable pattern (system → os_family → distribution).\n\n**Packages to include:**\n- Linux/Debian: syncthing, syncthingtray (or syncthing-gtk if available)\n- Darwin: syncthing (homebrew), syncthing-macos or equivalent GUI\n\nFollow the variable loading pattern used in base role.\n\n## Acceptance Criteria\n\n- [ ] roles/syncthing/vars/linux.yml created with syncthing packages\n- [ ] roles/syncthing/vars/debian.yml created with apt-specific package names (syncthing, syncthingtray)\n- [ ] roles/syncthing/vars/darwin.yml created with homebrew package names (syncthing, syncthing-gtk or equivalent)\n- [ ] Variables follow naming convention: syncthing_package_names list\n- [ ] OS-specific package lists verified against upstream repositories","acceptance_criteria":"- [ ] roles/syncthing/vars/linux.yml created with syncthing packages\n- [ ] roles/syncthing/vars/debian.yml created with apt-specific package names (syncthing, syncthingtray)\n- [ ] roles/syncthing/vars/darwin.yml created with homebrew package names (syncthing, syncthing-gtk or equivalent)\n- [ ] Variables follow naming convention: syncthing_package_names list\n- [ ] OS-specific package lists verified against upstream repositories","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:56:36.720980341-08:00","updated_at":"2026-01-27T20:43:45.002211673-08:00","closed_at":"2026-01-27T20:43:45.002211673-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-l98","depends_on_id":"fleet-c8a","type":"blocks","created_at":"2026-01-27T13:57:40.589793114-08:00","created_by":"daemon"},{"issue_id":"fleet-l98","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:45.136892493-08:00","created_by":"daemon"},{"issue_id":"fleet-l98","depends_on_id":"fleet-dzd","type":"blocks","created_at":"2026-01-27T14:06:17.538118272-08:00","created_by":"daemon"}]}
{"id":"fleet-lcb","title":"Create Darwin firewall integration test","description":"Create integration test playbook to verify Darwin firewall configuration for Syncthing.\n\n## Context\nThis is part of firewall integration testing (parent: fleet-11m). Tests Darwin-specific firewall configuration.\n\n## Implementation\n\nCreate `roles/syncthing/tests/test_darwin_firewall.yml`:\n\n- Test socketfilterfw status (if applicable)\n- Test application firewall allows Syncthing\n- Test port listening: lsof or netstat shows ports open\n- Test local connectivity: curl to 127.0.0.1:8384\n- Include role and run firewall tasks\n- Verify tasks are idempotent\n\n## Acceptance Criteria\n\n- [ ] test_darwin_firewall.yml created in roles/syncthing/tests/\n- [ ] Test runs only on Darwin hosts (ansible_facts.system == 'Darwin')\n- [ ] Test verifies application firewall configuration\n- [ ] Test verifies Syncthing app is allowed in firewall\n- [ ] Test verifies ports are listening using lsof or netstat\n- [ ] Test verifies Syncthing API is accessible (http://127.0.0.1:8384)\n- [ ] Test handles case where firewall is disabled (macOS often disables by default)\n- [ ] Test includes idempotency check (second run shows no changes)\n- [ ] Copyright header present\n- [ ] ansible-playbook --syntax-check passes\n- [ ] ansible-lint passes","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:43.414917337-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:22.676365725-08:00","closed_at":"2026-01-27T15:39:22.676365725-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["darwin","firewall","syncthing","testing"],"dependencies":[{"issue_id":"fleet-lcb","depends_on_id":"fleet-l6e","type":"blocks","created_at":"2026-01-27T15:13:59.313705457-08:00","created_by":"daemon"}]}
{"id":"fleet-li9","title":"Document connection types and troubleshooting","description":"Add connection types explanation and troubleshooting guide to Syncthing role README.\n\n## Context\nThis is part of firewall documentation (parent: fleet-y3k). Covers connection verification and troubleshooting.\n\n## Content to Add\n\nSections in roles/syncthing/README.md:\n\n### Connection Types\n- Explain direct connections (LAN)\n- Explain QUIC connections (faster NAT traversal)\n- Explain relay connections (fallback, slower)\n- Document how to verify connection types via web GUI\n- Document API endpoint for programmatic verification\n\n### Troubleshooting\n- Common issue: Firewall blocking despite configuration\n- Common issue: Relay connections instead of direct\n- Verification steps for each platform\n- How to check Syncthing logs\n- How to test connectivity with API\n\n## Acceptance Criteria\n\n- [ ] README.md section added: ### Connection Types\n- [ ] README.md section added: ### Troubleshooting\n- [ ] Direct connections explained with performance characteristics\n- [ ] QUIC connections explained with use case\n- [ ] Relay connections explained with fallback behavior\n- [ ] Web GUI verification steps documented\n- [ ] API verification endpoint documented (/rest/system/connections)\n- [ ] Common troubleshooting scenarios included (at least 3)\n- [ ] Platform-specific troubleshooting steps included\n- [ ] markdownlint passes on README.md","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:34.973250723-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:15.850656451-08:00","closed_at":"2026-01-27T15:39:15.850656451-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["documentation","firewall","syncthing"]}
{"id":"fleet-loh","title":"Apply templated config.xml to Syncthing instances","description":"Create Ansible task to apply templated config.xml to all Syncthing instances, backing up existing config first.\n\n## Implementation\n\nCreate `roles/syncthing/tasks/apply_config.yml`:\n\n```yaml\n# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\n---\n- name: \"Syncthing | Stop Syncthing service before config change\"\n  ansible.builtin.systemd_service:\n    name: \"syncthing@{{ user_name }}.service\"\n    state: stopped\n    scope: user\n  when: ansible_facts.system | lower == 'linux'\n\n- name: \"Syncthing | Backup existing config\"\n  ansible.builtin.copy:\n    src: \"{{ ansible_env.HOME }}/.config/syncthing/config.xml\"\n    dest: \"{{ ansible_env.HOME }}/.config/syncthing/config.xml.backup.{{ ansible_date_time.epoch }}\"\n    remote_src: true\n    mode: '0600'\n  when: syncthing_config_exists.stat.exists\n\n- name: \"Syncthing | Check if config exists\"\n  ansible.builtin.stat:\n    path: \"{{ ansible_env.HOME }}/.config/syncthing/config.xml\"\n  register: syncthing_config_exists\n\n- name: \"Syncthing | Apply templated config\"\n  ansible.builtin.template:\n    src: config.xml.j2\n    dest: \"{{ ansible_env.HOME }}/.config/syncthing/config.xml\"\n    owner: \"{{ user_name }}\"\n    mode: '0600'\n    backup: true\n  notify: restart syncthing\n\n- name: \"Syncthing | Validate config XML syntax\"\n  ansible.builtin.command:\n    cmd: xmllint --noout \"{{ ansible_env.HOME }}/.config/syncthing/config.xml\"\n  changed_when: false\n  failed_when: false\n  register: xmllint_result\n\n- name: \"Syncthing | Fail if config invalid\"\n  ansible.builtin.fail:\n    msg: \"Invalid XML syntax in config.xml\"\n  when: xmllint_result.rc != 0\n```\n\n## Acceptance Criteria\n\n- Task file created in roles/syncthing/tasks/\n- Existing config.xml backed up with timestamp\n- Templated config applied with correct ownership and permissions (0600)\n- XML syntax validated using xmllint before applying\n- Syncthing service stopped before config change (prevents corruption)\n- Handler notified to restart service after config change\n- Task fails safely if XML validation fails\n- Follows FQCN convention and copyright header\n- `ansible-lint` passes","acceptance_criteria":"- [ ] Ansible task created to apply config.xml.j2 template\n- [ ] Task uses `ansible.builtin.template` module\n- [ ] Template source: `roles/syncthing/templates/config.xml.j2`\n- [ ] Template destination: `~/.config/syncthing/config.xml` (Linux) or `~/Library/Application Support/Syncthing/config.xml` (Darwin)\n- [ ] Backup created before overwriting: `backup: yes` parameter\n- [ ] XML validation performed after templating: use `ansible.builtin.command` with `xmllint --noout`\n- [ ] Task notifies handler to restart Syncthing service\n- [ ] Runs only on hosts in laptop and workstation groups\n- [ ] Test run with --check shows config would be updated\n- [ ] Test run in execution mode successfully updates config on test hosts\n- [ ] Syncthing web GUI shows connected devices after config applied\n- [ ] ansible-lint passes on task file","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:29.93796574-08:00","updated_at":"2026-01-27T14:56:53.956477634-08:00","labels":["configuration","syncthing"],"dependencies":[{"issue_id":"fleet-loh","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:29.951246606-08:00","created_by":"daemon"},{"issue_id":"fleet-loh","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:33.289445075-08:00","created_by":"daemon"}]}
{"id":"fleet-lqf","title":"Load device IDs from 1Password into hostvars","description":"Create Ansible task to load Syncthing device IDs from 1Password vault into hostvars for templating.\n\n## Implementation\n\nCreate `roles/syncthing/tasks/load_device_ids.yml`:\n\n```yaml\n# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\n---\n- name: \"Syncthing | Load device IDs from 1Password\"\n  ansible.builtin.set_fact:\n    syncthing_device_id: \"{{ lookup('ansible.builtin.pipe', 'op read \\\"op://ServiceAccountAccess/Syncthing Fleet Device IDs/' + inventory_hostname + '\\\"') }}\"\n  delegate_to: localhost\n  run_once: false\n\n- name: \"Syncthing | Verify device ID format\"\n  ansible.builtin.assert:\n    that:\n      - syncthing_device_id is defined\n      - syncthing_device_id | length == 63  # 52 chars + 11 dashes\n      - syncthing_device_id is match('^[A-Z0-9-]+$')\n    fail_msg: \"Invalid device ID format for {{ inventory_hostname }}: {{ syncthing_device_id }}\"\n    success_msg: \"Device ID loaded successfully for {{ inventory_hostname }}\"\n```\n\nIntegration in main tasks:\n```yaml\n# roles/syncthing/tasks/main.yml\n- name: \"Include device ID loading\"\n  ansible.builtin.include_tasks: load_device_ids.yml\n  when: syncthing_auto_pair | default(false)\n```\n\n## Acceptance Criteria\n\n- Task file created using lookup plugin for op CLI\n- Device IDs loaded into hostvars for all hosts\n- Device ID format validated (63 chars, alphanumeric + dashes)\n- Task fails gracefully if 1Password item missing or malformed\n- Task runs on localhost via delegate_to\n- Follows FQCN convention and copyright header\n- `ansible-lint` passes","acceptance_criteria":"- [ ] hostvars variable file created or group_vars updated for Syncthing device IDs\n- [ ] Uses `lookup('pipe', 'op read ...')` to fetch device IDs from 1Password\n- [ ] Variable structure supports all 5 hosts: `syncthing_fleet_devices`\n- [ ] Example: `syncthing_fleet_devices.rincewind` contains device ID\n- [ ] Device IDs loaded at playbook runtime (not hardcoded)\n- [ ] Fallback mechanism if 1Password read fails (fail task with clear message)\n- [ ] Test playbook can access device IDs: `{{ syncthing_fleet_devices[inventory_hostname] }}`\n- [ ] Variable documented in role defaults or group_vars with comments\n- [ ] ansible-lint passes on variable files","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:23.15823044-08:00","updated_at":"2026-01-27T14:56:50.399620573-08:00","labels":["1password","secrets-management","syncthing"],"dependencies":[{"issue_id":"fleet-lqf","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:23.163843322-08:00","created_by":"daemon"},{"issue_id":"fleet-lqf","depends_on_id":"fleet-0g5","type":"blocks","created_at":"2026-01-27T14:29:07.355180997-08:00","created_by":"daemon"},{"issue_id":"fleet-lqf","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:32.80255672-08:00","created_by":"daemon"}]}
{"id":"fleet-m94","title":"Create cross-platform firewall integration test","description":"## Context\nThis subtask is part of fleet-11m (Create integration test for Syncthing firewall configuration). It requires both Linux and Darwin platform tests to pass first, then verifies connectivity between mixed-platform hosts.\n\n## Objective\nCreate an Ansible test playbook that verifies Syncthing can establish direct connections between Linux and Darwin hosts, confirming cross-platform firewall compatibility.\n\n## Test Coverage\n1. **Mixed Platform Connectivity**: Test rincewind (Linux) ↔ constantine (Darwin)\n2. **Connection Types**: Verify all connections are direct/QUIC (not relay)\n3. **Bi-directional**: Ensure both hosts can initiate connections\n4. **Discovery**: Verify local discovery works across platforms\n\n## Implementation Location\n`roles/syncthing/tests/test_cross_platform_firewall.yml`\n\n## Acceptance Criteria\n1. Test playbook created at specified location\n2. Targets both test hosts (rincewind, constantine)\n3. Includes platform-specific firewall tests dynamically\n4. Uses connection type verification task to check peer connections\n5. Verifies rincewind→constantine connection is direct/QUIC\n6. Verifies constantine→rincewind connection is direct/QUIC\n7. Tests local discovery between platforms (port 21027 UDP)\n8. Uses `ansible.builtin.assert` for all validations\n9. Provides clear failure messages with peer details\n10. Follows FQCN convention\n11. Includes copyright header\n12. Passes ansible-lint validation","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T15:17:15.046725881-08:00","updated_at":"2026-01-27T15:39:17.419102036-08:00","closed_at":"2026-01-27T15:39:17.419102036-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["firewall","integration","syncthing","testing"],"dependencies":[{"issue_id":"fleet-m94","depends_on_id":"fleet-4up","type":"blocks","created_at":"2026-01-27T15:17:26.476893253-08:00","created_by":"daemon"},{"issue_id":"fleet-m94","depends_on_id":"fleet-3ck","type":"blocks","created_at":"2026-01-27T15:17:26.971926877-08:00","created_by":"daemon"}]}
{"id":"fleet-mtd","title":"Implement Linux service enablement for syncthing","description":"Create Linux-specific task file to enable and start the Syncthing user systemd service. Syncthing runs as a user service (syncthing@username.service) not a system service.\n\n**Important:** Use `scope: user` in ansible.builtin.systemd_service module to manage user-level services.\n\n## Acceptance Criteria\n\n- [ ] roles/syncthing/tasks/linux_enable_service.yml created\n- [ ] Uses ansible.builtin.systemd_service (user service) with FQCN\n- [ ] Enables syncthing@{{ user_name }}.service\n- [ ] Starts syncthing@{{ user_name }}.service\n- [ ] Uses scope: user for user-level systemd service\n- [ ] Includes proper task naming and copyright header","acceptance_criteria":"- [ ] roles/syncthing/tasks/linux_enable_service.yml created\n- [ ] Uses ansible.builtin.systemd_service (user service) with FQCN\n- [ ] Enables syncthing@{{ user_name }}.service\n- [ ] Starts syncthing@{{ user_name }}.service\n- [ ] Uses scope: user for user-level systemd service\n- [ ] Includes proper task naming and copyright header","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:56:52.576056333-08:00","updated_at":"2026-01-27T21:05:19.342488588-08:00","closed_at":"2026-01-27T21:05:19.342488588-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-mtd","depends_on_id":"fleet-4j8","type":"blocks","created_at":"2026-01-27T13:57:40.690908621-08:00","created_by":"daemon"},{"issue_id":"fleet-mtd","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:46.817492585-08:00","created_by":"daemon"}]}
{"id":"fleet-n9m","title":"Create test playbook for syncthing role","description":"Create the test playbook and inventory for validating the syncthing role independently. This allows check mode testing without modifying the system.\n\nReference: `roles/base/tests/test.yml` and other role test patterns.\n\nFiles to create:\n- `roles/syncthing/tests/test.yml` - Playbook that applies the role\n- `roles/syncthing/tests/inventory` - Simple inventory with localhost\n\n## Acceptance Criteria\n\n- [ ] `roles/syncthing/tests/test.yml` created with proper playbook structure\n- [ ] `roles/syncthing/tests/inventory` created with localhost target\n- [ ] Test playbook applies syncthing role in check mode\n- [ ] Test playbook can run independently\n- [ ] Follows existing test patterns from other roles","acceptance_criteria":"- [ ] `roles/syncthing/tests/test.yml` created with proper playbook structure\n- [ ] `roles/syncthing/tests/inventory` created with localhost target\n- [ ] Test playbook applies syncthing role in check mode\n- [ ] Test playbook can run independently\n- [ ] Follows existing test patterns from other roles","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T13:57:08.518071716-08:00","updated_at":"2026-01-27T21:25:31.000776174-08:00","closed_at":"2026-01-27T21:25:31.000776174-08:00","close_reason":"Closed","dependencies":[{"issue_id":"fleet-n9m","depends_on_id":"fleet-hef","type":"blocks","created_at":"2026-01-27T13:57:40.817942707-08:00","created_by":"daemon"},{"issue_id":"fleet-n9m","depends_on_id":"fleet-4g6","type":"parent-child","created_at":"2026-01-27T13:57:48.182523186-08:00","created_by":"daemon"}]}
{"id":"fleet-nkn","title":"Research Crush LSP configuration","description":"Read https://github.com/charmbracelet/crush documentation to determine how to configure LSP servers.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:01:25.68321131-08:00","created_by":"kayos","updated_at":"2026-01-06T16:01:40.231566155-08:00","closed_at":"2026-01-06T16:01:40.231588614-08:00"}
{"id":"fleet-nz6","title":"Create playbook to orchestrate auto-pairing workflow","description":"Create dedicated Ansible playbook to orchestrate device ID collection, storage, and config templating across fleet.\n\n## Implementation\n\nCreate `syncthing_autopair.yml` in repository root:\n\n```yaml\n---\n- name: \"Syncthing Auto-Pairing Setup\"\n  hosts: laptop:workstation\n  become: false\n  gather_facts: true\n  \n  tasks:\n    - name: \"Collect device IDs from all hosts\"\n      ansible.builtin.include_role:\n        name: syncthing\n        tasks_from: collect_device_ids.yml\n      tags: [collect]\n    \n    - name: \"Store device IDs in 1Password\"\n      ansible.builtin.include_role:\n        name: syncthing\n        tasks_from: store_device_ids.yml\n      run_once: true\n      delegate_to: localhost\n      tags: [store]\n\n- name: \"Apply Syncthing configuration\"\n  hosts: laptop:workstation\n  become: false\n  gather_facts: true\n  \n  tasks:\n    - name: \"Load device IDs from 1Password\"\n      ansible.builtin.include_role:\n        name: syncthing\n        tasks_from: load_device_ids.yml\n      tags: [configure]\n    \n    - name: \"Apply templated config\"\n      ansible.builtin.include_role:\n        name: syncthing\n        tasks_from: apply_config.yml\n      tags: [configure]\n  \n  handlers:\n    - name: restart syncthing\n      ansible.builtin.include_role:\n        name: syncthing\n        handlers_from: main.yml\n```\n\nAdd mise task in `mise.toml`:\n```toml\n[tasks.\"syncthing:autopair\"]\ndescription = \"Configure Syncthing auto-pairing across fleet\"\nrun = \"\"\"\nansible-playbook syncthing_autopair.yml -l laptop:workstation\n\"\"\"\n```\n\n## Acceptance Criteria\n\n- Playbook created in repository root\n- Two-phase approach: collection/storage, then configuration\n- Targets only laptop and workstation groups\n- Uses role tasks via include_role\n- Tags enable selective execution (collect, store, configure)\n- Mise task created for easy execution\n- Playbook documented in project README\n- `ansible-playbook syncthing_autopair.yml --syntax-check` passes\n- `ansible-lint syncthing_autopair.yml` passes","acceptance_criteria":"- [ ] syncthing_autopair.yml playbook created in repository root\n- [ ] Playbook has two distinct plays: collection/storage and configuration\n- [ ] First play targets laptop:workstation groups\n- [ ] First play includes device ID collection and 1Password storage tasks\n- [ ] Second play includes config loading and application tasks\n- [ ] Playbook uses tags for selective execution (collect, store, configure)\n- [ ] mise.toml updated with syncthing:autopair task definition\n- [ ] mise run syncthing:autopair executes successfully\n- [ ] ansible-playbook syncthing_autopair.yml --syntax-check passes\n- [ ] ansible-lint syncthing_autopair.yml passes\n- [ ] Playbook documented in project README or AGENTS.md","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:28:41.953610137-08:00","updated_at":"2026-01-27T15:09:13.813879994-08:00","labels":["orchestration","syncthing"],"dependencies":[{"issue_id":"fleet-nz6","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:28:41.958092218-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-st4","type":"blocks","created_at":"2026-01-27T14:29:08.929763606-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-0g5","type":"blocks","created_at":"2026-01-27T14:29:09.509128019-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-75d","type":"blocks","created_at":"2026-01-27T14:29:10.038392996-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-lqf","type":"blocks","created_at":"2026-01-27T14:29:10.523285171-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-loh","type":"blocks","created_at":"2026-01-27T14:29:11.063856996-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-c3u","type":"blocks","created_at":"2026-01-27T14:29:11.510240085-08:00","created_by":"daemon"},{"issue_id":"fleet-nz6","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:34.212140039-08:00","created_by":"daemon"}]}
{"id":"fleet-pr6","title":"Document firewall setup and port configuration","description":"Add firewall configuration section to Syncthing role README explaining ports, setup, and platform differences.\n\n## Context\nThis is part of firewall documentation (parent: fleet-y3k). Covers setup and configuration basics.\n\n## Content to Add\n\nSection in roles/syncthing/README.md:\n\n### Firewall Configuration\n- Explain automatic firewall configuration by role\n- Document ports: TCP 22000 (sync), UDP 22000 (QUIC), UDP 21027 (discovery)\n- Explain Linux ufw configuration (tasks/linux_firewall.yml)\n- Explain Darwin firewall configuration (tasks/darwin_firewall.yml)\n- Note platform-specific commands for manual verification\n\n## Acceptance Criteria\n\n- [ ] README.md section added: ## Firewall Configuration\n- [ ] Port 22000 TCP documented: primary sync protocol\n- [ ] Port 22000 UDP documented: QUIC protocol for NAT traversal\n- [ ] Port 21027 UDP documented: local discovery\n- [ ] Linux ufw configuration process documented\n- [ ] Darwin firewall configuration process documented\n- [ ] Manual verification commands included for both platforms\n- [ ] Section explains why firewall configuration is necessary (direct vs relay)\n- [ ] markdownlint passes on README.md","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:13:30.513054988-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:39:22.352606447-08:00","closed_at":"2026-01-27T15:39:22.352606447-08:00","close_reason":"Task created incorrectly without acceptance criteria during decomposition attempt. Intermediate parent tasks (fleet-0mw, fleet-y3k, fleet-11m) should be completed as-is without further decomposition.","labels":["documentation","firewall","syncthing"],"dependencies":[{"issue_id":"fleet-pr6","depends_on_id":"fleet-li9","type":"blocks","created_at":"2026-01-27T15:13:56.03687869-08:00","created_by":"daemon"}]}
{"id":"fleet-qwr","title":"Test computed fields bug","acceptance_criteria":"## Acceptance Criteria\n\n- [ ] Task works\n- [ ] Tests pass","status":"closed","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:58:57.91967924-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T15:59:02.448607853-08:00","closed_at":"2026-01-27T15:59:02.448607853-08:00","close_reason":"Test complete - bug confirmed"}
{"id":"fleet-s0l","title":"Setup beads for fleet project","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:17:06.27468446-08:00","created_by":"kayos","updated_at":"2026-01-06T15:25:28.938259855-08:00","closed_at":"2026-01-06T15:25:28.938259855-08:00","close_reason":"Closed"}
{"id":"fleet-st4","title":"Collect Syncthing device IDs from fleet hosts","description":"Create Ansible task to collect Syncthing device IDs from all running instances in the fleet.\n\n## Implementation\n\nCreate `roles/syncthing/tasks/collect_device_ids.yml`:\n\n```yaml\n# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.\n---\n- name: \"Syncthing | Get device ID from config\"\n  ansible.builtin.slurp:\n    src: \"{{ ansible_env.HOME }}/.config/syncthing/config.xml\"\n  register: syncthing_config_raw\n\n- name: \"Syncthing | Parse device ID\"\n  ansible.builtin.set_fact:\n    syncthing_device_id: \"{{ syncthing_config_raw.content | b64decode | regex_search('\u003cdevice id=\\\"([A-Z0-9-]+)\\\"', '\\\\1') | first }}\"\n\n- name: \"Syncthing | Display device ID\"\n  ansible.builtin.debug:\n    msg: \"{{ inventory_hostname }}: {{ syncthing_device_id }}\"\n```\n\nAlternative approach using REST API (if API key available):\n```yaml\n- name: \"Syncthing | Get device ID via API\"\n  ansible.builtin.uri:\n    url: \"http://localhost:8384/rest/system/status\"\n    headers:\n      X-API-Key: \"{{ syncthing_api_key }}\"\n  register: syncthing_status\n\n- name: \"Syncthing | Set device ID fact\"\n  ansible.builtin.set_fact:\n    syncthing_device_id: \"{{ syncthing_status.json.myID }}\"\n```\n\n## Acceptance Criteria\n\n- Task file created in roles/syncthing/tasks/\n- Device IDs successfully extracted from all 5 hosts\n- Device IDs stored in Ansible facts for later use\n- Task handles missing config.xml gracefully (fail with clear message)\n- Follows FQCN convention and copyright header\n- `ansible-lint` passes","acceptance_criteria":"- [ ] Ansible task created to collect device IDs from Syncthing instances\n- [ ] Task uses `ansible.builtin.uri` to query REST API at `http://127.0.0.1:8384/rest/system/status`\n- [ ] API key read from Syncthing config.xml using `ansible.builtin.slurp` or `ansible.builtin.xml`\n- [ ] Device ID extracted from JSON response: `.myID` field\n- [ ] Device ID registered to fact: `syncthing_device_id`\n- [ ] Task runs only on hosts in laptop and workstation groups\n- [ ] Task fails gracefully if Syncthing not running or API unreachable\n- [ ] ansible-lint passes on task file\n- [ ] Test run with --check and --diff shows device IDs would be collected","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:27:58.96013127-08:00","updated_at":"2026-01-27T14:56:41.490246829-08:00","labels":["data-collection","syncthing"],"dependencies":[{"issue_id":"fleet-st4","depends_on_id":"fleet-2w0","type":"blocks","created_at":"2026-01-27T14:27:58.964939437-08:00","created_by":"daemon"},{"issue_id":"fleet-st4","depends_on_id":"fleet-2w0","type":"parent-child","created_at":"2026-01-27T14:51:30.704235787-08:00","created_by":"daemon"}]}
{"id":"fleet-t6i","title":"Test computed fields bug in beads database","description":"## Objective\nTest the computed fields bug in the beads database to validate issue tracking data integrity.\n\n## Acceptance Criteria\n- [ ] Bug description added explaining what computed fields issue needs testing\n- [ ] Test case created to reproduce the computed fields bug\n- [ ] Test case documents expected vs actual behavior\n- [ ] Issue references relevant beads code or documentation where bug occurs\n- [ ] Test results captured showing bug manifestation","acceptance_criteria":"- [ ] Bug description added explaining what computed fields issue needs testing\n- [ ] Test case created to reproduce the computed fields bug\n- [ ] Test case documents expected vs actual behavior\n- [ ] Issue references relevant beads code or documentation where bug occurs\n- [ ] Test results captured showing bug manifestation\n- [ ] `mise run lint` passes\n- [ ] `mise run test` passes","status":"open","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-01-27T15:58:54.39432166-08:00","created_by":"T.R. Fullhart","updated_at":"2026-01-27T20:55:56.232187749-08:00"}
{"id":"fleet-tb6","title":"Implement blender installation in printing_3d role","description":"Found TODO in roles/printing_3d/tasks/main.yml: install blender","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-07T16:36:45.185121438-08:00","created_by":"kayos","updated_at":"2026-01-07T17:02:25.222282362-08:00","closed_at":"2026-01-07T17:02:25.222282362-08:00","close_reason":"Added blender to printing_3d_packages"}
{"id":"fleet-tsc","title":"Remove sensitive network information from repository","description":"Remove all references to ZeroTier network name (example_network) and IP addresses (198.51.100.0/24) from config files, documentation, and git history. Move necessary values to 1Password and fetch them dynamically.\n\n## Scope\n- Network name: example_network\n- IP subnet: 198.51.100.0/24\n- Affected files: AGENTS.md, roles/nas_mount/README.md, roles/nas_mount/defaults/main.yml\n- Git history: ~180 commits, sensitive data in at least 3 commits\n\n## Approach\n1. Move hardcoded values to 1Password items\n2. Update Ansible files to fetch from 1Password\n3. Update documentation to use placeholders/examples\n4. Rewrite git history using git-filter-repo\n5. Force push (breaking change)\n6. Update all clones and notify collaborators\n\n## Success Criteria\n- All hardcoded network names and IPs removed from files\n- Ansible files fetch values from 1Password dynamically\n- Documentation uses generic examples/placeholders\n- Git history rewritten to remove all sensitive references\n- Repository force-pushed with clean history\n- mise run lint passes\n- mise run test passes","acceptance_criteria":"## Success Criteria\n- All hardcoded network names and IPs removed from files\n- Ansible files fetch values from 1Password dynamically\n- Documentation uses generic examples/placeholders\n- Git history rewritten to remove all sensitive references\n- Repository force-pushed with clean history\n- mise run lint passes\n- mise run test passes","status":"open","priority":1,"issue_type":"epic","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:41:56.131368922-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:52.117025152-08:00"}
{"id":"fleet-tsc.1","title":"Audit repository for all sensitive network references","description":"Perform comprehensive audit to identify all locations of sensitive network information:\n- ZeroTier network name: example_network\n- IP addresses: 198.51.100.0/24 subnet\n- Any domain names that should remain private\n\n## Acceptance Criteria\n- Complete inventory of files with sensitive data\n- List of git commits containing sensitive data\n- Proposed 1Password item schema\n- Document shared in issue or attached file","acceptance_criteria":"## Acceptance Criteria\n- Complete inventory of files with sensitive data\n- List of git commits containing sensitive data\n- Proposed 1Password item schema\n- Document shared in issue or attached file","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:03.50979191-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:43:51.78179239-08:00","dependencies":[{"issue_id":"fleet-tsc.1","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:03.512822266-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.10","title":"Force push rewritten history to remote","description":"Force push the rewritten history to GitHub (BREAKING CHANGE):\n\n**WARNING**: This will rewrite remote history. All collaborators will need to re-clone.\n\n1. Verify local repository state:\n   ```bash\n   git status\n   git log --oneline -10\n   ```\n\n2. Force push to main branch:\n   ```bash\n   git push origin main --force-with-lease\n   ```\n\n3. Verify remote repository:\n   - Check GitHub web interface\n   - Verify no sensitive data visible\n\n4. Tag the force push point:\n   ```bash\n   git tag -a history-rewrite-2026-02 -m 'Removed sensitive network information from history'\n   git push origin history-rewrite-2026-02\n   ```\n\n5. Document the breaking change in a GitHub issue/announcement if there are collaborators.\n\n**Rollback plan**: If issues found, push from /home/kayos/src/fleet-backup.git\n\n## Acceptance Criteria\n- History force-pushed successfully\n- Sensitive data not visible on GitHub\n- Tag created marking the rewrite\n- Repository accessible and functional\n- Breaking change documented if needed","acceptance_criteria":"## Acceptance Criteria\n- History force-pushed successfully\n- Sensitive data not visible on GitHub\n- Tag created marking the rewrite\n- Repository accessible and functional\n- Breaking change documented if needed","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:54.808150195-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:39.771025387-08:00","dependencies":[{"issue_id":"fleet-tsc.10","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:54.812342935-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.10","depends_on_id":"fleet-tsc.9","type":"blocks","created_at":"2026-02-03T15:42:54.823835564-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.11","title":"Update local clones and verify end-to-end functionality","description":"Update any other local clones of the repository and verify everything works:\n\n1. Identify other clones:\n   - Check common locations: ~/Projects/, ~/work/, etc.\n   - Check for beads-sync worktrees\n\n2. For each clone:\n   ```bash\n   cd \u003cclone-path\u003e\n   git fetch origin\n   git reset --hard origin/main\n   ```\n\n3. Test functionality on primary clone:\n   ```bash\n   cd /home/kayos/src/fleet\n   mise run dry-run-local\n   mise run lint\n   mise run test\n   bd sync\n   ```\n\n4. Verify 1Password integration:\n   - Ensure op session active\n   - Test variable resolution\n\n5. Verify beads database syncs correctly:\n   ```bash\n   bd sync\n   bd list --status=open\n   ```\n\n## Acceptance Criteria\n- All local clones updated to rewritten history\n- mise run dry-run-local passes\n- mise run lint passes\n- mise run test passes\n- bd sync works correctly\n- All 1Password lookups functional","acceptance_criteria":"## Acceptance Criteria\n- All local clones updated to rewritten history\n- mise run dry-run-local passes\n- mise run lint passes\n- mise run test passes\n- bd sync works correctly\n- All 1Password lookups functional","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:43:03.033809125-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:41.668607068-08:00","dependencies":[{"issue_id":"fleet-tsc.11","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:43:03.036986649-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.11","depends_on_id":"fleet-tsc.10","type":"blocks","created_at":"2026-02-03T15:43:03.048410611-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.12","title":"Document privacy improvements and lessons learned","description":"Create documentation of the privacy cleanup process:\n\n1. Update AGENTS.md or create PRIVACY.md with:\n   - What sensitive information was removed\n   - How to properly handle sensitive data going forward\n   - 1Password integration patterns for new secrets\n   - How to avoid hardcoding production values\n\n2. Document the git history rewrite process:\n   - Tools used (git-filter-repo)\n   - Replacement patterns applied\n   - Verification steps\n\n3. Add pre-commit guidance:\n   - Checklist for reviewing diffs before commit\n   - How to identify sensitive data patterns\n   - When to use 1Password lookups vs Ansible vault\n\nThis documentation helps prevent future exposure of sensitive information.\n\n## Acceptance Criteria\n- Documentation created covering privacy practices\n- git history rewrite process documented\n- Guidance for future commits included\n- mise run lint passes","acceptance_criteria":"## Acceptance Criteria\n- Documentation created covering privacy practices\n- git history rewrite process documented\n- Guidance for future commits included\n- mise run lint passes","status":"open","priority":2,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:43:06.987073189-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:50.176896939-08:00","dependencies":[{"issue_id":"fleet-tsc.12","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:43:06.989910169-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.12","depends_on_id":"fleet-tsc.11","type":"blocks","created_at":"2026-02-03T15:43:07.001905344-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.2","title":"Create 1Password items for ZeroTier network configuration","description":"Create new 1Password items or update existing items to store:\n1. ZeroTier network name/label (currently: example_network)\n2. ZeroTier network hostname suffix (for FQDNs)\n3. Optional: ZeroTier subnet CIDR if needed (198.51.100.0/24)\n\nUpdate existing item:\n- Vault: ServiceAccountAccess\n- Item: Fleet ZeroTier Network ID (ID: lkfcqg5neo6l47l2wqrz6nyhie)\n- Add fields: network_name, domain_suffix, subnet (if needed)\n\nVerify access via op CLI:\n\n\n## Acceptance Criteria\n- 1Password items created/updated with network name\n- Values accessible via op CLI\n- Document op:// URIs for each value","acceptance_criteria":"## Acceptance Criteria\n- 1Password items created/updated with network name\n- Values accessible via op CLI\n- Document op:// URIs for each value","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:07.573769524-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:44:06.235763936-08:00","dependencies":[{"issue_id":"fleet-tsc.2","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:07.576575004-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.3","title":"Update nas_mount role to use 1Password for hostname","description":"Update roles/nas_mount/defaults/main.yml to fetch NAS hostname from 1Password instead of hardcoding.\n\nCurrent hardcoded value:\n\n\nChange to:\n\n\nOr create a composed variable in group_vars/all/vars.yml and reference it.\n\n## Acceptance Criteria\n- nas_mount_hostname uses 1Password lookup\n- Role still functions correctly (test with mise run test or dry-run)\n- mise run lint passes","acceptance_criteria":"## Acceptance Criteria\n- nas_mount_hostname uses 1Password lookup\n- Role still functions correctly (test with mise run test or dry-run)\n- mise run lint passes","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:14.717352892-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:44:06.376800467-08:00","dependencies":[{"issue_id":"fleet-tsc.3","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:14.720119371-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.3","depends_on_id":"fleet-tsc.2","type":"blocks","created_at":"2026-02-03T15:42:14.729268024-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.4","title":"Update AGENTS.md to use generic examples instead of real network info","description":"Update AGENTS.md to replace all references to:\n- Network name 'example_network' → use 'example_network' or '\u003cnetwork_name\u003e'\n- IP addresses 192.168.196.x → use example IPs like 192.0.2.x (TEST-NET-1) or placeholders\n\nSections to update:\n1. Line 274: base_zerotier_package_names description\n2. Lines 278-314: ZeroTier Peer Discovery section (examples, config vars, /etc/hosts examples)\n3. Lines 316-377: NAS Auto-Mount section (hostname, subnet references)\n\nMaintain documentation clarity while removing actual production values.\n\n## Acceptance Criteria\n- All references to 'example_network' replaced with generic examples\n- All 192.168.196.x IPs replaced with RFC 5737 test IPs or placeholders\n- Documentation remains clear and useful\n- mise run lint passes","acceptance_criteria":"## Acceptance Criteria\n- All references to 'example_network' replaced with generic examples\n- All 192.168.196.x IPs replaced with RFC 5737 test IPs or placeholders\n- Documentation remains clear and useful\n- mise run lint passes","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:19.562559614-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:19.13976178-08:00","dependencies":[{"issue_id":"fleet-tsc.4","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:19.565620471-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.4","depends_on_id":"fleet-tsc.2","type":"blocks","created_at":"2026-02-03T15:42:19.575511838-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.5","title":"Update nas_mount role README.md with generic examples","description":"Update roles/nas_mount/README.md to remove sensitive network information:\n- Replace 'nas-server.example_network.zt' with 'nas-server.\u003cnetwork_name\u003e.zt'\n- Replace 198.51.100.0/24 with 198.51.100.0/24 (TEST-NET-2) or \u003czerotier_subnet\u003e\n- Update all command examples to use generic hostnames\n\nMaintain technical accuracy and usefulness of documentation while removing production values.\n\n## Acceptance Criteria\n- All references to 'example_network' replaced\n- All 192.168.196.x IPs replaced with test IPs or placeholders\n- Commands and examples remain technically correct\n- mise run lint passes","acceptance_criteria":"## Acceptance Criteria\n- All references to 'example_network' replaced\n- All 192.168.196.x IPs replaced with test IPs or placeholders\n- Commands and examples remain technically correct\n- mise run lint passes","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:25.385644732-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:20.513762688-08:00","dependencies":[{"issue_id":"fleet-tsc.5","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:25.407684191-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.5","depends_on_id":"fleet-tsc.2","type":"blocks","created_at":"2026-02-03T15:42:25.420480038-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.6","title":"Test all changes work with 1Password lookups","description":"Verify that all changes work correctly with 1Password integration:\n\n1. Verify 1Password lookups work:\n   - Test `op read` for all new fields\n   - Ensure op session is active\n\n2. Test Ansible playbooks:\n   ```bash\n   mise run dry-run-local\n   ```\n\n3. Verify variables resolve correctly:\n   - Check that zerotier variables populate\n   - Check that nas_mount_hostname resolves correctly\n\n4. Run quality gates:\n   ```bash\n   mise run lint\n   mise run test\n   ```\n\nDocument any issues found.\n\n## Acceptance Criteria\n- All 1Password lookups succeed\n- mise run dry-run-local completes without errors\n- All variables resolve to expected values\n- mise run lint passes\n- mise run test passes","acceptance_criteria":"## Acceptance Criteria\n- All 1Password lookups succeed\n- mise run dry-run-local completes without errors\n- All variables resolve to expected values\n- mise run lint passes\n- mise run test passes","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:29.544157607-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:21.967424326-08:00","dependencies":[{"issue_id":"fleet-tsc.6","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:29.547950177-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.6","depends_on_id":"fleet-tsc.1","type":"blocks","created_at":"2026-02-03T15:42:29.558860052-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.6","depends_on_id":"fleet-tsc.2","type":"blocks","created_at":"2026-02-03T15:42:29.569869677-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.6","depends_on_id":"fleet-tsc.3","type":"blocks","created_at":"2026-02-03T15:42:29.580025588-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.6","depends_on_id":"fleet-tsc.4","type":"blocks","created_at":"2026-02-03T15:42:29.589729411-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.6","depends_on_id":"fleet-tsc.5","type":"blocks","created_at":"2026-02-03T15:42:29.59958607-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.7","title":"Install and configure git-filter-repo for history rewriting","description":"Install git-filter-repo tool and prepare for git history rewriting:\n\n1. Install git-filter-repo:\n   ```bash\n   # Debian/Ubuntu\n   apt install git-filter-repo\n   # or via pip\n   pip install git-filter-repo\n   ```\n\n2. Create backup of repository:\n   ```bash\n   git clone --mirror /home/kayos/src/fleet /home/kayos/src/fleet-backup.git\n   ```\n\n3. Document current remote configuration:\n   ```bash\n   git remote -v \u003e /tmp/fleet-remotes.txt\n   ```\n\n4. Create test repository for practicing:\n   ```bash\n   git clone /home/kayos/src/fleet /tmp/fleet-test\n   ```\n\nNote: Do NOT run actual history rewrite yet - this task is setup only.\n\n## Acceptance Criteria\n- git-filter-repo installed and available\n- Full backup created at /home/kayos/src/fleet-backup.git\n- Remote configuration documented\n- Test repository created at /tmp/fleet-test\n- Document the version: git-filter-repo --version","acceptance_criteria":"## Acceptance Criteria\n- git-filter-repo installed and available\n- Full backup created at /home/kayos/src/fleet-backup.git\n- Remote configuration documented\n- Test repository created at /tmp/fleet-test\n- Document the version: git-filter-repo --version","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:36.815317236-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:23.957374709-08:00","dependencies":[{"issue_id":"fleet-tsc.7","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:36.818318884-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.7","depends_on_id":"fleet-tsc.6","type":"blocks","created_at":"2026-02-03T15:42:36.828240501-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.8","title":"Create git-filter-repo replacement script","description":"Create a text replacement configuration for git-filter-repo to sanitize history:\n\nCreate file: /tmp/fleet-replacements.txt\n```\nexample_network==\u003eexample_network\n198.51.100.102==\u003e198.51.100.102\n198.51.100.204==\u003e198.51.100.204\n198.51.100.206==\u003e198.51.100.206\n198.51.100.86==\u003e198.51.100.86\n198.51.100.193==\u003e198.51.100.193\n198.51.100.0/24==\u003e198.51.100.0/24\nnas-server.example_network.zt==\u003enas-server.example_network.zt\nworkstation1.example_network.zt==\u003eworkstation1.example_network.zt\nlaptop1.example_network.zt==\u003elaptop1.example_network.zt\nworkstation2.example_network.zt==\u003eworkstation2.example_network.zt\nserver1.example_network.zt==\u003eserver1.example_network.zt\n```\n\nTest on /tmp/fleet-test first:\n```bash\ncd /tmp/fleet-test\ngit filter-repo --replace-text /tmp/fleet-replacements.txt --force\n```\n\nVerify replacements worked as expected.\n\n## Acceptance Criteria\n- Replacement file created with all sensitive values\n- Test run completed successfully on /tmp/fleet-test\n- Verify sample commits show replacements worked\n- No unexpected side effects in test repo","acceptance_criteria":"## Acceptance Criteria\n- Replacement file created with all sensitive values\n- Test run completed successfully on /tmp/fleet-test\n- Verify sample commits show replacements worked\n- No unexpected side effects in test repo","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:42.023204383-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:35.410285307-08:00","dependencies":[{"issue_id":"fleet-tsc.8","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:42.025174315-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.8","depends_on_id":"fleet-tsc.7","type":"blocks","created_at":"2026-02-03T15:42:42.032419662-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-tsc.9","title":"Execute git history rewrite on production repository","description":"Execute the git history rewrite on the actual production repository:\n\n**CRITICAL**: This is a destructive operation. Verify all previous tasks completed successfully.\n\n1. Verify backup exists:\n   ```bash\n   ls -lh /home/kayos/src/fleet-backup.git\n   ```\n\n2. Verify all file changes committed:\n   ```bash\n   cd /home/kayos/src/fleet\n   git status  # Should be clean\n   ```\n\n3. Run git-filter-repo:\n   ```bash\n   cd /home/kayos/src/fleet\n   git filter-repo --replace-text /tmp/fleet-replacements.txt --force\n   ```\n\n4. Restore remote configuration:\n   ```bash\n   git remote add origin \u003coriginal-remote-url\u003e\n   ```\n\n5. Verify history:\n   ```bash\n   git log --all --full-history -S 'example_network'  # Should be empty\n   git log --all --full-history -S '192.168.196'    # Should be empty\n   ```\n\nDocument any issues or unexpected results.\n\n## Acceptance Criteria\n- git-filter-repo executed successfully\n- No references to 'example_network' in history\n- No references to 192.168.196.x in history\n- Remote configuration restored\n- Repository in valid state","acceptance_criteria":"## Acceptance Criteria\n- git-filter-repo executed successfully\n- No references to 'example_network' in history\n- No references to 192.168.196.x in history\n- Remote configuration restored\n- Repository in valid state","status":"open","priority":1,"issue_type":"task","owner":"kayos@genetikayos.com","created_at":"2026-02-03T15:42:49.754218594-08:00","created_by":"T.R. Fullhart","updated_at":"2026-02-03T15:45:37.84764701-08:00","dependencies":[{"issue_id":"fleet-tsc.9","depends_on_id":"fleet-tsc","type":"parent-child","created_at":"2026-02-03T15:42:49.756911989-08:00","created_by":"T.R. Fullhart"},{"issue_id":"fleet-tsc.9","depends_on_id":"fleet-tsc.8","type":"blocks","created_at":"2026-02-03T15:42:49.767353444-08:00","created_by":"T.R. Fullhart"}]}
{"id":"fleet-y0c","title":"Configure Crush to use Ansible Language Server","description":"Ensure Crush is configured to utilize the installed @ansible/ansible-language-server for better Ansible file intelligence.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T15:48:45.150530349-08:00","created_by":"kayos","updated_at":"2026-01-06T15:53:06.983581693-08:00","closed_at":"2026-01-06T15:53:06.983593651-08:00"}
{"id":"fleet-y3k","title":"Document firewall configuration in Syncthing role README","description":"## Objective\nDocument the firewall configuration requirements and implementation details in the Syncthing role README to help users understand and troubleshoot firewall settings.\n\n## Acceptance Criteria\n- [ ] README.md exists in roles/syncthing/ directory\n- [ ] Firewall section documents required ports (22000 TCP/UDP, 21027 UDP)\n- [ ] Firewall section explains purpose of each port\n- [ ] Documentation includes Linux ufw configuration details\n- [ ] Documentation includes Darwin firewall configuration details\n- [ ] Documentation notes platform-specific task file pattern\n- [ ] Documentation references relevant variables (if any)\n- [ ] Documentation follows existing role README format/style\n- [ ] Documentation validated with markdownlint\n- [ ] Documentation reviewed for accuracy and completeness","acceptance_criteria":"- [ ] README.md exists in roles/syncthing/ directory\n- [ ] Firewall section documents required ports (22000 TCP/UDP, 21027 UDP)\n- [ ] Firewall section explains purpose of each port\n- [ ] Documentation includes Linux ufw configuration details\n- [ ] Documentation includes Darwin firewall configuration details\n- [ ] Documentation notes platform-specific task file pattern\n- [ ] Documentation references relevant variables (if any)\n- [ ] Documentation follows existing role README format/style\n- [ ] Documentation validated with markdownlint\n- [ ] Documentation reviewed for accuracy and completeness\n- [ ] `mise run lint` passes","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:46:53.101489911-08:00","updated_at":"2026-01-27T20:56:01.08898853-08:00","labels":["documentation","syncthing"],"dependencies":[{"issue_id":"fleet-y3k","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:46:53.105965573-08:00","created_by":"daemon"},{"issue_id":"fleet-y3k","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:03.958874108-08:00","created_by":"daemon"},{"issue_id":"fleet-y3k","depends_on_id":"fleet-pr6","type":"parent-child","created_at":"2026-01-27T15:13:54.727508343-08:00","created_by":"daemon"},{"issue_id":"fleet-y3k","depends_on_id":"fleet-li9","type":"parent-child","created_at":"2026-01-27T15:13:55.370435134-08:00","created_by":"daemon"},{"issue_id":"fleet-y3k","depends_on_id":"fleet-5y5","type":"parent-child","created_at":"2026-01-27T15:17:20.06835768-08:00","created_by":"daemon"},{"issue_id":"fleet-y3k","depends_on_id":"fleet-d6a","type":"parent-child","created_at":"2026-01-27T15:17:20.548603273-08:00","created_by":"daemon"}]}
{"id":"fleet-ylc","title":"setup oh-my-zsh with completions for the bd tool","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-06T16:22:13.732633627-08:00","created_by":"kayos","updated_at":"2026-01-08T11:52:41.067249645-08:00","closed_at":"2026-01-07T16:33:27.49704301-08:00"}
{"id":"fleet-zmb","title":"Configure Linux ufw rules for Syncthing ports","description":"## Objective\nImplement firewall rules for Linux hosts using ufw to allow Syncthing traffic through the system firewall.\n\n## Acceptance Criteria\n- [ ] Task file created: roles/syncthing/tasks/linux_enable_firewall.yml\n- [ ] Task uses community.general.ufw module\n- [ ] Task allows TCP port 22000 for Syncthing sync\n- [ ] Task allows UDP port 22000 for Syncthing discovery\n- [ ] Task allows UDP port 21027 for Syncthing discovery\n- [ ] Task validates ufw is enabled before adding rules\n- [ ] Task is idempotent (repeated runs do not cause changes)\n- [ ] Task follows existing Linux firewall patterns from base role\n- [ ] Task included in roles/syncthing/tasks/main.yml via platform detection\n- [ ] Task passes lint: mise run lint:ansible","acceptance_criteria":"- [ ] Task file created: roles/syncthing/tasks/linux_enable_firewall.yml\n- [ ] Task uses community.general.ufw module\n- [ ] Task allows TCP port 22000 for Syncthing sync\n- [ ] Task allows UDP port 22000 for Syncthing discovery\n- [ ] Task allows UDP port 21027 for Syncthing discovery\n- [ ] Task validates ufw is enabled before adding rules\n- [ ] Task is idempotent (repeated runs do not cause changes)\n- [ ] Task follows existing Linux firewall patterns from base role\n- [ ] Task included in roles/syncthing/tasks/main.yml via platform detection\n- [ ] Task passes lint: mise run lint:ansible","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:45:13.265071404-08:00","updated_at":"2026-01-27T19:45:01.513713976-08:00","labels":["firewall","linux","syncthing","ufw"],"dependencies":[{"issue_id":"fleet-zmb","depends_on_id":"fleet-ccd","type":"blocks","created_at":"2026-01-27T14:45:13.270897494-08:00","created_by":"daemon"},{"issue_id":"fleet-zmb","depends_on_id":"fleet-ccd","type":"parent-child","created_at":"2026-01-27T14:49:01.427078335-08:00","created_by":"daemon"}]}
