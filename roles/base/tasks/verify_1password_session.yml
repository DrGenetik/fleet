# Copyright (c) 2026 T.R. Fullhart. All Rights Reserved.
---
- name: "System | Verify 1Password Session"
  block:
    - name: "System | Check 1Password Session Status"
      ansible.builtin.include_tasks: check_1password.yml

    - name: "System | Fail if 1Password is not available"
      ansible.builtin.fail:
        msg: >-
          1Password CLI is not signed in or not available.
          Please run 'eval $(op signin)' in your shell and retry.
          Error: {{ base_op_session_check.stderr | default('Unknown error') }}
      when: base_op_session_check.rc != 0
